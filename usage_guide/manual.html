

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Обращение к программе. Входные и выходные данные. &mdash; Документация Beremiz </title>
  

  
  
    <link rel="shortcut icon" href="../_static/brz.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Алфавитный указатель"
              href="../genindex.html"/>
        <link rel="search" title="Поиск" href="../search.html"/>
    <link rel="top" title="Документация Beremiz " href="../index.html"/>
        <link rel="up" title="Руководство программиста" href="index.html"/>
        <link rel="next" title="Языки стандарта МЭК 61131-3" href="../iec_guide/index.html"/>
        <link rel="prev" title="Руководство программиста" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Beremiz
          

          
            
            <img src="../_static/about_brz_logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Содержание</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install_guide/index.html">Инструкции по установке</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Руководство программиста</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#id2">Введение</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Обращение к программе. Входные и выходные данные.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Требования к техническим средствам</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Основные термины и определения</a></li>
<li class="toctree-l3"><a class="reference internal" href="#beremiz">Основные компоненты среды разработки «Beremiz»</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">Главное меню программы</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">Панель инструментов</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Дерево проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12">Панель списка переменных и констант</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13">Панель настройки проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#st-il">Текстовый редактор языков ST и IL</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fbd-sfc-ld">Графические редакторы диаграмм языков FBD, SFC, LD</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29">Панель редактирования ресурса</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id30">Панель редактирования типа данных</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id36">Панель экземпляров проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37">Панель библиотеки функций и функциональных блоков</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id38">Отладочная консоль</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id39">Поиск элементов в проекте</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40">Панель отладки</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41">Панель графика изменения значения переменной в режиме отладки</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id56">Связывание переменных программных модулей с внешними переменными</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id57">Работа с проектом</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id58">Создание нового проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id63">Программные модули</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id67">Плагины модулей УСО</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id68">Ресурс</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id71">Типы данных</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id72">Сборка, передача на целевое устройство и отладка прикладной программы</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id73">Запуск серверной части для отладки</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id74">Соединение с целевым устройством и передача исполняемого файла</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id75">Отладка текстовых языков</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id76">Отладка FBD диаграмм</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id77">Отладка LD диаграммы</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id78">Отладка SFC диаграммы</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id79">График изменения значения переменной</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id82">Создание проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id83">Настройка параметров проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id84">Добавление плагинов для модулей УСО</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id87">Добавление программных модулей</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id89">Создание экземпляра программы</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id90">Сборка проекта</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id91">Передача и запуск прикладной программы на целевом устройстве</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id92">Отладка прикладной программы</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id93">Библиотека функций и функциональных блоков</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../iec_guide/index.html">Языки стандарта МЭК 61131-3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide/index.html">Beremiz: Руководство разработчика</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation_guide/index.html">Участие в разработке документации</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Beremiz</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Руководство программиста</a> &raquo;</li>
      
    <li>Обращение к программе. Входные и выходные данные.</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/usage_guide/manual.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>Обращение к программе. Входные и выходные данные.<a class="headerlink" href="#id1" title="Ссылка на этот заголовок">¶</a></h1>
<p>Общая схема по созданию прикладной программы в среде разработки
«Beremiz» представлена на рис. Рис. 1. Входными данными являются
программные модули, написанные пользователем (в большинстве случаев
инженером по автоматизации) на текстовых (ST, IL) и/или графических
(FBD, SFC, LD) языках в соответствии со стандартом IEC 61131-3,
объединённые в проект. Каждый такой проект представлен в формате XML и
хранится в отдельной папке.</p>
<p>Выходными данными является сгенерированный исходный код и исполняемый
файл:</p>
<ol class="arabic simple">
<li>файл &lt;название проекта&gt;.st, содержащий промежуточный код на языке ST,
сгенерированный для всех программных модулей и ресурсов,
транслируемый в язык C;</li>
<li>файлы: config.c config.h, POUS.h, POUS.c и файлы, соответствующие
ресурсам – содержат код (на языке C) реализации алгоритмов и логики
работы программных модулей и ресурсов проекта;</li>
<li>файлы plc_common_main.c и plc_debugger.c содержат код специфичный
для целевой архитектуры и код для отладки прикладной программы на
целевом устройстве из среды разработки «Beremiz» соответственно;</li>
<li>файлы, содержащие код драйверов на языке С для взаимодействия с
внешними модулями УСО;</li>
<li>исполняемый файл в виде динамической библиотеки (с расширением so),
компилируемый из этих вышеперечисленных C файлов.</li>
</ol>
<p>Сгенерированный C код, с помощью кросскомпилятора, запущенного под
UNIX-подобной оболочной, компилируется в исполняемый бинарный файл,
представленный в виде библиотеки.</p>
<p>Исполняемый файл, благодаря средствам «Beremiz», может быть размещен на
целевом устройстве через локальную сеть.</p>
<p>На целевом устройстве исполняемый файл запускается и в процессе работы
выполняет следующие действия (рис. Рис. 1):</p>
<ul class="simple">
<li>с помощью драйверов модулей УСО обменивается данными с внешними
модулями;</li>
<li>исполняет алгоритмы и логику, определенную пользователем в
программных модулях проекта;</li>
<li>предоставляет данные для трансляции в системы верхнего уровня;</li>
<li>сохраняет и транслирует информацию для отладки прикладных программ.</li>
</ul>
<p>Рис. 1 – Обобщенная схема среды разработки «Beremiz»</p>
</div>
<div class="section" id="id2">
<h1>Требования к техническим средствам<a class="headerlink" href="#id2" title="Ссылка на этот заголовок">¶</a></h1>
<p>Техническими требованиями для работы среды разработки «Beremiz» является
персональный компьютер с тактовой частотой процессора 1000 МГц
(поддерживаются как 32-битные, так и 64-битные), 1 Гб оперативной памяти
и установленная операционная система Windows XP/Vista/7. Необходимо
наличие монитора (для оптимальной работы не меньше 17”), клавиатуры,
мыши (или устройства, полноценно заменяющего мышь).</p>
</div>
<div class="section" id="id3">
<h1>Основные термины и определения<a class="headerlink" href="#id3" title="Ссылка на этот заголовок">¶</a></h1>
<p><strong>IEC 61131-3</strong> – раздел международного стандарта МЭК 61131 (также
существует соответствующий европейский стандарт EN 61131), описывающий
языки программирования для программируемых логических контроллеров.</p>
<p><strong>Среда разработки для языков стандарта IEC 61131-3</strong> – система
программных средств, используемая инженерами по автоматизации, для
разработки прикладного программного обеспечения на высокоуровневых
языках стандарта IEC 61131-3 под различные целевые платформы, которая
включает в себя:</p>
<ul class="simple">
<li>текстовые и графические редакторы языков стандарта IEC 61131-3;</li>
<li>транслятор диаграмм графических языков в текстовый язык;</li>
<li>транслятор текстового языка в язык C;</li>
<li>механизмы плагинов для взаимодействия с модулями УСО;</li>
<li>механизмы добавления компиляторов под целевую платформу;</li>
<li>механизмы соединений с целевыми устройствами;</li>
<li>отладчик.</li>
</ul>
<p><strong>Модули УСО</strong> – модули ввода/вывода, обеспечивающие подключение
датчиков и исполнительных механизмов.</p>
<p><strong>Целевое устройство</strong> – аппаратное средство с определённой архитектурой
процессора, на котором могут исполняться различные исполняемые файлы,
обращающиеся с помощью него к модулям УСО.</p>
<p><strong>Прикладная программа (исполняемый файл) для целевого устройства</strong> –
скомпилированный и скомпонованный so-файл, который будет выполняться на
целевом устройстве.</p>
<p><strong>Плагин для модуля УСО</strong> – интерфейс, состоящий из специальных
драйверов и элементов пользовательского интерфейса для среды разработки
«Beremiz», позволяющий связывать переменные модулей УСО с переменными
программных модулей, из которых состоит проект.</p>
<p><strong>Проект</strong> – совокупность программных модулей (программ, функциональных
блоков, функций), плагинов внешних модулей УСО, ресурсов,
пользовательских типов данных, сборка (компиляция и компоновка) которых,
представляет собой прикладную программу для целевого устройства. Каждый
проект сохраняется в отдельном файле.</p>
<p><strong>Переменная</strong> – область памяти, в которой находятся данные, с которыми
оперирует программный модуль.</p>
<p><strong>Ресурс</strong> – элемент, отвечающий за конфигурацию проекта: глобальные
переменные и экземпляры проекта, связываемыми с программными модулями
типа «Программа» и задачами.</p>
<p><strong>Программный модуль</strong> – элемент, представляющий собой функцию,
функциональный блок или программу. Каждый программный модуль состоит из
раздела объявлений и кода. Для написания всего кода программного
используется только один из языков программирования стандарта IEC
61131-3.</p>
<p><strong>Функция</strong> – программный модуль, который возвращает только единственное
значение, которое может состоять из одного и нескольких элементов (если
это битовое поле или структура).</p>
<p><strong>Функциональный блок</strong> – программный модуль, который принимает и
возвращает произвольное число значений, а так же позволяет сохранять
своё состояние (подобно классу в различных объектно-ориентированных
языках). В отличие от функции функциональный блок не формирует
возвращаемое значение.</p>
<p><strong>Программа</strong> – программный модуль, представляющий собой единицу
исполнения, как правило, связывается (ассоциируется) с задачей.</p>
<p><strong>Задача</strong> – элемент представляющий время и приоритет выполнения
программного модуля типа «Программа» в рамках экземпляра проекта.</p>
<p><strong>Экземпляр</strong> – представляет собой программу, как единицу исполнения,
связанную (ассоциированную) с определённой задачей. Так же, как
экземпляр, рассматриваются переменные, определённые в программных
модулях: программа и функциональный блок.</p>
<p><strong>Пользовательский тип данных</strong> – тип данных, добавленный в проект и
представляющий собой: псевдоним существующего типа, поддиапазон
существующего типа, перечисление, массив или структуру.</p>
</div>
<div class="section" id="beremiz">
<h1>Основные компоненты среды разработки «Beremiz»<a class="headerlink" href="#beremiz" title="Ссылка на этот заголовок">¶</a></h1>
<p>Пользовательский интерфейс среды разработки «Beremiz» состоит из
следующих компонент:</p>
<ul class="simple">
<li>главное меню программы;</li>
<li>панель инструментов;</li>
<li>дерево проекта;</li>
<li>панель списка переменных и констант;</li>
<li>панель настроек проекта;</li>
<li>панель файлов проекта;</li>
<li>панель отображения промежуточного кода;</li>
<li>текстовые редакторы языков ST и IL;</li>
<li>графические редакторы языков FBD, SFC, LD;</li>
<li>панель редактирования ресурса;</li>
<li>панель экземпляров проекта;</li>
<li>панель библиотеки функций и функциональных блоков;</li>
<li>отладочная консоль;</li>
<li>поиск элементов в проекте;</li>
<li>панель отладки;</li>
<li>панель графика изменения значения переменной в режиме отладки.</li>
</ul>
<p>Далее подробно рассказано про каждый компонент среды разработки
«Beremiz» в отдельности.</p>
<div class="section" id="id4">
<h2>Главное меню программы<a class="headerlink" href="#id4" title="Ссылка на этот заголовок">¶</a></h2>
<p>Главное меню программы (см. рис. Рис. 2) содержит следующие пункты:</p>
<ul class="simple">
<li>«Файл»;</li>
<li>«Редактировать»;</li>
<li>«Вид»;</li>
<li>«Помощь».</li>
</ul>
<p><a class="reference internal" href="../_images/image21.png"><img alt="image0" src="../_images/image21.png" style="width: 169.2px; height: 13.8px;" /></a></p>
<p>Рис. 2 – Главное меню программы</p>
<p>Часть операций, выполняемых с помощью выбора определённого пункта меню
мышью, могут быть исполнены с помощью «горячей клавиши». Далее будет
подробно описан каждый пункт меню и соответствующая ему (если
определена) «горячая клавиша».</p>
<p>Меню «Файл» предназначено для работы с проектом и предоставляет
следующие пункты:</p>
<ul class="simple">
<li>«Новый» – создание нового проекта (CTRL + N);</li>
<li>«Открыть» – открытие существующего проекта (CTRL + O);</li>
<li>«Недавние проекты» – быстрое открытие одного из десяти последних,
недавно редактированных проектов;</li>
<li>«Сохранить» – сохранение текущего проекта пункт (CTRL + S);</li>
<li>«Сохранить как» – сохранение текущего проекта в папку отличную от
той, в которой он сохранён на данный момент (CTRL + SHIFT + S);</li>
<li>«Закрыть вкладку» – закрытие активной вкладки (например, вкладки
переменных плагина, конфигурации и т.д.) для открытого проекта (CTRL
+ W);</li>
<li>«Закрыть проект» – закрыть текущий, открытый проект (CTRL + SHIFT +
W);</li>
<li>«Параметры страницы» – настройка параметров страницы для печати на
принтере активной программы, представленной в виде диаграммы (CTRL +
ALT + P);</li>
<li>«Предпросмотр» – предпросмотр перед печатью на принтере активной
программы (CTRL + SHIFT + P);</li>
<li>«Печать» – печать на принтере активной программы (CTRL + P);</li>
<li>«Выход» – закрытие текущего проекта и выход из программы «Beremiz»
(CTRL+ Q).</li>
</ul>
<p>Меню «Редактировать» предназначено для работы с редакторами языков
стандарта IEC 61131-3 (см. п. 6.6 и 6.7) и предоставляет следующие
возможности:</p>
<ul class="simple">
<li>«Отменить» – отмена последней манипуляции в редакторе (CTRL + Z);</li>
<li>«Повторить» повтор отменённой манипуляции в редакторе (CTRL + Y);</li>
<li>«Вырезать» – удалить в буфер обмена выделенный(е) элемент(ы) в
редакторе (CTRL + X);</li>
<li>«Копировать» – копировать в буфер обмена выделенный(е) элемент(ы) в
редакторе (CTRL + C);</li>
<li>«Вставить» – вставить из буфера обмена находящиеся там элемент(ы) в
редактор (CTRL + V);</li>
<li>«Поиск в проекте» – вызов диалога поиска данных в проекте (CTRL +
SHIFT + F);</li>
<li>«Добавить элемент» – добавление одного из следующих элемента в
текущий проект:<ul>
<li>«Тип данных» – нового типа данных;</li>
<li>«Функция» – новой функции;</li>
<li>«Функциональный блок» – нового функционального блока;</li>
<li>«Программа» – новую программу;</li>
<li>«Ресурс» – новый ресурс;</li>
<li>плагины для различных модулей УСО (см. п. 7);</li>
</ul>
</li>
<li>«Выделить всё» – выделение всех элементов в активной вкладке
редактора (CTRL + A);</li>
<li>«Удалить» – удаление программного модуля, выделенного в дереве
проекта (см. п. 6.3).</li>
</ul>
<p>Меню «Вид» предназначено для работы с редакторами языков стандарта
IEC-61131 и предоставляет следующие возможности:</p>
<ul class="simple">
<li>«Обновить» – обновление данных и снятие выделения в редакторе (CTRL +
R);</li>
<li>«Очистить ошибки» – очистка указателей ошибок в редакторе (CTRL + K);</li>
<li>«Масштаб» – пункт, в котором можно выбрать в процентах величину
масштаба;</li>
<li>«Сброс расположения панелей» – восстановление расположения панелей
«Beremiz» в исходное состояние.</li>
</ul>
<p>Меню «Помощь» предназначено для обращения к выводу информации в виде
диалога о создателях данной среды – пункт «О программе».</p>
</div>
<div class="section" id="id5">
<h2>Панель инструментов<a class="headerlink" href="#id5" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель инструментов представляет собой панель с кнопками для быстрого
обращения к часто используемым функциям среды разработки «Beremiz». Она
состоит из нескольких панелей, содержащих кнопки: главного меню, сборки
проекта и установки связи с целевым устройством. Подробнее об этих
панелях рассказано ниже. При редактировании программных модулей,
написанных на графических языках, появляются дополнительные панели с
кнопками. Они рассмотрены при описании редакторов графических языков
стандарта IEC 61131-3 (см. п. 6.7).</p>
<div class="section" id="id6">
<h3>Кнопки главного меню<a class="headerlink" href="#id6" title="Ссылка на этот заголовок">¶</a></h3>
<p>Панель инструментов, содержащая кнопки главного меню представлена на
рис. Рис. 3.</p>
<p><a class="reference internal" href="../_images/image31.png"><img alt="image1" src="../_images/image31.png" style="width: 268.8px; height: 26.4px;" /></a></p>
<p>Рис. 3 – Панель инструментов</p>
<p>Список кнопок и их функций описывается в таблице 1.</p>
<p>Таблица 1 – Кнопки панели инструментов</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="19%" />
<col width="64%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image41.png"><img alt="image2" src="../_images/image41.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Новый проект</td>
<td>Создать новый проект</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image51.png"><img alt="image3" src="../_images/image51.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Открыть проект</td>
<td>Открыть существующий проект</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image61.png"><img alt="image4" src="../_images/image61.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Сохранить проект</td>
<td>Сохранить текущий проект</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image71.png"><img alt="image5" src="../_images/image71.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Сохранить проект как</td>
<td>Сохранить текущий проект в определённую папку</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image81.png"><img alt="image6" src="../_images/image81.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Печать</td>
<td>Печать на принтере текущей программы</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image91.png"><img alt="image7" src="../_images/image91.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Отменить</td>
<td>Отмена последнего действия в среде разработки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image101.png"><img alt="image8" src="../_images/image101.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Повторить</td>
<td>Повтор отменённого действия в среде разработки</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image111.png"><img alt="image9" src="../_images/image111.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Вырезать</td>
<td>Удалить в буфер обмена выделенный(е) элемент(ы) в редакторе</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image12.png"><img alt="image10" src="../_images/image12.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Копировать</td>
<td>Копировать в буфер обмена выделенный(е) элемент(ы) в редакторе</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image13.png"><img alt="image11" src="../_images/image13.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Вставить</td>
<td>Вставить из буфера обмена находящиеся там элемент(ы) в редактор</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image14.png"><img alt="image12" src="../_images/image14.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Поиск в проекте</td>
<td>Вызов диалога поиска данных в проекте</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image15.png"><img alt="image13" src="../_images/image15.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Выделение объекта</td>
<td>Состояние, при котором возможно выделение объектов в редакторе с помощью мыши</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id7">
<h3>Кнопки сборки проекта и установки связи с целевым устройством<a class="headerlink" href="#id7" title="Ссылка на этот заголовок">¶</a></h3>
<p>Панель, содержащая кнопки сборки проекта и соединения с целевым
устройством, позволяет скомпилировать и скомпоновать текущий проект и, в
случае, если эта операция завершилась успешно (данную информацию можно
увидеть в отладочной консоли (см. п. 6.12)), передать и запустить
полученный исполняемый файл на целевом устройстве.</p>
<p>Часть кнопок данной панели показана на рис. Рис. 4.</p>
<p><a class="reference internal" href="../_images/image16.png"><img alt="image14" src="../_images/image16.png" style="width: 103.8px; height: 29.4px;" /></a></p>
<p>Рис. 4 – Панель сборки проекта и соединения с целевым устройством</p>
<p>Полный список всех кнопок, относящихся к сборке проекта и соединению с
целевым устройством, представлен в таблице 2.</p>
<p>Таблица 2 – Кнопки сборки проекта и связи с целевым устройством на
панели инструментов</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="25%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image17.png"><img alt="image15" src="../_images/image17.png" style="width: 14.4px; height: 14.4px;" /></a></td>
<td>Собрать проект</td>
<td>Полная сборка (компиляция и компоновка) текущего проекта в папку build, находящейся в папке, где хранится проект</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image18.png"><img alt="image16" src="../_images/image18.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Очистить папку для сборки проекта</td>
<td>Удаление папки build, где был собран проект</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image19.png"><img alt="image17" src="../_images/image19.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Соединиться с целевым устройством</td>
<td>Соединиться с целевым устройством по адресу URI, который указан в настройках проекта (п. 6.5)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image20.png"><img alt="image18" src="../_images/image20.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Отключиться от целевого устройства</td>
<td>Разрыв соединения с целевым устройством</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image211.png"><img alt="image19" src="../_images/image211.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Показать сгенерированный IEC код</td>
<td>Отобразить в отдельной панели (см. п. 6.5.1) код на языках ST и LD, который был транслирован в C код</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image22.png"><img alt="image20" src="../_images/image22.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Передача прикладной программы</td>
<td>Перенести исполняемый файл, полученный в ходе сборки проекта, на целевое устройство</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image23.png"><img alt="image21" src="../_images/image23.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Запуск прикладной программы</td>
<td>Запустить на исполнение собранную прикладную программу на целевом устройстве</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image24.png"><img alt="image22" src="../_images/image24.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Остановить работающую прикладную программу</td>
<td>Остановить исполнение прикладной программы на целевом устройстве</td>
</tr>
</tbody>
</table>
<p>В зависимости от того, произведено в настоящий момент времени соединение
с целевым устройством или выполняется ли прикладная программа на нём,
появляются и скрываются некоторые кнопки.</p>
<p>На рис. Рис. 5 приведено состояние данной в панели, когда соединение с
целевым устройством установлено и на нём уже есть прикладная программа.
Соответственно, можно запустить с помощью кнопки «Запуск прикладной
программы» её или передать новую, используя кнопку «Передача прикладной
программы».</p>
<p><a class="reference internal" href="../_images/image25.png"><img alt="image23" src="../_images/image25.png" style="width: 149.4px; height: 29.4px;" /></a></p>
<p>Рис. 5 – Панель инструментов сборки проекта и соединения с целевым
устройством</p>
<p>Когда соединение с целевым устройством установлено, но при этом сделаны
изменения проекте и необходима сборка нового исполняемого файла – во
время сборки в целях защиты от ошибок кнопки становятся недоступными
(см. рис. Рис. 6).</p>
<p><a class="reference internal" href="../_images/image26.png"><img alt="image24" src="../_images/image26.png" style="width: 149.4px; height: 29.4px;" /></a></p>
<p>Рис. 6 – Панель инструментов сборки проекта и соединения с целевым
устройством</p>
<p>В случае, когда при установке соединения произошли ошибки, данная
информация будет выведена в отладочную консоль (см. п. 6.12). Далее
будет рассмотрен компонент «Дерево проекта», который представляет
структуру элементов, составляющих проект.</p>
</div>
</div>
<div class="section" id="id8">
<h2>Дерево проекта<a class="headerlink" href="#id8" title="Ссылка на этот заголовок">¶</a></h2>
<p>Дерево проекта обычно расположено в левой части окна среды разработки
«Beremiz» (см. рис. Рис. 7) и отображает структуру элементов, из которых
состоит проект.</p>
<p><a class="reference internal" href="../_images/image27.png"><img alt="image25" src="../_images/image27.png" style="width: 172.2px; height: 204.0px;" /></a></p>
<p>Рис. 7 – Дерево проекта</p>
<p>В роли элементов могут выступать:</p>
<ul class="simple">
<li>ресурсы;</li>
<li>программные модули (функции, функциональные блоки и программ) и их
составные части;</li>
<li>типы данных;</li>
<li>плагины модулей УСО.</li>
</ul>
<p>Дерево проекта позволяет добавлять, удалять элементы. Операции
копирования и вставки только доступны для программных модулей.</p>
<div class="section" id="id9">
<h3>Добавление элемента в дерево проекта<a class="headerlink" href="#id9" title="Ссылка на этот заголовок">¶</a></h3>
<p>В правом нижнем углу дерева проекта находится кнопка «+» (см. рис. Рис.
8), при нажатии на которую, появляется меню для выбора добавления
необходимого элемента в проект.</p>
<p><a class="reference internal" href="../_images/image28.png"><img alt="image26" src="../_images/image28.png" style="width: 220.5px; height: 304.0px;" /></a></p>
<p>Рис. 8 – Всплывающее меню добавления элементов проекта на панели проекта</p>
<p>В случае добавления программного модуля, т.е. выбора пункта «Функция»,
«Функциональный блок» или «Программа», появится диалог «Создать новый
программный модуль» (см. рис. Рис. 9).</p>
<p><a class="reference internal" href="../_images/image29.png"><img alt="image27" src="../_images/image29.png" style="width: 180.6px; height: 134.4px;" /></a></p>
<p>Рис. 9 – Диалог добавления программного модуля</p>
<p>В данном диалоге три поля:</p>
<ul class="simple">
<li>«Имя программного модуля»;</li>
<li>«Тип программного модуля»;</li>
<li>«Язык».</li>
</ul>
<p>Имя, присвоенное по умолчанию, может быть заменено на имя,
соответствующее назначению данного программного модуля. В зависимости от
того, какой программный модуль был выбран во всплывающем меню, в поле
«Тип программного модуля» будет подставлено именование данного
программного модуля. В поле «Язык» необходимо выбрать из списка (см.
рис. Рис. 10) один из языков стандарта IEC 61131-3 (IL, ST, LD, FBD,
SFC), на котором будут реализованы алгоритмы и логика работы данного
добавляемого программного модуля.</p>
<p><a class="reference internal" href="../_images/image30.png"><img alt="image28" src="../_images/image30.png" style="width: 180.0px; height: 196.8px;" /></a></p>
<p>Рис. 10 – Выбор языка для программного модуля</p>
<p>В случае выбора добавления типа данных, появится диалог (см. рис. Рис.
11), в котором необходимо указать имя нового пользовательского типа
данных.</p>
<p><a class="reference internal" href="../_images/image311.png"><img alt="image29" src="../_images/image311.png" style="width: 722.7px; height: 258.3px;" /></a></p>
<p>Рис. 11 – Диалог ввода имени создаваемого нового типа данных</p>
<p>Добавление нескольких элементов одного типа, например нескольких
программ, функций, функциональных блоков приводит к их группировке в
дереве проекта. Еще одним способом добавления нового элемента является
нажатие правой клавиши мыши по определённому разделу в дереве проекта.
Например, при нажатии на «Программы», появится всплывающее меню (см.
рис. Рис. 12). В данном меню можно выбрать «Добавить программный модуль»
или «Вставить программный модуль», если он был скопирован в буфер
обмена.</p>
<p><a class="reference internal" href="../_images/image32.png"><img alt="image30" src="../_images/image32.png" style="width: 168.0px; height: 134.4px;" /></a></p>
<p>Рис. 12 – Всплывающее меню добавления и вставки программного модуля</p>
<p>Добавление нового элемента или выбор существующего в дереве проекта
приводит к появлению панели редактирования и настроек соответствующего
элемента:</p>
<ul class="simple">
<li>панель настроек проекта;</li>
<li>панель, содержащая текстовый редактор языков ST и IL;</li>
<li>панель, содержащая графические редакторы диаграмм языков FBD, SFC,
LD;</li>
<li>панель настроек ресурса;</li>
<li>панель редактирование типа данных;</li>
<li>панели настроек плагинов модулей УСО.</li>
</ul>
<p>Каждая вышеперечисленная панель редактирования будет рассмотрена в
последующих пунктах.</p>
</div>
<div class="section" id="id10">
<h3>Удаление элемента в дереве проекта<a class="headerlink" href="#id10" title="Ссылка на этот заголовок">¶</a></h3>
<p>Удаление осуществляется наведением на определённый элемент в дереве
проекта и нажатием на него правой клавишей мыши, а далее в появившемся
меню выбирается пункт «Удалить» (см. рис. Рис. 13)</p>
<p><a class="reference internal" href="../_images/image33.png"><img alt="image31" src="../_images/image33.png" style="width: 169.8px; height: 97.8px;" /></a></p>
<p>Рис. 13 – Удаление элемента</p>
</div>
<div class="section" id="id11">
<h3>Переименование, копирование и вставка программных модулей<a class="headerlink" href="#id11" title="Ссылка на этот заголовок">¶</a></h3>
<p>Дерево проекта позволяет выполнять операции переименования, копирования
и вставки для программных модулей. Копирование или переименование
осуществляются с помощью нажатия правой клавиши мыши на элемент (см.
рис. Рис. 14), соответствующий программному модулю в дереве проекта, и
выбор соответствующего пункта появившегося меню.</p>
<p><a class="reference internal" href="../_images/image34.png"><img alt="image32" src="../_images/image34.png" style="width: 162.0px; height: 100.8px;" /></a></p>
<p>Рис. 14 – Пункт «Копировать программный модуль»</p>
<p>Вставка программного модуля осуществляется в меню (нажатие правой
клавишей мыши по данному элементу) корневого элемента дерева проекта,
соответствующего проекту (см. рис. Рис. 15):</p>
<p><a class="reference internal" href="../_images/image35.png"><img alt="image33" src="../_images/image35.png" style="width: 167.05px; height: 55.25px;" /></a></p>
<p>Рис. 15 – Пункт «Вставка программного модуля»</p>
<p>Другим способом выполнения вышеописанной операции является вызов меню
для элемента группировки программных модулей одного типа (см. рис. Рис.
16).</p>
<p><a class="reference internal" href="../_images/image36.png"><img alt="image34" src="../_images/image36.png" style="width: 159.6px; height: 61.2px;" /></a></p>
<p>Рис. 16 – Пункт «Вставка программного модуля»</p>
<p>Далее приводится описание панели переменных и констант, которая
присутствует при редактировании проекта, ресурса и программных модулей
(функции, функционального блока, программы).</p>
</div>
</div>
<div class="section" id="id12">
<h2>Панель списка переменных и констант<a class="headerlink" href="#id12" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель списка переменных и констант (см. рис. Рис. 17) отображает с
помощью таблицы переменные и константы, соответствующие выбранному
программному модулю, ресурсу или в целом проекту.</p>
<p><a class="reference internal" href="../_images/image37.png"><img alt="image35" src="../_images/image37.png" style="width: 700.2px; height: 159.3px;" /></a></p>
<p>Рис. 17 – Панель переменных и констант</p>
<p>Каждая переменная имеет следующие параметры:</p>
<ul class="simple">
<li>имя, представляющее собой уникальный идентификатор переменной в
пределах её области видимости и действия;</li>
<li>класс: «Глобальная», «Входная», «Выходная», «Входная/Выходная»,
«Локальная», «Внешняя», «Временная»;</li>
<li>тип, определяющий тип переменной и может принадлежать базовому типу
(в соответствии со стандартом IEC 61131-3), пользовательскому типу
(псевдониму и поддиапазону существующего типа, перечислению, массиву,
структуре) или типу функционального блока (стандартному или
пользовательскому);</li>
<li>адрес – идентификатор, необходимый для связывания данной переменной с
переменной плагина модуля УСО (подробнее в п. 7.1.4);</li>
<li>начальное значение – инициализация переменной некоторым начальным
значением;</li>
<li>опция – задание константности, сохраняемости (сохранение её значения
в энергонезависимой памяти) и несохраняемости переменной;</li>
<li>документация – комментарий к назначению данной переменной или
константы.</li>
</ul>
<p>Первый символ имени переменной или константы должен быть буквой, или
символом подчеркивания, далее могут следовать цифры, буквы латинского
алфавита и символы подчеркивания. Набор возможных вариантов классов
переменных зависит от типа элемента проекта, редактирования которого
осуществляется. Двойной клик на полю «Адрес» вызывает появление кнопки
«…», показанной на рис. Рис. 18:</p>
<p><a class="reference internal" href="../_images/image38.png"><img alt="image36" src="../_images/image38.png" style="width: 112.0px; height: 72.0px;" /></a></p>
<p>Рис. 18 – Поле «Адрес» панели переменных и констант</p>
<p>Нажатие на данную кнопку приводит к появлению диалога «Просмотр адресов»
(см. рис. Рис. 19), т.е. списка переменных модулей УСО, которые могут
быть связанны с переменой в панели переменных и констант. При выборе в
данном диалоге определённой переменной и нажатии клавиши «OK» в поле
«Адрес» будет добавлен адрес переменной внешнего модуля УСО.</p>
<p><a class="reference internal" href="../_images/image39.png"><img alt="image37" src="../_images/image39.png" style="width: 420.7px; height: 268.8px;" /></a></p>
<p>Рис. 19 – Диалог «Просмотр адресов», вызываемый из поля «Адрес»</p>
<p>Поле опции позволяет определить переменную как константу.
Соответственно, если компилятор обнаружит в коде фрагмент, в котором
происходит изменение этой переменной – будет выведена ошибка компиляции
«Assignment to CONSTANT variables is not be allowed» в «Отладочной
консоли». Квалификатор «Константа» не может быть использован в
объявлении функциональных блоков. Добавление, удаление и перемещение
переменных происходит с помощью специальных кнопок на панели переменных
и констант. Описания данных кнопок представлены в таблице 3.</p>
<p>Панель переменных и констант предоставляет возможность фильтровать
отображаемые переменные по их конкретным классам («Входная», «Выходная»,
«Входная/Выходная», «Внешняя», «Локальная», «Временная») или
сгруппированным классам («Интерфейс» и «Переменные»). Данная операция
выполняется с помощью функции «Фильтр по классам» (см. рис. Рис. 20).</p>
<p><a class="reference internal" href="../_images/image40.png"><img alt="image38" src="../_images/image40.png" style="width: 156.6px; height: 192.0px;" /></a></p>
<p>Рис. 20 – Фильтрация отображения переменных в панели переменных и
констант</p>
<p>В нижней части рабочей области может располагаться панель с настройками
проекта, панель ресурсов, редакторы текстовых и графических языков
стандарта IEC 61131-3, редакторы для настройки параметров внешних
плагинов, визуализация процесса отладки графических языков стандарта IEC
61131-3 и другие элементы. Далее следует подробное их описание.</p>
<p>Таблица 3 – Кнопки добавления, удаление и перемещения переменных на
панели переменных и констант</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="23%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image411.png"><img alt="image39" src="../_images/image411.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить переменную</td>
<td>Добавить новую переменную в панель переменных и констант со значениями по умолчанию</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image42.png"><img alt="image40" src="../_images/image42.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Удалить переменную</td>
<td>Удалить выделенную переменную или константу</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image43.png"><img alt="image41" src="../_images/image43.png" style="width: 0.25000in; height: 0.25000in;" /></a></td>
<td>Добавить переменные</td>
<td>Добавление переменных внешних добавленных в проект плагинов (подробнее в п. 7)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image44.png"><img alt="image42" src="../_images/image44.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Переместить переменную вверх</td>
<td>Перемещение переменной в таблице переменных и констант вверх на одну позицию</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image45.png"><img alt="image43" src="../_images/image45.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Переместить переменную вниз</td>
<td>Перемещение переменной в таблице переменных и констант вниз на одну позицию</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id13">
<h2>Панель настройки проекта<a class="headerlink" href="#id13" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель редактирования проекта (см. рис. Рис. 21) состоит из панели
переменных и констант, а также настроек сборки проекта и данных о
проекте.</p>
<p><a class="reference internal" href="../_images/image46.png"><img alt="image44" src="../_images/image46.png" style="width: 1218.6px; height: 540.9px;" /></a></p>
<p>Рис. 21 – Панель настройки проекта</p>
<p>Панель переменных и констант, позволяющая задать глобальные переменные
на уровне проекта, располагается вверху. Ниже две области: слева
настройки параметров сборки данного проекта, а справа поля с различной
информацией о проекте.</p>
<p>Настройки сборки проекта (см. рис. Рис. 22) позволяют задать следующие
параметры:</p>
<ul class="simple">
<li>«URI адрес» – унифицированный (единообразный) идентификатор ресурса,
в данном случае под ресурсом понимается целевое устройство. Данный
адрес необходим для режима отладки, о котором подробно рассказано в
п. 9;</li>
<li>«Отключить внешние модули» – установка данного флага позволяет не
учитывать при сборке проекта внешние плагины (см. п. 7);</li>
<li>«Библиотеки» – подключаемые дополнительные библиотеки:
«Python_Library» и «SVGUI_Library»;</li>
<li>«Целевая платформа» – выбор из списка компилятора для архитектуры
целевого устройства;</li>
<li>«Компилятор» – имя исполняемого файла компилятора (если он определён
в глобальных переменных среды), либо полный путь к нему;</li>
<li>«CFLAGS» – указание флагов С компилятора;</li>
<li>«Компоновщик» – имя исполняемого файла компоновщика (если он
определён в глобальных переменных среды), либо полный путь к нему;</li>
<li>«LDFLAGS» – указание флагов компоновщика;</li>
<li>«CygwinPath» – путь к папке, где находится UNIX-подобная среда
Cygwin, необходимая для работы кросскомпиляторов.</li>
</ul>
<p><a class="reference internal" href="../_images/image47.png"><img alt="image45" src="../_images/image47.png" style="width: 322.8px; height: 294.0px;" /></a></p>
<p>Рис. 22 – Панель с настройками проекта</p>
<p>Так же в настройках сборки проекта имеются две кнопки, описание которых
приведено в таблице 4.</p>
<p>Таблица 4 – Кнопки в панели настройки сборки проекта</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="12%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image48.png"><img alt="image46" src="../_images/image48.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Промежуточный IEC код</td>
<td>Вызов «Панели отображения промежуточного кода» (см. п. 6.5.1), для вывода кода, из которого генерируется ST код всего проекта</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image49.png"><img alt="image47" src="../_images/image49.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Файлы проекта</td>
<td>Вызов «Панели файлов проекта», в которой можно выбрать файлы необходимые для передачи на целевое устройство вместе с исполняемым файлом (см. п. 6.5.2)</td>
</tr>
</tbody>
</table>
<p>Вкладка «Проект» (см. рис. Рис. 23) позволяет задать: имя проекта,
версию проекта, имя продукта, версию продукта и релиз продукта.</p>
<p><a class="reference internal" href="../_images/image50.png"><img alt="image48" src="../_images/image50.png" style="width: 735.3px; height: 249.3px;" /></a></p>
<p>Рис. 23 – Вкладка данные о проекте</p>
<p>Вкладка «Автор» (см. рис. Рис. 24) позволяет задать: Имя компании,
URL-адрес компании, Имя автора, Название организации.</p>
<p><a class="reference internal" href="../_images/image511.png"><img alt="image49" src="../_images/image511.png" style="width: 736.2px; height: 208.8px;" /></a></p>
<p>Рис. 24 – Вкладка данные об авторе проекта</p>
<p>Вкладка «Параметры графики» (см. рис. Рис. 25) позволяет задать размеры
страницы и разрешение сетки для редакторов диаграмм графических языков
FBD, LD и SFC.</p>
<p><a class="reference internal" href="../_images/image52.png"><img alt="image50" src="../_images/image52.png" style="width: 724.5px; height: 271.8px;" /></a></p>
<p>Рис. 25 – Вкладка настроек параметров редакторов графических языков</p>
<p>Вкладка «Разное», изображенная на рис. Рис. 26, позволяет выбрать язык
интерфейса для среды разработки «Beremiz» и указать дополнительное
текстовое описание для проекта.</p>
<p>При запуске среды разработки «Beremiz» языком по умолчанию является
язык, соответствующий текущей локали операционной системы, если файл для
данной локали присутствуют. В случае отсутствия данных файлов,
устанавливается английская локаль, которая доступна всегда. Файлы
доступных локалей располагаются в папке beremiz/locale.</p>
<p><a class="reference internal" href="../_images/image53.png"><img alt="image51" src="../_images/image53.png" style="width: 737.1px; height: 180.0px;" /></a></p>
<p>Рис. 26 – Вкладка с настройками языка и описанием проекта</p>
<p>Далее рассмотрены «Панели отображения промежуточного код на языке ST» и
«Панель файлов проекта», вызываемые с помощью кнопок, описанных в
таблице 4 и располагающихся на панели настроек проекта.</p>
<div class="section" id="id14">
<h3>Панель отображения промежуточного кода<a class="headerlink" href="#id14" title="Ссылка на этот заголовок">¶</a></h3>
<p>Данная панель (см. рис. Рис. 27) представляет собой текстовый редактор,
отображающий с подсветкой синтаксиса и нумерацией строк код на языке ST,
доступный только для чтения, без возможности редактирования.</p>
<p><a class="reference internal" href="../_images/image54.png"><img alt="image52" src="../_images/image54.png" style="width: 368.4px; height: 139.8px;" /></a></p>
<p>Рис. 27 – Панель отображения промежуточного кода на языке ST</p>
<p>Открытие данной панели доступно после сборки проекта с помощью
соответствующей кнопки (см. таблица 4).</p>
</div>
<div class="section" id="id15">
<h3>Панель файлов проекта<a class="headerlink" href="#id15" title="Ссылка на этот заголовок">¶</a></h3>
<p>Панель файлов проекта (см. рис. Рис. 28) содержит встроенный проводник
файлов (справа), в котором файлы могут быть выделены и перенесены в
левую часть.</p>
<p><a class="reference internal" href="../_images/image55.png"><img alt="image53" src="../_images/image55.png" style="width: 730.4px; height: 350.4px;" /></a></p>
<p>Рис. 28 – Вкладка файлы проекта</p>
<p>Все манипуляции с файлами осуществляются с помощью кнопок, расположенных
в середине данной панели. Их описание приведено в таблице 5.</p>
<p>Таблица 5 – Кнопки в панели файлов проекта</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="25%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image56.png"><img alt="image54" src="../_images/image56.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Удалить файл списка файлов проекта</td>
<td>Удаление выделенного файла из левого списка добавленных файлов в проект</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image57.png"><img alt="image55" src="../_images/image57.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить файл в проект</td>
<td>Добавить выделенный файл из проводника файлов в проект</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image58.png"><img alt="image56" src="../_images/image58.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить файл в проводник</td>
<td>Добавить в текущую папку проводника файлов слева выделенный файл в списке файлов проекта</td>
</tr>
</tbody>
</table>
<p>Данные файлы будут переданы на целевое устройство вместе с исполняемым
файлом. Как правило, этими дополнительными файлами проекта являются
сторонние библиотеки, необходимые для корректной работы плагинов модулей
УСО.</p>
</div>
</div>
<div class="section" id="st-il">
<h2>Текстовый редактор языков ST и IL<a class="headerlink" href="#st-il" title="Ссылка на этот заголовок">¶</a></h2>
<p>Текстовый редактор языков ST и IL (см. рис. Рис. 29) позволяет создавать
и редактировать алгоритмы и логику выполнения программных модулей на
языках ST и IL.</p>
<p><a class="reference internal" href="../_images/image59.png"><img alt="image57" src="../_images/image59.png" style="width: 696.0px; height: 300.8px;" /></a></p>
<p>Рис. 29 – Редактор языков ST и IL</p>
<p>Он обеспечивают следующие возможности:</p>
<ul class="simple">
<li>подсветку синтаксиса кода, написанного пользователем, т.е. выделения
особыми параметрами шрифта ключевых слов данных языков;</li>
<li>нумерации строк, что может быть полезным при возникновении ошибок в
программе, т.к. транслятор кода ST в C выдаёт номер строки, в которой
найдена ошибка;</li>
<li>сворачивание кода структурных элементов языка: определения функции,
определение типа и т.д.</li>
</ul>
<p>Увеличение или уменьшение размера шрифт выполняется с помощью Ctrl +
&lt;колёсико мыши&gt;.</p>
<p>Описание синтаксиса, основных конструкций и примеров использования языка
ST приведены в приложении 3, а языка IL в приложении 4.</p>
</div>
<div class="section" id="fbd-sfc-ld">
<h2>Графические редакторы диаграмм языков FBD, SFC, LD<a class="headerlink" href="#fbd-sfc-ld" title="Ссылка на этот заголовок">¶</a></h2>
<p>Данные редакторы позволяют создавать и редактировать алгоритмы и логику
выполнения программных модулей, написанных на языках FBD, SFC и LD.</p>
<div class="section" id="fbd">
<h3>Редактор языка FBD<a class="headerlink" href="#fbd" title="Ссылка на этот заголовок">¶</a></h3>
<p>Основными элементами языка FBD являются: переменные, функции,
функциональные блоки и соединения. При редактировании FBD диаграммы, в
панели инструментов появляется следующая панель (см. рис. Рис. 30).</p>
<p><a class="reference internal" href="../_images/image60.png"><img alt="image58" src="../_images/image60.png" style="width: 141.0px; height: 28.2px;" /></a></p>
<p>Рис. 30 – Панель редактирования FBD диаграмм</p>
<p>С помощью данной панели можно добавить все элементы языка FBD
(назначение каждой кнопки описано в таблице 6).</p>
<p>Таблица 6 – Кнопки панели редактирования FBD диаграммы</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="21%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image611.png"><img alt="image59" src="../_images/image611.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Выделение объектов на диаграмме</td>
<td>Перевод указателя мыши в состояние, при котором можно осуществлять выделение объектов редакторе одного из графических языков</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image62.png"><img alt="image60" src="../_images/image62.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Перемещение диаграммы</td>
<td>Перевод указателя мыши в состояние, при котором можно изменять размеры редактора одного из графических языков, с помощью его перемещения</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image63.png"><img alt="image61" src="../_images/image63.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый комментарий</td>
<td>Вызов диалога создания комментария</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image64.png"><img alt="image62" src="../_images/image64.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить переменную</td>
<td>Вызов диалога добавления переменной</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image65.png"><img alt="image63" src="../_images/image65.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить функцию или функциональный блок</td>
<td>Вызов диалога добавления функции или функционального блока</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image66.png"><img alt="image64" src="../_images/image66.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Добавить соединение</td>
<td>Вызов диалога добавления соединения</td>
</tr>
</tbody>
</table>
<p>Для этого необходимо указателем мыши выбрать необходимую кнопку и нажать
на свободное место в области редактирования FBD диаграммы. В зависимости
от выбранного элемента появятся определённые диалоги добавления данного
элемента.</p>
<p>Аналогичные действия можно выполнить с помощью всплывающего меню в
области редактирования FBD диаграмм. Вызов данного меню происходит
нажатием правой клавишей мыши и выбором пункта «Добавить», в котором
будет: «Блок», «Переменная», «Соединение», «Комментарий» (см. рис. Рис.
31).</p>
<p><a class="reference internal" href="../_images/image67.png"><img alt="image65" src="../_images/image67.png" style="width: 232.2px; height: 111.0px;" /></a></p>
<p>Рис. 31 – Всплывающее меню редактора языка FBD</p>
<p>Далее рассмотрено добавление каждого элемента в отдельности.</p>
<div class="section" id="id16">
<h4>Добавление функции или функционального блока<a class="headerlink" href="#id16" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении функции или функционального блока одним из описанных выше
способов, появится диалог «Свойства блока» (см. рис. Рис. 32).</p>
<p><a class="reference internal" href="../_images/image68.png"><img alt="image66" src="../_images/image68.png" style="width: 358.8px; height: 258.0px;" /></a></p>
<p>Рис. 32 – Свойства функции или функционального блока</p>
<p>В данном диалоге приведено краткое описание функции или функционального
блока и предоставлена возможность задать некоторые свойства (имя,
количество входов, порядок выполнения и т.д.).</p>
<p>Опция «Управление выполнением» добавляет в функцию или функциональный
блок дополнительные параметры EN/ENO, о которых подробнее рассказано в
приложении 5. Для сохранения изменений необходимо нажать «OK». Одним из
свойств является «Порядок выполнения», его назначение рассматривается в
п. 6.7.1.5.</p>
<p>Добавление (путем копирования существующего блока), удаление и
переименование функции или функционального блока осуществляется при
помощи команд меню «Редактирование» в главном меню или с помощью
всплывающего меню диаграммы (см. рис. Рис. 31).</p>
<p>Следует отметить, что функция или функциональный блок могут быть так же
добавлены из «Панели библиотеки функций и функциональных блоков» (см. п.
6.11), перетаскиванием мыши (Drag&amp;Drop) выбранного блока на панель
редактирования диаграммы FBD.</p>
</div>
<div class="section" id="id17">
<h4>Добавление переменной<a class="headerlink" href="#id17" title="Ссылка на этот заголовок">¶</a></h4>
<p>Переменные добавляются из панели переменных и констант с помощью
перетаскивания (Drag&amp;Drop) левой клавишей мыши за область, выделенную
красным цветом на рис. Рис. 33, в область редактирования FBD диаграмм.</p>
<p><a class="reference internal" href="../_images/image69.png"><img alt="image67" src="../_images/image69.png" style="width: 1292.4px; height: 556.2px;" /></a></p>
<p>Рис. 33 – Добавление переменной из панели переменных и констант</p>
<p>Изменить параметры переменной можно в диалоге «Свойства переменной» (см.
рис. Рис. 34), нажав на неё два раза левой клавишей мыши.</p>
<p><a class="reference internal" href="../_images/image70.png"><img alt="image68" src="../_images/image70.png" style="width: 198.5px; height: 181.0px;" /></a></p>
<p>Рис. 34 – Свойства переменной</p>
<p>В данном диалоге можно задать порядок выполнения переменной и изменить
её класс («Входная», «Выходная», «Входная/Выходная»).</p>
</div>
<div class="section" id="id18">
<h4>Добавление соединения<a class="headerlink" href="#id18" title="Ссылка на этот заголовок">¶</a></h4>
<p>В тех случаях, когда необходимо передать выходное значение одного
функционального блока на один из входов другого, удобно использовать
элемент «Соединение». При прямом соединении с помощью перетаскивания
выхода одного функционального блока к входу другого получится прямое
соединение с помощью чёрной соединительной линии. На схемах с большим
количеством функциональных блоков элемент «Соединение» позволяет
избежать пересечения прямых соединений, которые приводит к тому, что
схема становится менее понятной.</p>
<p>После выбора добавления элемента «Соединение» появится диалог «Свойства
соединения» (см. рис. Рис. 35).</p>
<p><a class="reference internal" href="../_images/image711.png"><img alt="image69" src="../_images/image711.png" style="width: 207.6px; height: 139.8px;" /></a></p>
<p>Рис. 35 – Диалог добавления соединения для FBD</p>
<p>В данном диалоге можно выбрать тип соединения: «Выходное соединение» –
для выходного значения, «Входное соединение» – для входного значения, а
так же необходимо указать имя данного соединения. На рис. Рис. 36
представлен пример использования соединений.</p>
<p><a class="reference internal" href="../_images/image72.png"><img alt="image70" src="../_images/image72.png" style="width: 363.6px; height: 139.2px;" /></a></p>
<p>Рис. 36 – Пример FBD диаграммы с использованием соединений</p>
<p>Функция «MAX» на выходе «OUT» имеет некоторое значение, которое с
помощью соединения «RESULT» передаётся на вход «IN1» в функцию «MIN». В
функции «MAX» используется соединение типа «Выходное соединение», в
функции «MIN» – типа «Входное соединение». Имена у этих соединений,
соответственно, одинаковые.</p>
<blockquote>
<div>Добавление комментариев</div></blockquote>
<hr class="docutils" />
<p>Редактор FBD диаграмм (и остальные редакторы, о которых будет рассказано
ниже) позволяют добавлять комментарии на диаграмму. После выбора на
панели редактирования комментария и добавления его в область
редактирования появится диалог (см. рис. Рис. 37) для ввода текста
комментария.</p>
<p><a class="reference internal" href="../_images/image73.png"><img alt="image71" src="../_images/image73.png" style="width: 238.8px; height: 132.6px;" /></a></p>
<p>Рис. 37 – Диалог добавления комментария</p>
<p>После нажатия кнопки OK комментарий появится на диаграмме (см. рис. Рис.
38).</p>
<p><a class="reference internal" href="../_images/image74.png"><img alt="image72" src="../_images/image74.png" style="width: 352.2px; height: 157.8px;" /></a></p>
<p>Рис. 38 – Добавленный комментарий к FBD диаграмме</p>
</div>
<div class="section" id="id19">
<h4>Порядок выполнения функций и функциональных блоков<a class="headerlink" href="#id19" title="Ссылка на этот заголовок">¶</a></h4>
<p>Последовательность исполнения функций и функциональных блоков
определяется порядком их выполнения. Автоматически он регламентируется
следующим образом: чем выше и левее расположен верхний левый угол,
описывающего функцию или функциональный блок прямоугольника, тем раньше
данная функция или функциональный будет выполнен.</p>
<p>Если обратиться к рис. Рис. 39, то порядок выполнения функций будет
следующим: 1) SUB 2) MUL 3) ADD.</p>
<p><a class="reference internal" href="../_images/image75.png"><img alt="image73" src="../_images/image75.png" style="width: 4.14861in; height: 1.98264in;" /></a></p>
<p>Рис. 39 – Схема, содержащая функции с порядком выполнения (обсчета) по
расположению</p>
<p>Порядок выполнения может быть изменён вручную с помощью диалога свойств.
Данная опция «Порядок выполнения» выделена красным цветом на рис. Рис.
40.</p>
<p><a class="reference internal" href="../_images/image76.png"><img alt="image74" src="../_images/image76.png" style="width: 4.10556in; height: 2.91528in;" /></a></p>
<p>Рис. 40 – Свойство порядок выполнения функции или функционального блока</p>
<p>После задания порядка выполнения для каждой функции или функционального
блока на схеме в правом нижнем углу будет указан его порядковый номер
выполнения. Пример представлен на рис. Рис. 41.</p>
<p><a class="reference internal" href="../_images/image77.png"><img alt="image75" src="../_images/image77.png" style="width: 3.49792in; height: 1.75486in;" /></a></p>
<p>Рис. 41 – Схема, содержащая функции с порядком выполнения заданным
вручную</p>
<p>Описание языка FBD, основных его конструкций и пример использования
приведены в приложении 5.</p>
</div>
</div>
<div class="section" id="ld">
<h3>Редактор языка LD<a class="headerlink" href="#ld" title="Ссылка на этот заголовок">¶</a></h3>
<p>Язык LD или РКС (Релейно-Контактные Схемы) представляет собой
графическую форму записи логических выражений в виде контактов и катушек
реле. Основными элементами языка LD являются: шина питания, катушка,
контакт. Добавить данные элементы, так же как и элементы языка FBD,
можно несколькими способами.</p>
<p>Как только активной становится вкладка с редактированием LD диаграммы, в
панели инструментов появляется панель (см. рис. Рис. 42) с элементами
языка LD.</p>
<p><a class="reference internal" href="../_images/image78.png"><img alt="image76" src="../_images/image78.png" style="width: 204.0px; height: 27.0px;" /></a></p>
<p>Рис. 42 – Панель редактирования LD диаграмм</p>
<p>Аналогично редактору языка FBD с помощью данной панели можно добавить
все элементы языка LD, а так же и FBD, т.к. есть возможность
комбинированного применения языков на одной диаграмме. В таблице 7
приведено описание кнопок данной панели. Описание остальных кнопок,
относящихся к языку FBD, находится в таблице 6.</p>
<p>Таблица 7 – Кнопки панели редактирования LD диаграммы</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="31%" />
<col width="46%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image79.png"><img alt="image77" src="../_images/image79.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новую шину питания</td>
<td>Вызов диалога создания новой шины питания</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image80.png"><img alt="image78" src="../_images/image80.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новую катушку</td>
<td>Вызов диалога создания новой катушки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image811.png"><img alt="image79" src="../_images/image811.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый контакт</td>
<td>Вызов диалога создания нового контакта</td>
</tr>
</tbody>
</table>
<p>Во всплывающем меню для редактора LD диаграмм (см. рис. Рис. 43), так же
как и в панели инструментов помимо элементов LD языка, доступны элементы
языка FBD.</p>
<p><a class="reference internal" href="../_images/image82.png"><img alt="image80" src="../_images/image82.png" style="width: 167.4px; height: 127.8px;" /></a></p>
<p>Рис. 43 – Всплывающее меню редактора языка LD</p>
<div class="section" id="id20">
<h4>Добавление шины питания<a class="headerlink" href="#id20" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении шины питания, одним из описанных выше способов, появится
диалог «Свойства шины питания» (см. рис. Рис. 44).</p>
<p>В данном диалоге указываются следующие свойства:</p>
<ul class="simple">
<li>тип шины питания: шина питания слева или шина питания справа;</li>
<li>количество контактов на добавляемой шине питания.</li>
</ul>
<p><a class="reference internal" href="../_images/image83.png"><img alt="image81" src="../_images/image83.png" style="width: 210.0px; height: 147.0px;" /></a></p>
<p>Рис. 44 – Свойство шины питания</p>
<p>На рис. Рис. 45 приведены две добавленные шины питания: левая с тремя
контактами и правая с одним контактом.</p>
<p><a class="reference internal" href="../_images/image84.png"><img alt="image82" src="../_images/image84.png" style="width: 0.92153in; height: 1.13958in;" /></a></p>
<p>Рис. 45 – Шины питания на LD диаграмме</p>
</div>
<div class="section" id="id21">
<h4>Добавление контакта<a class="headerlink" href="#id21" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении контакта на LD диаграмму появится диалог «Редактирование
значения контакта» (см. рис. Рис. 46).</p>
<p><a class="reference internal" href="../_images/image85.png"><img alt="image83" src="../_images/image85.png" style="width: 207.6px; height: 179.4px;" /></a></p>
<p>Рис. 46 – Редактирование контакта</p>
<p>Данный диалог позволяет определить модификатор данного контакта:</p>
<ul class="simple">
<li>«Нормальный»;</li>
<li>«Инверсный»;</li>
<li>«Нарастание фронта»;</li>
<li>«Спад фронта».</li>
</ul>
<p>Кроме того, диалог позволяет выбрать из списка «Имя» переменную,
«связываемую» с данным контактом. Следует отметить, что «связываемые»
переменные должны быть определены в панели переменных и констант для
данного программного модуля типом BOOL.</p>
<p>Еще одним способом добавления контакта на диаграмму является метод
Drag&amp;Drop из панели переменных и констант переменной типа BOOL и класса:
«Входная», «Входная/Выходная», «Внешняя», «Локальная», «Временная». Для
этого необходимо зажать левой кнопкой мыши за первый столбец (который
имеет заголовок #) переменную, удовлетворяющую описанным выше критериям
и перенести в область редактирования диаграммы (см. рис. Рис. 47).</p>
<p><a class="reference internal" href="../_images/image86.png"><img alt="image84" src="../_images/image86.png" style="width: 175.8px; height: 192.0px;" /></a></p>
<p>Рис. 47 – Добавление контакта на диаграмму из панели переменных и
констант</p>
</div>
<div class="section" id="id22">
<h4>Добавление катушки<a class="headerlink" href="#id22" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении катушки на LD диаграмму появится диалог «Редактирование
значения катушки» (см. рис. Рис. 48).</p>
<p><a class="reference internal" href="../_images/image87.png"><img alt="image85" src="../_images/image87.png" style="width: 207.0px; height: 214.8px;" /></a></p>
<p>Рис. 48 – Редактирование катушки</p>
<p>В данном диалоге можно определить модификатор данного контакта:</p>
<ul class="simple">
<li>«Нормальный»;</li>
<li>«Инверсный»;</li>
<li>«Установка»;</li>
<li>«Сброс»;</li>
<li>«Нарастание фронта»;</li>
<li>«Спад фронта».</li>
</ul>
<p>Кроме того, производится выбор из списка «Имя» переменной, «связываемой»
с данным контактом. Эти переменные, как и для контактов, должны быть
определены в панели переменных и констант для данного программного
модуля типом BOOL.</p>
<p>Аналогично добавлению контакта с помощью Drag&amp;Drop можно добавить и
катушки, но в данном случае переменная должна относиться к классу
«Выходная» (см. рис. Рис. 49).</p>
<p><a class="reference internal" href="../_images/image88.png"><img alt="image86" src="../_images/image88.png" style="width: 171.6px; height: 180.6px;" /></a></p>
<p>Рис. 49 – Добавление катушки на диаграмму из панели переменных и
констант</p>
<p>Описание языка LD, основных конструкций и примера его использования
приведены в приложении 6.</p>
</div>
</div>
<div class="section" id="sfc">
<h3>Редактор языка SFC<a class="headerlink" href="#sfc" title="Ссылка на этот заголовок">¶</a></h3>
<p>Основными элементами языка SFC являются: начальный шаг, шаг, переход,
блок действий, дивергенции, «прыжок». Программа на языке SFC состоит из
набора шагов, связанных переходами.</p>
<p>Как только активной становится вкладка с редактированием SFC диаграммы,
в панели инструментов появляется следующая панель (см. рис. Рис. 50).</p>
<p><a class="reference internal" href="../_images/image89.png"><img alt="image87" src="../_images/image89.png" style="width: 313.2px; height: 28.2px;" /></a></p>
<p>Рис. 50 – Панель редактирования SFC диаграмм</p>
<p>В таблице 8 приведено описание кнопок данной панели. Описание остальных
кнопок, относящихся к языку FBD и LD (за исключением катушки) и так же
находящихся на этой панели, приведены в таблицах 6 и 7 соответственно.</p>
<p>Таблица 8 – Кнопки панели редактирования SFC диаграммы</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="28%" />
<col width="53%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image90.png"><img alt="image88" src="../_images/image90.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый начальный шаг</td>
<td>Вызов диалога редактирования шага</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image911.png"><img alt="image89" src="../_images/image911.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый шаг</td>
<td>Вызов диалога редактирования шага</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image92.png"><img alt="image90" src="../_images/image92.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый переход</td>
<td>Вызов диалога редактирования перехода</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image93.png"><img alt="image91" src="../_images/image93.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый блок действий</td>
<td>Вызов диалога редактирования блока действий</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image94.png"><img alt="image92" src="../_images/image94.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новую дивергенцию</td>
<td>Вызов диалога создания новой дивергенции и конвергенции</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image95.png"><img alt="image93" src="../_images/image95.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Создать новый «прыжок»</td>
<td>Вызов диалога создания «прыжка»</td>
</tr>
</tbody>
</table>
<p>Далее даётся описание добавления приведённых в таблице 8 элементов языка
SFC.</p>
<div class="section" id="id23">
<h4>Добавление шага инициализации и шага<a class="headerlink" href="#id23" title="Ссылка на этот заголовок">¶</a></h4>
<p>Процедура добавления шага инициализации и обычного шага ничем не
отличается. В обоих случаях вызывается диалог «Редактировать шаг» (см.
рис. Рис. 51).</p>
<p><a class="reference internal" href="../_images/image96.png"><img alt="image94" src="../_images/image96.png" style="width: 950.4px; height: 313.2px;" /></a></p>
<p>Рис. 51 – Диалоги редактирования шага инициализации и обычного шага SFC
диаграммы</p>
<p>Согласно стандарту IEC 61131-3, на SFC диаграмме должен быть один шаг
инициализации, который характеризует начальное состояние SFC-диаграммы и
отображается со сдвоенными линиями на границах (см. рис. Рис. 52).</p>
<p><a class="reference internal" href="../_images/image97.png"><img alt="image95" src="../_images/image97.png" style="width: 49.2px; height: 39.6px;" /></a></p>
<p>Рис. 52 – Шаг инициализации языка SFC</p>
<p>В случае, если при добавлении шага не указано его имя – будет выдана
ошибка (см. рис. Рис. 53).</p>
<p><a class="reference internal" href="../_images/image98.png"><img alt="image96" src="../_images/image98.png" style="width: 180.0px; height: 91.2px;" /></a></p>
<p>Рис. 53 – Ошибка отсутствии имени шага во время его добавления</p>
<p>При добавлении шага появляется диалог, в котором можно указать, с
помощью галочек его соединители (см. рис. Рис. 54):</p>
<ul class="simple">
<li>«Входная»;</li>
<li>«Выходная»;</li>
<li>«Действие».</li>
</ul>
<p><a class="reference internal" href="../_images/image99.png"><img alt="image97" src="../_images/image99.png" style="width: 237.0px; height: 157.2px;" /></a></p>
<p>Рис. 54 – Добавление шага на SFC диаграмму</p>
<p>«Действие» добавляет соединитель для связывания данного шага с блоком
действий. «Входной» и «Выходной» соединители, как правило, соединены с
переходом. Соответственно, после нажатия кнопки OK, на диаграмму будет
добавлен шаг с указанными соединителями (см. рис. Рис. 55).</p>
<p><a class="reference internal" href="../_images/image100.png"><img alt="image98" src="../_images/image100.png" style="width: 62.4px; height: 47.4px;" /></a></p>
<p>Рис. 55 – Шаг SFC диаграммы с соединителями входа и действия</p>
</div>
<div class="section" id="id24">
<h4>Добавление перехода<a class="headerlink" href="#id24" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении на SFC диаграмму перехода, появится диалог «Редактировать
переход» (см. рис. Рис. 56).</p>
<p><a class="reference internal" href="../_images/image1011.png"><img alt="image99" src="../_images/image1011.png" style="width: 208.2px; height: 197.4px;" /></a></p>
<p>Рис. 56 – Диалог редактирования перехода для SFC диаграммы</p>
<p>В данном диалоге необходимо выбрать тип перехода и его приоритет. Тип
перехода может быть:</p>
<ul class="simple">
<li>«Ссылка»;</li>
<li>«Встроенный код»;</li>
<li>«Соединение».</li>
</ul>
<p>При выборе типа перехода «Ссылка» в открывающемся списке (см. рис. Рис.
57) будут доступны переходы, предопределённые в дереве проекта для
данного программного модуля, написанного на языке SFC. Добавление
предопределённого перехода описывается ниже после описания всех
добавляемых элементов языка SFC.</p>
<p><a class="reference internal" href="../_images/image102.png"><img alt="image100" src="../_images/image102.png" style="width: 209.4px; height: 198.6px;" /></a></p>
<p>Рис. 57 – Всплывающий список с доступными предопределёнными переходами</p>
<p>При выборе типа перехода «Встроенный код» (см. рис. Рис. 58), условие
перехода можно написать в виде выражения на языке ST.</p>
<p><a class="reference internal" href="../_images/image103.png"><img alt="image101" src="../_images/image103.png" style="width: 206.4px; height: 197.4px;" /></a></p>
<p>Рис. 58 – Условие перехода в виде встроенного кода, написанного на языке
ST</p>
<p>Реализация перехода таким способом удобна в случае, когда необходимое
условие короткое, например: переменные типа f3 и f4 INT равны.
Встроенный код для такого условия выглядит следующим образом (см. рис.
Рис. 58):</p>
<p>f3 = f4</p>
<p>Так же например можно в качестве условия просто указать переменную. В
случае её значения равного 0 – будет означать FALSE, все остальные
значения – TRUE.</p>
<p>При выборе типа перехода «Соединение» (см. рис. Рис. 59), в качестве
условия перехода можно использовать выходные значения элементов языка
FBD или LD.</p>
<p><a class="reference internal" href="../_images/image104.png"><img alt="image102" src="../_images/image104.png" style="width: 208.8px; height: 200.4px;" /></a></p>
<p>Рис. 59 – Выбор условия перехода как соединение с элементами других
графических языков IEC 61131-3</p>
<p>При выборе типа перехода «Соединение», у добавленного перехода появится
слева контакт, который необходимо соединить с выходным значением,
например, функционального блока языка FBD или катушки LD диаграммы.
Стоит отметить, что данное выходное значение должно быть типа BOOL.
Ниже, на рис. Рис. 60 красным цветом выделен пример перехода, условия
которого задано с помощью языка LD – двух последовательно соединённых
контактов языка LD.</p>
<p><a class="reference internal" href="../_images/image105.png"><img alt="image103" src="../_images/image105.png" style="width: 891.9px; height: 231.3px;" /></a></p>
<p>Рис. 60 – Пример SFC диаграммы, в которой один из переходов задан с
помощью языка LD</p>
</div>
<div class="section" id="id25">
<h4>Добавление блока действий<a class="headerlink" href="#id25" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении блока действий на диаграмму появится диалог
«Редактировать свойство блока действий» (см. рис. Рис. 61).</p>
<p><a class="reference internal" href="../_images/image106.png"><img alt="image104" src="../_images/image106.png" style="width: 298.2px; height: 169.8px;" /></a></p>
<p>Рис. 61 – Диалог «Редактировать свойство блока действий»</p>
<p>Данный блок действий может содержать набор действий. Добавить новое
действие можно нажав кнопку «Добавить» и установив необходимые
параметры:</p>
<ul class="simple">
<li>«Квалификатор»;</li>
<li>«Продолжительность»;</li>
<li>«Тип»: «Действие», «Переменная», «Встроенный код»;</li>
<li>«Значение»;</li>
<li>«Индикатор».</li>
</ul>
<p>Поле «Квалификатор» определяет момент времени, когда действие
начинается, сколько времени продолжается и когда заканчивается. Выбрать
квалификатор можно из списка (см. рис. Рис. 62).</p>
<p><a class="reference internal" href="../_images/image107.png"><img alt="image105" src="../_images/image107.png" style="width: 301.8px; height: 291.6px;" /></a></p>
<p>Рис. 62 – Меню выбора квалификатора для действия в диаграмме SFC</p>
<p>Подробное описание квалификаторов, которые выбираются из предлагаемого
списка при добавлении действия приведено в таблице 9.</p>
<p>Таблица 9 – Квалификаторы действий SFC диаграммы</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Имя квалификатора</td>
<td>Поведение блока действия</td>
</tr>
<tr class="row-even"><td>D</td>
<td>Действие начинает выполняться через некоторое заданное время (если шаг еще активен) и выполняется до тех пор, пока данный шаг активен</td>
</tr>
<tr class="row-odd"><td>L</td>
<td>Действие выполняется в течение некоторого заданного интервала времени, после чего выполнение действия останавливается</td>
</tr>
<tr class="row-even"><td>N</td>
<td>Действие выполняется, пока данный шаг активен</td>
</tr>
<tr class="row-odd"><td>P</td>
<td>Действие выполняется один раз, как только шаг стал активен</td>
</tr>
<tr class="row-even"><td>S</td>
<td>Действие активируется и остается активным пока SFC диаграмма выполняется</td>
</tr>
<tr class="row-odd"><td>R</td>
<td>Действие выполняется, когда диаграмма деактивизируется</td>
</tr>
<tr class="row-even"><td>DS</td>
<td>Действие начинается выполняться через некоторое заданное время, только в том случае если шаг еще активен</td>
</tr>
<tr class="row-odd"><td>SL</td>
<td>Действие активно в течении некоторого, заданного интервала</td>
</tr>
<tr class="row-even"><td>SD</td>
<td>Действие начинается выполняться через некоторое время, даже в том случае если шаг уже не активен</td>
</tr>
</tbody>
</table>
<p>Поле «Продолжительность» необходимо для установки интервала времени
необходимого для некоторых квалификаторов, описанных выше в таблице 9.</p>
<p>«Тип» определяет код или конкретную манипуляцию, которая будет
выполняться во время активации действия. В случае выбора «Действия»
появляется возможность, как и в случае с переходом, использовать
предопределённые действия в дереве проекта для данного программного
модуля, написанного на языке SFC (см. рис. Рис. 63).</p>
<p><a class="reference internal" href="../_images/image108.png"><img alt="image106" src="../_images/image108.png" style="width: 298.2px; height: 170.4px;" /></a></p>
<p>Рис. 63 – Выбор предопределённого действия</p>
<p>Добавление предопределённого действия также как добавление
предопределённого перехода описывается ниже после описания всех
добавляемых элементов языка SFC.</p>
<p>В случае выбора типа действия «Переменная» в поле «Значение» появляется
возможность выбрать переменные (см. рис. Рис. 64), относящиеся к данному
программному модулю.</p>
<p><a class="reference internal" href="../_images/image109.png"><img alt="image107" src="../_images/image109.png" style="width: 298.2px; height: 162.6px;" /></a></p>
<p>Рис. 64 – Выбор предопределённой переменной</p>
<p>Как только шаг становится активным, данная переменная в зависимости от
своего типа принимает значение 0, 0.0, FALSE и другие нулевые значения
типов. Как только действие начинает выполняться, переменная принимает
значение 1, 1.0, TRUE и другие единичные значения типов. В случае если
действие прекратило своё выполнение переменная снова принимает значение
0, 0.0, FALSE и другое нулевое значение, в зависимости от своего типа.</p>
<p>В случае выбора «Встроенный код», появляется возможность в поле
«Значение» написать на языке ST код, который будет выполняться, когда
действие становится активным (см. рис. Рис. 65).</p>
<p><a class="reference internal" href="../_images/image110.png"><img alt="image108" src="../_images/image110.png" style="width: 297.6px; height: 166.8px;" /></a></p>
<p>Рис. 65 – Написание встроенного кода для действия</p>
<p>Следует отметить, что в конце встроенного кода для действия необходимо
поставить «;», в отличие от встроенного кода для перехода.</p>
<p>После добавления блока действия на диаграмму необходимо его
ассоциировать с конкретным шагом. Данная операция выполняется обычным
соединением правого контакта у шага и левого контакта у действия (см.
рис. Рис. 66).</p>
<p><a class="reference internal" href="../_images/image1111.png"><img alt="image109" src="../_images/image1111.png" style="width: 250.2px; height: 88.2px;" /></a></p>
<p>Рис. 66 – Ассоциирование шага step2 блоком действия, содержащим два
действия</p>
</div>
<div class="section" id="id26">
<h4>Добавление дивергенции<a class="headerlink" href="#id26" title="Ссылка на этот заголовок">¶</a></h4>
<p>При добавлении дивергенции, появится диалог «Создать новую дивергенцию и
конвергенцию» (см. рис. Рис. 67).</p>
<p><a class="reference internal" href="../_images/image112.png"><img alt="image110" src="../_images/image112.png" style="width: 298.2px; height: 169.8px;" /></a></p>
<p>Рис. 67 – Добавление дивергенции</p>
<p>В первую очередь следует выбрать тип дивергенции:</p>
<ul class="simple">
<li>«Дивергенция»;</li>
<li>«Конвергенция»;</li>
<li>«Параллельная дивергенция»;</li>
<li>«Параллельная конвергенция».</li>
</ul>
<p>Вторым параметром является количество разветвлений, которое определяет
на сколько ветвей будет либо расходится (в случае выбора типа
дивергенции «Дивергенции» или «Параллельной дивергенции») одна ветвь,
либо сколько ветвей будет сходиться в одну ветвь (в случае выбора типа
дивергенции «Конвергенция» или «Параллельная конвергенция»)</p>
<p>Пример дивергенции с двумя разветвлениями показан на рис. Рис. 68 и
выделен красным цветом.</p>
<p><a class="reference internal" href="../_images/image113.png"><img alt="image111" src="../_images/image113.png" style="width: 752.8px; height: 368.0px;" /></a></p>
<p>Рис. 68 – Пример SFC диаграммы, содержащей дивергенцию</p>
<p>Пример конвергенции выделен красным цветом на рис. Рис. 69.</p>
<p><a class="reference internal" href="../_images/image114.png"><img alt="image112" src="../_images/image114.png" style="width: 752.8px; height: 368.0px;" /></a></p>
<p>Рис. 69 – Пример SFC диаграммы, содержащей конвергенцию</p>
<p>Пример параллельной конвергенции показан на рис. Рис. 70 и выделен
красным цветом.</p>
<p><a class="reference internal" href="../_images/image115.png"><img alt="image113" src="../_images/image115.png" style="width: 422.1px; height: 284.9px;" /></a></p>
<p>Рис. 70 – Пример SFC диаграммы, содержащей параллельную дивергенцию</p>
</div>
<div class="section" id="id27">
<h4>Добавление «прыжка»<a class="headerlink" href="#id27" title="Ссылка на этот заголовок">¶</a></h4>
<p>Элемент «прыжок» на SFC диаграмме подобен выполнению оператора GOTO при
переходе на определённую метку в коде в различных языках
программирования. После выбора добавления прыжка на SFC диаграмму,
появится диалог (см. рис. Рис. 71), в котором необходимо выбрать из
списка шаг, к которому будет происходить «прыжок» – переход от одного
шага SFC диаграммы к другому.</p>
<p><a class="reference internal" href="../_images/image116.png"><img alt="image114" src="../_images/image116.png" style="width: 177.0px; height: 135.6px;" /></a></p>
<p>Рис. 71 – Диалог добавления «прыжка»</p>
<p>В данном диалоге также присутствует и шаг инициализации (начальный шаг).
После выбора шага и нажатия кнопки OK. На SFC диаграмме появится
стрелочка, которую нужно соединить с переходом (см. рис. Рис. 72).
Справа от стрелочки находится имя шага, к которому осуществляется
переход в случае выполнения условия перехода, находящегося выше и
соединённого с ней.</p>
<p><a class="reference internal" href="../_images/image117.png"><img alt="image115" src="../_images/image117.png" style="width: 2.53958in; height: 2.21389in;" /></a></p>
<p>Рис. 72 – Прыжок с шага «secondStep» на «firstStep»</p>
<p>Согласно стандарту IEC 61131-3, между шагом и прыжком должен обязательно
быть определён переход.</p>
</div>
<div class="section" id="id28">
<h4>Предопределённые условия перехода и действия в дереве проекта<a class="headerlink" href="#id28" title="Ссылка на этот заголовок">¶</a></h4>
<p>В случае, если необходимо использовать определённое условие перехода
между множеством шагов, есть возможность определить данное условие
перехода в структуре SFC диграммы. Данная операция выполняется нажатием
на данную SFC диаграмму на дереве проекта (п. 6.3) правой клавишей мыши
и выбором «Добавить переход» (см. рис. Рис. 73).</p>
<p><a class="reference internal" href="../_images/image118.png"><img alt="image116" src="../_images/image118.png" style="width: 204.0px; height: 202.8px;" /></a></p>
<p>Рис. 73 – Всплывающее меню SFC диаграммы в панели проекта</p>
<p>Далее появится диалог под названием «Создать новый переход» (см. рис.
Рис. 74). В нём необходимо выбрать уникальное имя перехода и язык, в
котором будет описанно данное условие.</p>
<p><a class="reference internal" href="../_images/image119.png"><img alt="image117" src="../_images/image119.png" style="width: 207.6px; height: 109.8px;" /></a></p>
<p>Рис. 74 – Диалог «Создать новый переход»</p>
<p>В случае, если переходы с введённым именем уже существуют, то будет
выведено сообщение об ошибке (см. рис. Рис. 75).</p>
<p><a class="reference internal" href="../_images/image120.png"><img alt="image118" src="../_images/image120.png" style="width: 294.6px; height: 101.4px;" /></a></p>
<p>Рис. 75 – Сообщение об ошибке добавления существующего программного
модуля</p>
<p>Добавление действия в структуру SFC диаграммы (см. рис. Рис. 76)
происходит аналогично добавлению перехода в данную структуру.</p>
<p><a class="reference internal" href="../_images/image121.png"><img alt="image119" src="../_images/image121.png" style="width: 225.6px; height: 125.4px;" /></a></p>
<p>Рис. 76 – Всплывающее меню SFC для структуры диаграммы</p>
<p>После выбора «Добавить действие» во всплывающем меню, вызванном с
помощью нажатия правой кравиши мыши по программному модулю, написанном с
помощью языка SFC, появится диалог «Создать новое действие» (см. рис.
Рис. 77).</p>
<p><a class="reference internal" href="../_images/image122.png"><img alt="image120" src="../_images/image122.png" style="width: 191.4px; height: 109.2px;" /></a></p>
<p>Рис. 77 – Диалог «Создать новое действие»</p>
<p>В данном диалоге необходимо указать «Имя действия» (должно быть
уникальным) и выбрать язык (ST, IL, FBD, LD), на котором будет написано
данное действие. Если имя действия не заполнено будет выведено сообщение
об ошибке (см. рис. Рис. 78).</p>
<p><a class="reference internal" href="../_images/image123.png"><img alt="image121" src="../_images/image123.png" style="width: 198.0px; height: 101.4px;" /></a></p>
<p>Рис. 78 – Ошибка не заполнения имени действия при его добавлении</p>
<p>После того как действие добавлено, необходимо реализовать его код на
текстовом или графическом языке, в зависимости от языка, который был
выбран в диалоге «Создать новое действие» (см. рис. Рис. 77). После
добавления переходов и действий в дерево проекта они будут доступны для
множественного использования.</p>
<p>Описание языка SFC, основных конструкций и примера его использования
приведены в приложении 7.</p>
</div>
</div>
</div>
<div class="section" id="id29">
<h2>Панель редактирования ресурса<a class="headerlink" href="#id29" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель редактирования ресурса (см. рис. Рис. 79) содержит панель
переменных и констант, которая позволяет определять глобальные
переменные на уровне ресурса и панели, содержащие задачи и экземпляры.</p>
<p><a class="reference internal" href="../_images/image124.png"><img alt="image122" src="../_images/image124.png" style="width: 959.4px; height: 610.2px;" /></a></p>
<p>Рис. 79 – Вкладка ресурс главной рабочей области</p>
<p>Добавление переменных в ресурс ничем не отличается от добавления
переменных в программные модули, единственное исключение – переменные
могут быть только класса «Глобальная». Основной задачей данной панели
является возможность добавить экземпляр, указать для него программный
модуль типа «Программа», из ранее определённых в проекте, для поля «Тип»
и выбрать задачу из добавленных в список «Задачи».</p>
</div>
<div class="section" id="id30">
<h2>Панель редактирования типа данных<a class="headerlink" href="#id30" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель редактирования типа данных (см. рис. Рис. 80) позволяет
определить различные параметры создаваемого пользовательского типа
данных.</p>
<p><a class="reference internal" href="../_images/image125.png"><img alt="image123" src="../_images/image125.png" style="width: 304.2px; height: 148.8px;" /></a></p>
<p>Рис. 80 – Вкладка создания нового типа данных</p>
<p>Главным параметром является список под названием «Механизм создания
нового типа», позволяющим выбрать следующие типы:</p>
<ul class="simple">
<li>прямое наследование;</li>
<li>поддиапазон существующего типа (выделение диапазона значений
стандартного типа);</li>
<li>перечисляемый тип;</li>
<li>массив;</li>
<li>структура, позволяющая определять тип, основанный на объединении
несколько типов.</li>
</ul>
<p>Далее рассмотрены подробнее параметры для каждого из вышеперечисленных
типов</p>
<div class="section" id="id31">
<h3>Прямое наследование<a class="headerlink" href="#id31" title="Ссылка на этот заголовок">¶</a></h3>
<p>При выборе «Прямое наследование» (см. рис. Рис. 81), из списка
указывается базовый тип и его начальное значение.</p>
<p><a class="reference internal" href="../_images/image126.png"><img alt="image124" src="../_images/image126.png" style="width: 303.0px; height: 102.6px;" /></a></p>
<p>Рис. 81 – Добавление псевдонима типа данных</p>
<p>Созданный тип представляет собой псевдоним (например, аналогично
использованию typedef в языке C) уже существующего типа.</p>
</div>
<div class="section" id="id32">
<h3>Поддиапазон существующего типа<a class="headerlink" href="#id32" title="Ссылка на этот заголовок">¶</a></h3>
<p>В случае выбора механизма создания нового типа «Поддиапазон
существующего типа», помимо базового типа и начального значения
производится установка параметров «Минимум» и «Максимум» (см. рис. Рис.
82), т.е. соответственно минимального и максимального значения, которое
может принимать создаваемый тип данных.</p>
<p><a class="reference internal" href="../_images/image127.png"><img alt="image125" src="../_images/image127.png" style="width: 302.4px; height: 147.6px;" /></a></p>
<p>Рис. 82 – Добавление нового типа данных, представляющего поддиапазон
существующего типа</p>
</div>
<div class="section" id="id33">
<h3>Перечисляемый тип<a class="headerlink" href="#id33" title="Ссылка на этот заголовок">¶</a></h3>
<p>При выборе механизма создания нового типа «Перечисляемый тип» (см. рис.
Рис. 83), появится панель, содержащая таблицу, в которой можно задать
список возможных значений данного перечисляемого типа.</p>
<p><a class="reference internal" href="../_images/image128.png"><img alt="image126" src="../_images/image128.png" style="width: 307.2px; height: 222.6px;" /></a></p>
<p>Рис. 83 – Добавление перечисляемого типа данных</p>
<p>Добавление, редактирование, удаление, перемещение данных значений
осуществляется с помощью кнопок, описание которых приведено в таблице
10.</p>
<p>Таблица 10 – Кнопки редактирования значений перечисляемого типа</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="25%" />
<col width="51%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Наименование кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image129.png"><img alt="image127" src="../_images/image129.png" style="width: 22.4px; height: 22.4px;" /></a></td>
<td>Редактировать</td>
<td>Редактировать выделенное поле в таблице</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image130.png"><img alt="image128" src="../_images/image130.png" style="width: 29.7px; height: 29.7px;" /></a></td>
<td>Добавить</td>
<td>Добавить новое поле в таблицу</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image131.png"><img alt="image129" src="../_images/image131.png" style="width: 28.6px; height: 29.7px;" /></a></td>
<td>Удалить</td>
<td>Удалить выделенное поле в таблице</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image132.png"><img alt="image130" src="../_images/image132.png" style="width: 20.8px; height: 21.6px;" /></a></td>
<td>Переместить вверх</td>
<td>Переместить вверх выделенное поле в таблице</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image133.png"><img alt="image131" src="../_images/image133.png" style="width: 21.6px; height: 21.6px;" /></a></td>
<td>Переместить вниз</td>
<td>Переместить вниз выделенное поле в таблице</td>
</tr>
</tbody>
</table>
<p>Также есть возможность задать начальное значение данного перечисляемого
типа в поле «Начальное значение».</p>
</div>
<div class="section" id="id34">
<h3>Массив<a class="headerlink" href="#id34" title="Ссылка на этот заголовок">¶</a></h3>
<p>При выборе механизма создания нового типа «Массив» (см. рис. Рис. 84)
появится панель, в которой необходимо указать базовый тип, начальное
значение, а так же размерность массива.</p>
<p><a class="reference internal" href="../_images/image134.png"><img alt="image132" src="../_images/image134.png" style="width: 297.0px; height: 223.2px;" /></a></p>
<p>Рис. 84 – Добавление типа данных – массива</p>
<p>Размерность массива задаётся в следующем формате:</p>
<p>&lt;начальное значение&gt;..&lt;конечное значение&gt;</p>
</div>
<div class="section" id="id35">
<h3>Структура<a class="headerlink" href="#id35" title="Ссылка на этот заголовок">¶</a></h3>
<p>При выборе механизма создания нового типа «Структура» (см. рис. Рис.
85), в появившейся таблице необходимо добавить необходимое количество
полей структуры. Каждое поле имеет своё имя, тип и начальное значение.</p>
<p><a class="reference internal" href="../_images/image135.png"><img alt="image133" src="../_images/image135.png" style="width: 302.4px; height: 184.8px;" /></a></p>
<p>Рис. 85 – Добавление типа данных – структуры</p>
<p>Добавленные типы данных могут использоваться также как и стандартные при
реализации алгоритмов и логики выполнения программных модулей.</p>
<p>Выше были рассмотрены варианты редактирования различных элементов, из
которых состоит проект, согласно стандарту IEC 61131-3. Далее будет
продолжено рассмотрение остальных компонент среды разработки «Beremiz»</p>
</div>
</div>
<div class="section" id="id36">
<h2>Панель экземпляров проекта<a class="headerlink" href="#id36" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель экземпляров проекта (см. рис. Рис. 86) обычно располагается слева
в среде разработки «Beremiz» и отображаемые в ней экземпляры зависят от
выбранного элемента в дереве проекта.</p>
<p><a class="reference internal" href="../_images/image136.png"><img alt="image134" src="../_images/image136.png" style="width: 210.0px; height: 223.2px;" /></a></p>
<p>Рис. 86 – Панель экземпляров проекта</p>
<p>При выборе в дереве проекта элемента, соответствующего ресурсу, в панели
экземпляров проекта будут отображены экземпляры (см. п. 6.8),
определённые в данном ресурсе, а так же глобальные переменные ресурса.
На рис. Рис. 87 показано, как в панели редактирования ресурса определена
глобальная переменная «globalValue» и два экземпляра для программных
модулей «program0» и «program1»:</p>
<p><a class="reference internal" href="../_images/image137.png"><img alt="image135" src="../_images/image137.png" style="width: 1342.0px; height: 588.0px;" /></a></p>
<p>Рис. 87 – Два экземпляра проекта в панели редактирования ресурса</p>
<p>Соответственно, при выборе в дереве проекта ресурса, в котором
определены экземпляры (описанные выше) и глобальная переменная, панель
экземпляров будет выглядеть, как показано на рис. Рис. 88:</p>
<p><a class="reference internal" href="../_images/image138.png"><img alt="image136" src="../_images/image138.png" style="width: 173.4px; height: 67.8px;" /></a></p>
<p>Рис. 88 – Панель экземпляров при выборе элемента ресурса в дереве
проекта</p>
<p>При выборе в дереве проекта элемента, соответствующего программным
модулям «Программа» и «Функциональный блок» в панели экземпляров будут
отображены переменные, определённые в них. Ниже на рис. Рис. 89 приведён
пример программного модуля типа «Программа» с именем «program0», в
котором определено 6 переменных различных классов.</p>
<p><a class="reference internal" href="../_images/image139.png"><img alt="image137" src="../_images/image139.png" style="width: 801.0px; height: 319.5px;" /></a></p>
<p>Рис. 89 – Программный модуля типа «Программа»</p>
<p>Соответственно, при выборе в дереве проекта данного программного модуля
в панели экземпляров будут отображены, определённые выше переменные (см.
рис. Рис. 90).</p>
<p><a class="reference internal" href="../_images/image140.png"><img alt="image138" src="../_images/image140.png" style="width: 231.6px; height: 148.2px;" /></a></p>
<p>Рис. 90 – Панель экземпляров проекта при выборе в дереве проекта
программного модуля типа «Программа»</p>
<p>В случае выбора других элементов в дереве проекта, панель отладки будет
пустой. Как можно заметить, с правой стороны от каждого элемента в
панели отладки располагаются кнопки, назначение которых описано в
таблице 11.</p>
<p>Таблица 11 – Кнопки на панели экземпляров проекта</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image141.png"><img alt="image139" src="../_images/image141.png" style="width: 0.27083in; height: 0.27083in;" /></a></td>
<td>Кнопка отображения графика изменения значения переменной в режиме отладки</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image142.png"><img alt="image140" src="../_images/image142.png" style="width: 0.27083in; height: 0.27083in;" /></a></td>
<td>Кнопка запуска режима отладки для экземпляра</td>
</tr>
</tbody>
</table>
<p>В случае нажатия кнопки запуска режима отладки для экземпляра программы,
написанной на одном из графических языков (FBD, LD или SFC), откроется
вкладка с панелью, на которой диаграмма будет отображена в режиме
отладки (см. п. 9). Если кнопка запуска режима отладки нажимается для
элемента переменной, то переменная будет добавлена в панель отладки (см.
п. 6.14).</p>
<p>Описанные выше кнопки доступны только в режиме отладки прикладной
программы. Про данный режим подробнее рассказывается в п. 9.</p>
</div>
<div class="section" id="id37">
<h2>Панель библиотеки функций и функциональных блоков<a class="headerlink" href="#id37" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель библиотеки функций и функциональных блоков (см. рис. Рис. 91),
как правило, располагается справа в среде разработки «Beremiz». Она
содержит коллекцию стандартных функций и функциональных блоков,
разделённых по разделам в соответствии с их назначением, которые
доступны при написании алгоритмов и логики работы программных модулей.</p>
<p><a class="reference internal" href="../_images/image143.png"><img alt="image141" src="../_images/image143.png" style="width: 193.2px; height: 325.8px;" /></a></p>
<p>Рис. 91 – Панель библиотеки функций и функциональных блоков</p>
<p>Выделены следующие разделы для функций и функциональных блоков:
стандартные, дополнительные, преобразования типов данных, операций с
числовыми данными, арифметических операций, временных операций,
побитовых и смещения бит, операций выбора, операций сравнения, строковых
операций, модулей «Python» и «SVGUI».</p>
<p>Помимо стандартных функций и функциональных блоков, данная панель
содержит раздел «пользовательские программные модули». В него попадают
функции и функциональные блоки, добавленные в конкретный проект, т.е.
содержащиеся в дереве проекта.</p>
<p>Использование данных функций и функциональных блоков осуществляется
перетаскиванием необходимого блока с помощью зажатой левой кнопки мыши
(Drag&amp;Drop) в область редактирования: либо текстовый редактор, либо
графический редактор.</p>
<p>Имеется специальное поле поиска функционального блока по имени. Более
подробное описание каждого функционального блока приведено в приложении
2.</p>
</div>
<div class="section" id="id38">
<h2>Отладочная консоль<a class="headerlink" href="#id38" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель, содержащая отладочную консоль (см. рис. Рис. 92), как правило,
располагается в правом нижнем углу среды разработки «Beremiz».</p>
<p><a class="reference internal" href="../_images/image144.png"><img alt="image142" src="../_images/image144.png" style="width: 643.5px; height: 239.4px;" /></a></p>
<p>Рис. 92 – Успешная сборка в отладочной консоли</p>
<p>Она служит для отображения в виде текстовых сообщений:</p>
<ul class="simple">
<li>результатов генерации ST и C кода;</li>
<li>результатов компиляции и компоновки прикладной программы;</li>
<li>процесса соединения и передачи прикладной программы на целевое
устройство;</li>
<li>различных промежуточных манипуляций в процессы создания прикладной
программы.</li>
</ul>
<p>В случае, если необходимо вывести предупреждения среды разработки
«Beremiz» или ошибки компиляторов во время их работы («MatIEC» или C
кода) цвет вывода текстовых сообщений становится красным. Критические
ошибки также выделяется красным цветом, но при этом еще желтым фоном
(см. рис. Рис. 93).</p>
<p><a class="reference internal" href="../_images/image145.png"><img alt="image143" src="../_images/image145.png" style="width: 667.8px; height: 244.8px;" /></a></p>
<p>Рис. 93 – Ошибка сборки проекта в отладочной консоли</p>
</div>
<div class="section" id="id39">
<h2>Поиск элементов в проекте<a class="headerlink" href="#id39" title="Ссылка на этот заголовок">¶</a></h2>
<p>Для поиска интересующего элемента в проекте используется диалог «Поиск в
проекте» (см. рис. Рис. 94). Его вызов происходит с помощью главного
меню программы (п. 6.1) или панели инструментов (п. 6.2).</p>
<p><a class="reference internal" href="../_images/image146.png"><img alt="image144" src="../_images/image146.png" style="width: 303.6px; height: 225.0px;" /></a></p>
<p>Рис. 94 – Диалог поиска в проекте</p>
<p>В появившемся диалоге можно установить различные параметры поиска:
шаблон поиска, область поиска, чувствительность к регистру при поиске, а
так же записать шаблон поиска в виде регулярного выражения. После того
как все параметры установлены, необходимо нажать кнопку «Поиск» в этом
диалоге. Ниже на рис. Рис. 95 приведен пример поиска элемента с именем
«ValueH».</p>
<p><a class="reference internal" href="../_images/image147.png"><img alt="image145" src="../_images/image147.png" style="width: 512.4px; height: 555.1px;" /></a></p>
<p>Рис. 95 – Результат поиска элемента в проекте</p>
<p>Результат поиска выводится в иерархической структуре. При двойном щелчке
по одному из результатов – данный элемент будет выделен в проекте
оранжевым цветом.</p>
</div>
<div class="section" id="id40">
<h2>Панель отладки<a class="headerlink" href="#id40" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель отладки располагается в правой части среды разработки «Beremiz»
(см. рис. Рис. 96).</p>
<p><a class="reference internal" href="../_images/image148.png"><img alt="image146" src="../_images/image148.png" style="width: 175.8px; height: 129.6px;" /></a></p>
<p>Рис. 96 – Панель отладки</p>
<p>Данная панель представляет собой таблицу с двумя столбцами «Переменная»
и «Значение». Соответственно, столбец «Переменная» содержит экземпляры
переменных, значения которых во время исполнения, отображаются в поле
«Значение» и могут изменяться. Добавление переменных осуществляется с
помощью панели экземпляров проекта (см. п. 6.10).</p>
<p>Изменение значений переменной во время отладки прикладной программы
осуществляется нажатием правой клавишей мыши в поле «Значение»
интересующей переменной и в появившемся всплывающем меню (см. рис. Рис.
97) выбирается «Установить значение».</p>
<p><a class="reference internal" href="../_images/image149.png"><img alt="image147" src="../_images/image149.png" style="width: 229.8px; height: 177.0px;" /></a></p>
<p>Рис. 97 – Всплывающее меню манипуляций со значением переменной</p>
<p>Далее появится диалог ввода значения для выбранной переменной (см. рис.
Рис. 98).</p>
<p><a class="reference internal" href="../_images/image150.png"><img alt="image148" src="../_images/image150.png" style="width: 199.8px; height: 100.2px;" /></a></p>
<p>Рис. 98 – Установка значения переменной во время отладки</p>
<p>Для того чтобы отменить установленное значение для переменной,
необходимо нажать во всплывающем меню «Освободить значение».</p>
<p>На данной панели так же присутствуют кнопки, подобные кнопкам в панели
переменных и констант, позволяющие перемещать и удалять добавленные
переменные.</p>
</div>
<div class="section" id="id41">
<h2>Панель графика изменения значения переменной в режиме отладки<a class="headerlink" href="#id41" title="Ссылка на этот заголовок">¶</a></h2>
<p>Данная панель (см. рис. Рис. 99) открывается в отдельной вкладке в
случае, если в панели экземпляров проекта (см. п. 6.10) для переменной
нажимается кнопка отображения графика изменения значения переменной в
режиме отладки (см. таблица 11).</p>
<p><a class="reference internal" href="../_images/image151.png"><img alt="image149" src="../_images/image151.png" style="width: 215.4px; height: 338.4px;" /></a></p>
<p>Рис. 99 – График изменения значения переменной во время выполнения
прикладной программы</p>
<p>На данной панели есть возможность установить:</p>
<ul class="simple">
<li>«Интервал» – временной отрезок, за который отображается изменений
графика;</li>
<li>«Масштаб» – задание приближения отображения графика;</li>
<li>«Позиция» – перемещение по отображению графика, от начала и до конца.</li>
</ul>
<p>Также на данной панели в правом нижнем углу располагаются
вспомогательные кнопки. Описание данных кнопок приведено в таблице 12:</p>
<p>Таблица 12 – Кнопки на панели экземпляров проекта</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Внешний вид кнопки</td>
<td>Функции кнопки</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image152.png"><img alt="image150" src="../_images/image152.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Очистка отображения графика</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image153.png"><img alt="image151" src="../_images/image153.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Переход к отображению текущего значения графика, т.е. сдвиг параметра «Позиция» максимально вправо.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="../_images/image154.png"><img alt="image152" src="../_images/image154.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Сброс настроек масштаба до настроек по умолчанию: x 1.0</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="../_images/image155.png"><img alt="image153" src="../_images/image155.png" style="width: 0.26667in; height: 0.26667in;" /></a></td>
<td>Экспортировать в буфер обмена значения изменения графика</td>
</tr>
</tbody>
</table>
<p>Далее в отдельном разделе рассмотрен механизм связывания внешних модулей
УСО с программными модулями прикладной программы.</p>
<ol class="arabic">
<li><p class="first rubric" id="id42">Внешние плагины для модулей УСО</p>
<ol class="arabic">
<li><p class="first rubric" id="id43">Механизм плагинов</p>
</li>
</ol>
</li>
</ol>
<p>Среда разработки «Beremiz» предоставляет интерфейс, позволяющий
связывать внешние источники данных, такие как модули УСО (их параметры,
состояния) с программными модулями (в частности с их переменными),
написанными на языках высокого уровня (IEC 61131-3), из которых состоит
прикладная программа. Интерфейс реализован с помощью механизма плагинов
для модулей УСО. Данный механизм представляет собой:</p>
<ul class="simple">
<li>классы для взаимодействия с компонентами «Beremiz» и редактор
настройки различных параметров данного плагина, написанные на языке
Python;</li>
<li>драйверы внешних устройств, написанные на языке C и компилируемые
вместе со сгенерированным кодом проекта.</li>
</ul>
<p>Есть возможность добавить требуемый плагин в проект и получить доступ к
переменным модуля, который представляет данный плагин. Далее рассмотрены
основные операции с плагинами в среде разработки «Beremiz».</p>
<div class="section" id="id44">
<h3>Добавление плагина в проект<a class="headerlink" href="#id44" title="Ссылка на этот заголовок">¶</a></h3>
<p>Как упоминалось в п. 6.3, добавление плагинов, как и программных
модулей, осуществляется через всплывающее меню дерева проекта (см. рис.
Рис. 100).</p>
<p><a class="reference internal" href="../_images/image156.png"><img alt="image154" src="../_images/image156.png" style="width: 1.98611in; height: 2.77292in;" /></a></p>
<p>Рис. 100 – Всплывающее меню панели проекта</p>
<p>В меню для добавления доступны плагины модулей: «TCP интерфейс», «Modbus
интерфейс» «МДВ», «МДВыв», «МАВ 1.2.1», «МАО». Подробнее о каждом
плагине будет рассказано в следующих разделах. Так же операция
добавления может быть выполнена через главное меню среды разработки
«Beremiz» (см. рис. Рис. 101).</p>
<p><a class="reference internal" href="../_images/image157.png"><img alt="image155" src="../_images/image157.png" style="width: 3.07083in; height: 3.49861in;" /></a></p>
<p>Рис. 101 – Добавление плагинов через главное меню среды разработки
«Beremiz»</p>
<p>После того, как в меню выбран пункт с необходимым плагином, он
добавляется в структуру проекта. На рис. Рис. 102 в проект добавлено два
плагина с именами «mdo_0» и «mav121_0», соответствующие модулям УСО:
«МДВыв» и «МАВ 1.2.1».</p>
<p><a class="reference internal" href="../_images/image158.png"><img alt="image156" src="../_images/image158.png" style="width: 2.23542in; height: 1.81667in;" /></a></p>
<p>Рис. 102 – Структура проекта после добавления двух плагинов</p>
<p>Далее даётся описание процессу настройки плагина и заданию
соответствующих ему параметров с помощью редактора плагина.</p>
</div>
<div class="section" id="id45">
<h3>Редактор плагина<a class="headerlink" href="#id45" title="Ссылка на этот заголовок">¶</a></h3>
<p>При двойном щелчке левой кнопкой мыши по плагину в дереве проекта
появится вкладка с редактором данного плагина, позволяющим задать
настройки модуля и различные параметры в зависимости от типа модуля. На
рис. Рис. 103 приведен пример вкладки с редактором плагина для модуля
«mdo_0» (модуль дискретного вывода «МДВыв»).</p>
<p><a class="reference internal" href="../_images/image159.png"><img alt="image157" src="../_images/image159.png" style="width: 3.68056in; height: 3.24167in;" /></a></p>
<p>Рис. 103 – Редактор плагина модуля «МДВыв»</p>
<p>Редактор состоит из двух частей. Нижняя часть содержит параметры
специфичные для плагина, и её описание приводится для каждого плагина в
отдельности. Верхняя часть общая для всех плагинов. Она позволяет
задать:</p>
<ul class="simple">
<li>уникальное имя плагина;</li>
<li>идентификатор плагина в проекте;</li>
<li>флаги «CFLAGS» и «LDFLAGS» необходимые, соответственно, для
компиляции и компоновки, файлов (содержащих драйвера модулей УСО),
соответствующих данному плагину.</li>
</ul>
<p>В случае указания имени плагина, которое уже имеется в проекте, будет
добавлен цифровой постфикс, например, «mdo_1_1» (см. рис. Рис. 104).</p>
<p><a class="reference internal" href="../_images/image160.png"><img alt="image158" src="../_images/image160.png" style="width: 5.67569in; height: 2.80972in;" /></a></p>
<p>Рис. 104 – Добавление цифрового постфикса для уникальности имени плагина</p>
<p>Имя плагина должно быть уникально в рамках проекта. Назначение
идентификаторов плагина приводится далее в п. 7.1.3.</p>
</div>
<div class="section" id="id46">
<h3>Идентификаторы переменных плагина<a class="headerlink" href="#id46" title="Ссылка на этот заголовок">¶</a></h3>
<p>Каждому плагину присваивается уникальный идентификатор, указанный слева
от его имени. На рис. Рис. 105 он выделен красным цветом для обоих
добавленных плагинов.</p>
<p><a class="reference internal" href="../_images/image161.png"><img alt="image159" src="../_images/image161.png" style="width: 2.00069in; height: 1.60486in;" /></a></p>
<p>Рис. 105 – Отображение уникальных идентификаторов добавленных плагинов</p>
<p>Данный идентификатор представлен в следующем формате:</p>
<p>&lt;идентификатор плагина&gt;.x, где</p>
<p>&lt;идентификатор плагина&gt; – является уникальным числовым идентификатором в
рамках текущего проекта и присваивается автоматически средой разработки
«Beremiz», но может быть изменён с помощью редактора плагина;</p>
<p>x – обозначает номера переменных плагина, которые определены доступными
для модуля, которому соответствует данный плагин.</p>
<p>Изменить идентификатор плагина можно с помощью редактора плагина, как
показано на рис. Рис. 106, с помощью стрелочек «Вверх» и «Вниз»,
выделенных красным цветом.</p>
<p><a class="reference internal" href="../_images/image162.png"><img alt="image160" src="../_images/image162.png" style="width: 4.71528in; height: 2.28125in;" /></a></p>
<p>Рис. 106 – Изменение идентификатора плагина с помощью редактора плагина</p>
<p>В соответствии с данным идентификатором формируются адреса переменных
плагина, благодаря которым, эти переменные могут быть связаны с
переменными программных модулей.</p>
</div>
<div class="section" id="id47">
<h3>Адреса переменных плагина<a class="headerlink" href="#id47" title="Ссылка на этот заголовок">¶</a></h3>
<p>Адреса для переменных плагина представляется следующим образом:</p>
<p>&lt;символ «%»&gt;&lt;идентификатор класса&gt;&lt;идентификатор типа&gt;&lt;идентификатор
плагина&gt;&lt;символ «.»&gt;&lt;номер переменной&gt;</p>
<p>Идентификатор класса переменной представляет собой символ «I» – если
переменная входная и «Q» – если переменная выходная. Далее в зависимости
от типа переменной плагина подставляется соответствующий идентификатор
для данного типа. Соотношение типов данных и их идентификаторов
приведено в таблице 13. В конце добавляется точка и порядковый номер
переменной в данном плагине.</p>
<p>Таблица 13 – Соотношение типов данных и идентификаторов типа</p>
<table border="1" class="docutils">
<colgroup>
<col width="57%" />
<col width="43%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Тип</td>
<td>Идентификатор типа</td>
</tr>
<tr class="row-even"><td>BOOL</td>
<td>X</td>
</tr>
<tr class="row-odd"><td>SINT, USINT, STRING, BYTE</td>
<td>B</td>
</tr>
<tr class="row-even"><td>INT, UINT, WORD, WSTRING</td>
<td>W</td>
</tr>
<tr class="row-odd"><td>DINT, UDINT, REAL, DWORD</td>
<td>D</td>
</tr>
<tr class="row-even"><td>LINT, ULINT, LREAL, LWORD</td>
<td>L</td>
</tr>
</tbody>
</table>
<p>Например, входная переменная, соответствующая дискретному сигналу (типа
BOOL) под номером 1 для модуля с идентификатором 0.x будет выглядеть
следующим образом: «%IX0.1».</p>
<p>В среде разработки «Beremiz» существуют следующие правила для переменных
внешних плагинов (модулей):</p>
<ol class="arabic simple">
<li>Переменная под номером 0 (оканчивающаяся на 0), например, %QD0.0
является переменной состояния в целом модуля;</li>
<li>Переменная под нечётным номером (оканчивающаяся на 1, 3, 5 и т.д.)
является переменной значения сигнала для канала модуля или другого
источника данных модуля, например %ID1.5;</li>
<li>Переменная под чётным номером и большая 0 (оканчивающаяся на 2, 4, 6)
является переменной состояния для канала модуля или другого источника
данных модуля, например %QD1.6.</li>
</ol>
<p>Следует отметить правило для переменных внешних плагинов: 2*n-1 –
значение, 2*n – состояние, где n – номер канала или другого источника
данных модуля. Например, переменная %ID1.5 является значением 3-го
сигнала, а переменная %ID1.6 является состоянием 3-го сигнала.</p>
<p>Далее подробнее рассказано о каждом плагине доступном в среде разработки
«Beremiz» и его редакторе. В п. 7.5 даётся описание процесса связывания
переменных плагинов и переменными программных модулей с применением
описанных выше адресов переменных плагина.</p>
<ol class="arabic">
<li><p class="first rubric" id="id48">Плагины дискретных модулей</p>
<ol class="arabic">
<li><p class="first rubric" id="id49">Модуль дискретного ввода «МДВ»</p>
</li>
</ol>
</li>
</ol>
<p>Редактор модуля дискретного ввода «МДВ» с 32 каналами (см. рис. Рис.
107), позволяет задать:</p>
<ul class="simple">
<li>«Базовый адрес».</li>
</ul>
<p><a class="reference internal" href="../_images/image163.png"><img alt="image161" src="../_images/image163.png" style="width: 3.37708in; height: 3.44583in;" /></a></p>
<p>Рис. 107 – Редактор модуля дискретного ввода «МДВ»</p>
<p>В виде таблицы отображен список доступных для связывания переменных.
Переменная с нулевым номером («mdv_0_condition») хранит состояние
всего модуля в целом. Переменная с нечётным номером хранит значение
сигнала. Например, «mdv_0_signal2» соответствует второму сигналу
модуля дискретного ввода. А перемеменная «mdv_0_condition4» –
соответствует состоянию 4 сигнала. Для дискретных модулей состояние
сигналов равно по умолчанию 0.</p>
</div>
<div class="section" id="id50">
<h3>Модуль дискретного вывода «МДВыв»<a class="headerlink" href="#id50" title="Ссылка на этот заголовок">¶</a></h3>
<p>Редактор модуля дискретного вывода «МДВыв» с 32 каналами (см. рис. Рис.
108) позволяет задать:</p>
<ul class="simple">
<li>«Базовый адрес».</li>
</ul>
<p>В виде таблицы отображен список доступных для связывания переменных.
Аналогично модулю дискретного ввода, переменная с нулевым номером хранит
состояние всего модуля в целом. Переменная с нечётным номером хранит
значение сигнала, а с чётным – состояние сигнала.</p>
<p><a class="reference internal" href="../_images/image164.png"><img alt="image162" src="../_images/image164.png" style="width: 3.42778in; height: 3.47708in;" /></a></p>
<p>Рис. 108 – Редактор модуля дискретного вывода «МДВыв»</p>
<ol class="arabic">
<li><p class="first rubric" id="id51">Плагины аналоговых модулей</p>
<ol class="arabic">
<li><p class="first rubric" id="id52">Модуль аналогового ввода «МАВ 1.2.1»</p>
</li>
</ol>
</li>
</ol>
<p>Редактор плагина аналогового модуля ввода (см. рис. Рис. 109) позволяет
задать настройки для работы в целом данным модулей и отдельно для
каждого сигнала.</p>
<p>В целом для модуля можно установить:</p>
<ul class="simple">
<li>«Базовый адрес»;</li>
<li>«Минимальное напряжение»;</li>
<li>«Максимальное напряжение»;</li>
<li>«Тип модуля»;</li>
<li>«Представление измерений».</li>
</ul>
<p><a class="reference internal" href="../_images/image165.png"><img alt="image163" src="../_images/image165.png" style="width: 5.55764in; height: 6.21597in;" /></a></p>
<p>Рис. 109 – Редактор плагина модуля аналогового ввода «МАВ 1.2.1»</p>
<p>Для каждого конкретного сигнала указывается его имя, адрес и адрес
состояния сигнала. Последние два параметра используются для связывания с
переменными программных модулей.</p>
<p>Данный редактор позволяет задать для каждого сигнала:</p>
<ul class="simple">
<li>фильтрацию шумов сигнала, указывающую в процентах, изменения
отклонения значения сигнала, которые не будут рассматриваться;</li>
<li>множитель;</li>
<li>слагаемое;</li>
<li>минимальное электрическое значение измеряемого сигнала, которое может
выдать датчик;</li>
<li>максимальное электрическое значение измеряемого сигнала, которое
может выдать датчик;</li>
<li>минимальное значение физической величины, соответствующее
минимальному значению сигнала датчика;</li>
<li>максимальное значение физической величины, соответствующее
максимальному значению сигнала датчика;</li>
<li>значение нагрузочного резистора</li>
<li>минимальное значение ошибки;</li>
<li>максимальное значение ошибки.</li>
</ul>
<p>Значения множителя и слагаемого могут быть заданы автоматическим
вычислением, при выборе флажка «Автоматическое вычисление» (см. рис.
Рис. 110).</p>
<p><a class="reference internal" href="../_images/image166.png"><img alt="image164" src="../_images/image166.png" style="width: 2.92500in; height: 4.30417in;" /></a></p>
<p>Рис. 110 – Установка в ручную значений множителя и слагаемого</p>
</div>
<div class="section" id="id53">
<h3>Модуль аналогового вывода «МАО»<a class="headerlink" href="#id53" title="Ссылка на этот заголовок">¶</a></h3>
<p>Редактор данного модуля представлен на рис. Рис. 111.</p>
<p>В целом для модуля можно установить:</p>
<ul class="simple">
<li>«Базовый адрес»;</li>
<li>«Минимальное напряжение»;</li>
<li>«Максимальное напряжение»;</li>
<li>«Тип модуля»;</li>
<li>«Представление измерений».</li>
</ul>
<p><a class="reference internal" href="../_images/image167.png"><img alt="image165" src="../_images/image167.png" style="width: 5.14792in; height: 5.15417in;" /></a></p>
<p>Рис. 111 – Редактор плагина модуля аналогового вывода</p>
<p>Для каждого конкретного сигнала указывается его имя, адрес и адрес
состояния сигнала. Последние два параметра используются для связывания с
переменными программных модулей.</p>
<p>Данный редактор позволяет изменить для каждого сигнала:</p>
<ul>
<li><p class="first">множитель;</p>
</li>
<li><p class="first">слагаемое;</p>
</li>
<li><p class="first">фильтрация шумов сигнала, указывающая в процентах, изменения
отклонения значения сигнала, которые не будут рассматриваться;</p>
</li>
<li><p class="first">минимальное электрическое значение измеряемого сигнала, которое может
выдать датчик;</p>
</li>
<li><p class="first">максимальное электрическое значение измеряемого сигнала, которое
может выдать датчик;</p>
</li>
<li><p class="first">минимальное значение физической величины, соответствующее
минимальному значению сигнала датчика;</p>
</li>
<li><p class="first">значение нагрузочного резистора.</p>
</li>
<li><p class="first">максимальное значение физической величины, соответствующее
максимальному значению сигнала датчика;</p>
<ol class="arabic">
<li><p class="first rubric" id="tcp">Плагин «TCP интерфейс»</p>
</li>
</ol>
</li>
</ul>
<p>Плагин «TCP интерфейс» позволяет различным внешним модулям (для которых
также есть соответствующие плагины) и прикладным программам
взаимодействовать (получать и передавать различные данные) с
устройствами «верхнего уровня». При использовании плагина «TCP
интерфейс», в общих настройках плагина (см. рис. Рис. 112) необходимо
указать следующие флаги компоновки (LDFLAGS):</p>
<p>-L. -ltcpsrv -L. –ltagsmanager</p>
<p><a class="reference internal" href="../_images/image168.png"><img alt="image166" src="../_images/image168.png" style="width: 4.36528in; height: 1.14097in;" /></a></p>
<p>Рис. 112 – Установка флагов компоновки для плагина «TCP интерфейс»</p>
<p>Данные флаги необходимы, т.к. при выполнении плагина «TCP интерфейс»
происходит обращение к библиотекам libtcpsrv.so и libtagsmanager.so,
которые находятся на целевом устройстве. Редактор плагина «TCP
интерфейс» (см. рис. Рис. 113) позволяет выполнять следующие операции:</p>
<ul class="simple">
<li>задать адрес порта, по которому могут подключаться внешние
программные средства;</li>
<li>добавлять/удалять переменные, которые могут быть связаны с
программами, написанными на языках IEC 61131-3;</li>
<li>добавить/удалить переменные, связанные с различными внешними модулями
(дискретными, аналоговыми), плагины, которых уже добавлены (ниже про
данную возможность рассказано подробнее).</li>
</ul>
<p><a class="reference internal" href="../_images/image169.png"><img alt="image167" src="../_images/image169.png" style="width: 5.19722in; height: 2.95069in;" /></a></p>
<p>Рис. 113 – Редактор плагина «TCP интерфейс»</p>
</div>
<div class="section" id="id54">
<h3>Связывание переменных внешних модулей с плагином «TCP интерфейс»<a class="headerlink" href="#id54" title="Ссылка на этот заголовок">¶</a></h3>
<p>Связывание переменных внешних модулей с плагином «TCP интерфейс»
происходит следующим образом. Во-первых, в проект добавляется
необходимый плагин, соответствующий внешнему модулю, переменные которого
будут связываться. Данное действие осуществляется с помощью дерева
проекта (п. 6.3) или главного меню программы (п. 6.1). После того как
плагин добавлен, необходимо объявить интересующние переменные (внешнего
модуля) глобальными на уровне проекта. Данную операцию оптимальнее
выполнить с помощью кнопки «Добавить переменные» (см. таблица 3) на
панели переменных и констант.</p>
<p>В появившемся диалоге (см. рис. Рис. 114) выбран модуль с
идентификатором «mdo_0» («МДВыв») и отмечены галочкой необходимые
переменные, соответствующие определённым сигналам.</p>
<p><a class="reference internal" href="../_images/image170.png"><img alt="image168" src="../_images/image170.png" style="width: 4.70625in; height: 2.04444in;" /></a></p>
<p>Рис. 114 – Выбор переменных модулей для добавлениях их в глобальную
область проекта</p>
<p>Нажатие кнопки «Добавить» добавляет отмеченные переменные на панель
переменных и констант. После того как переменные добавлены глобально на
уровне проекта (см. рис. Рис. 115), они будут доступны для связывания в
плагине «TCP интерфейс».</p>
<p><a class="reference internal" href="../_images/image171.png"><img alt="image169" src="../_images/image171.png" style="width: 5.61597in; height: 1.87639in;" /></a></p>
<p>Рис. 115 – Добавленные глобальные переменные модуля «mdo_0» («МДВыв»)</p>
<p>Далее все операции выполняются уже в редакторе плагина «TCP интерфейс».
В нём необходимо нажать кнопку «Модули» (см. рис. Рис. 116).</p>
<p><a class="reference internal" href="../_images/image172.png"><img alt="image170" src="../_images/image172.png" style="width: 5.06111in; height: 3.15000in;" /></a></p>
<p>Рис. 116 – Выбор добавления переменных модулей, объявленных глобально</p>
<p>В появившемся диалоге будут доступны все переменные модулей, объявленные
глобально. Далее необходимо выделить с помощью галочки интересующие
переменные и нажать кнопку «Добавить» (см. рис. Рис. 117).</p>
<p><a class="reference internal" href="../_images/image173.png"><img alt="image171" src="../_images/image173.png" style="width: 4.72014in; height: 1.94931in;" /></a></p>
<p>Рис. 117 – Добавление глобальных переменных проекта как переменных
плагина «TCP интерфейс»</p>
<p>После этого переменные будут добавлены как переменные плагина «TCP
интерфейс» (см. рис. Рис. 118).</p>
<p><a class="reference internal" href="../_images/image174.png"><img alt="image172" src="../_images/image174.png" style="width: 5.04097in; height: 2.95486in;" /></a></p>
<p>Рис. 118 – Добавленные переменные модуля «mdo_0» («МДВыв») как
переменные плагина «TCP интерфейс»</p>
<p>Имя каждой переменной (столбец «Имя») для внешних программных средств
это идентификатор (имя тега) для обращения к данной переменной, т.е. для
получения и изменения её значения, внешних программных средств. Данные
имена могут быть изменены на любой другое уникальное имя в рамках
плагина «TCP интерфейс».</p>
</div>
<div class="section" id="id55">
<h3>Добавление собственных переменных плагина «TCP интерфейс»<a class="headerlink" href="#id55" title="Ссылка на этот заголовок">¶</a></h3>
<p>Плагин «TCP интерфейс» позволяет добавлять собственные переменные,
которые будут доступны программным модулям как переменные плагина модуля
УСО. Переменные могут быть следующих типов: DINT, LINT, REAL, LREAL.
Информация о типах данных приведена в приложении 3 в описании языка ST.
Добавление новой переменной осуществляется с помощью кнопки «Добавить
переменную» (см. рис. Рис. 119).</p>
<p><a class="reference internal" href="../_images/image175.png"><img alt="image173" src="../_images/image175.png" style="width: 5.03611in; height: 2.94097in;" /></a></p>
<p>Рис. 119 – Добавление собственной переменной плагина «TCP интерфейс»</p>
<p>В добавленном поле необходимо указать «Имя», «Класс» и «Тип» для новой
переменной (см. рис. Рис. 120).</p>
<p><a class="reference internal" href="../_images/image176.png"><img alt="image174" src="../_images/image176.png" style="width: 5.89444in; height: 2.83819in;" /></a></p>
<p>Рис. 120 – Указание типа добавленной переменной в плагин модуля «TCP
интерфейс»</p>
<p>Поле «Адрес» для новой переменной будет None, что означает, что
переменная не связана ни с каким внешним модулем. После того как
переменная добавлена, в данном случае её имя «tcp_in», класс – «input»
(т.е. входная) и тип – REAL (вещественный), она доступна как переменная
плагина модуля «TCP интерфейс» в программных модулях (см. рис. Рис.
121).</p>
<p><a class="reference internal" href="../_images/image177.png"><img alt="image175" src="../_images/image177.png" style="width: 5.25000in; height: 3.74444in;" /></a></p>
<p>Рис. 121 – Добавленная переменная «tcp_in» модуля «TCP интерфейс»</p>
</div>
</div>
<div class="section" id="id56">
<h2>Связывание переменных программных модулей с внешними переменными<a class="headerlink" href="#id56" title="Ссылка на этот заголовок">¶</a></h2>
<p>Связывание внешних переменных с переменными программных модулей
осуществляется с помощью адресов переменных, рассмотренных в п. 7.1.4.
Данная операция осуществляется следующим образом. Выбирается программный
модуль, переменные которого необходимо связать с переменными плагинов.
Далее на панели переменных и констант (п. 6.4) выбирается переменная,
которую необходимо связать и выполняется двойной щелчок мышью по полю
«Адрес» данной переменной для того, чтобы появилась кнопка «…» (см. рис.
Рис. 122).</p>
<p><a class="reference internal" href="../_images/image178.png"><img alt="image176" src="../_images/image178.png" style="width: 6.41111in; height: 1.34444in;" /></a></p>
<p>Рис. 122 – Поле «Адрес» панели переменных и констант</p>
<p>Нажав появившуюся кнопку «…» в поле «Адрес» появится диалог «Просмотр
адресов» (см. рис. Рис. 123), в котором отображаются доступные для
связывания переменные плагинов. Список отображаемых переменных в данном
диалоге зависит от типа и класса переменной в панели переменных и
констант, с которой связывается внешняя переменная.</p>
<p><a class="reference internal" href="../_images/image179.png"><img alt="image177" src="../_images/image179.png" style="width: 5.54028in; height: 3.71111in;" /></a></p>
<p>Рис. 123 – Диалог просмотра адресов</p>
<p>После выбора необходимой переменной и нажатия кнопки OK, поле адреса
соответствующей переменной будет заполнено адресом внешней переменной
(см. рис. Рис. 124).</p>
<p><a class="reference internal" href="../_images/image180.png"><img alt="image178" src="../_images/image180.png" style="width: 6.48819in; height: 1.36597in;" /></a></p>
<p>Рис. 124 – Добавленный адрес переменной внешнего модуля</p>
<p>Среда разработки «Beremiz» позволяет добавить сразу множество
переменных, связанных с плагинами внешних модулей. На панели переменных
и констант имеется кнопка «Добавить переменные» (см. таблица 3), которая
вызывает диалог «Модули» (см. рис. Рис. 125).</p>
<p><a class="reference internal" href="../_images/image181.png"><img alt="image179" src="../_images/image181.png" style="width: 4.72292in; height: 2.26042in;" /></a></p>
<p>Рис. 125 – Диалог добавления переменных модулей</p>
<p>Необходимо выделить с помощью галочки все переменные, которые необходимо
добавить на панель программного модуля и нажать кнопку «Добавить». Все
внешние переменные буду сразу же добавлены (см. рис. Рис. 126).</p>
<p><a class="reference internal" href="../_images/image182.png"><img alt="image180" src="../_images/image182.png" style="width: 6.71250in; height: 3.02431in;" /></a></p>
<p>Рис. 126 – Добавление переменных с помощью диалога «Модули»</p>
<p>В данном диалоге имеются кнопки «Выделить всё» и «Снять выделение»,
позволяющие быстро выделить все переменные текущего модуля (выбранного
из списка, находящегося над кнопками) или, соответственно снять
выделение со всех переменных.</p>
</div>
</div>
<div class="section" id="id57">
<h1>Работа с проектом<a class="headerlink" href="#id57" title="Ссылка на этот заголовок">¶</a></h1>
<p>В данном разделе рассмотрены основные приёмы работы в среде разработки
«Beremiz», которые необходимы при создании прикладной программы.</p>
<div class="section" id="id58">
<h2>Создание нового проекта<a class="headerlink" href="#id58" title="Ссылка на этот заголовок">¶</a></h2>
<p>Новый проект создаётся с помощью главного меню «Файл» – «Новый» (см.
рис. Рис. 127), либо с помощью кнопки «Новый» на панели управления.</p>
<p><a class="reference internal" href="../_images/image183.png"><img alt="image181" src="../_images/image183.png" style="width: 2.62361in; height: 2.18750in;" /></a></p>
<p>Рис. 127 – Создание нового проекта с помощью главного меню</p>
<p>Далее появится диалог (см. рис. Рис. 128), в котором необходимо выбрать
папку, где будет храниться данный проект.</p>
<p><a class="reference internal" href="../_images/image184.png"><img alt="image182" src="../_images/image184.png" style="width: 2.30625in; height: 2.65139in;" /></a></p>
<p>Рис. 128 – Диалог выбора папки для нового проекта</p>
<p>Папка должна быть обязательно пустой и не защищена от записи. Если в
папке уже есть файлы, будет выдана соответствующая ошибка. В созданной
папке будут сохранены следующие файлы и папки:</p>
<ul>
<li><p class="first">«beremiz.xml» – в данном XML файле сохраняются настройки специфичные
для среды разработки «Beremiz» относительно проекта;</p>
</li>
<li><p class="first">«plc.xml» – в данном XML файле сохраняется полное описание проекта:
всех программных модулей, ресурсов, пользовательских типов данных,
данных о проекте, настроек редакторов графических языков IEC 61131-3;</p>
</li>
<li><p class="first">папки с настройками плагинов внешних модулей УСО;</p>
</li>
<li><p class="first">папка «build», которая хранит генерируемый ST и C код, а также
получаемый исполняемый бинарный файл.</p>
<ol class="arabic">
<li><p class="first rubric" id="id59">Настройка проекта</p>
</li>
</ol>
</li>
</ul>
<p>Как правило, первым шагом после создания проекта является его настройка,
включающая в себя задание глобальных переменных, установку параметров
компиляции и компоновки, а также заполнение данных о проекте. Вызов
панели настройки проекта осуществляется при выборе (двойном щелчке левой
кнопкой мыши) корневого элемента дерева проекта, которое по умолчанию,
сразу после создания проекта называется «Unnamed», как показано на рис.
Рис. 129:</p>
<p><a class="reference internal" href="../_images/image185.png"><img alt="image183" src="../_images/image185.png" style="width: 5.85208in; height: 3.71944in;" /></a></p>
<p>Рис. 129 – Вызов панели настройки проекта с помощью корневого элемента
дерева проекта</p>
<div class="section" id="id60">
<h3>Глобальные переменные проекта<a class="headerlink" href="#id60" title="Ссылка на этот заголовок">¶</a></h3>
<p>Глобальные переменные позволяют программным модулям типа «Программа» и
«Функциональный блок» использовать общие переменные, которые будут
определены в глобальной области видимости проекта.</p>
<p>Ниже, на рис. Рис. 130, в панели переменных и констант создана
глобальная переменная «globalValue» с начальным значением 10, с помощью
кнопки «Добавить переменную» (см. таблица 3).</p>
<p><a class="reference internal" href="../_images/image186.png"><img alt="image184" src="../_images/image186.png" style="width: 6.17639in; height: 1.60764in;" /></a></p>
<p>Рис. 130 – Объявление глобальный переменной проекта</p>
<p>Для того чтобы к данной глобальной переменной можно было обращаться из
программных модулей типа «Программа» или «Функциональный блок»
необходимо в их панели редактирования в панели переменных и констант
создать переменную с таким же именем, как и ранее объявленная
глобальная, и установить её класс «Внешняя». На рис. 131 приведён пример
объявления в программном модуле «program0» переменной «globalValue»
класса «Внешняя», типа INT и изменение её значения с помощью языка ST.</p>
<p><a class="reference internal" href="../_images/image187.png"><img alt="image185" src="../_images/image187.png" style="width: 6.13472in; height: 1.99028in;" /></a></p>
<p>Рис. 131 – Использование глобальной переменной в программном модуле</p>
<p>На рис. 132 в программном модуле «program1» также определена переменная
«globalValue» класса «Внешняя» и изменение её значения с помощью языка
ST.</p>
<p><a class="reference internal" href="../_images/image188.png"><img alt="image186" src="../_images/image188.png" style="width: 6.16528in; height: 1.81042in;" /></a></p>
<p>Рис. 132 – Использование глобальной переменной в программном модуле</p>
<p>Соответственно, переменная «globalValue» будет изменяться во время
выполнения в двух программных модулях: «program0» и «program1».</p>
</div>
<div class="section" id="id61">
<h3>Настройки сборки проекта и соединения с целевым устройством<a class="headerlink" href="#id61" title="Ссылка на этот заголовок">¶</a></h3>
<p>Для использования написанной прикладной программы необходимо её собрать
(скомпилировать и скомпоновать), т.е. получить исполняемый файл и
передать на целевое устройство для отладки или просто исполнения. В
связи с этим основными настройками являются: «URI адрес» целевого
устройства и целевая платформа, указывающая архитектуру платформы
целевого устройства. На рис. 133 данные параметры выделены красным
цветом.</p>
<p><a class="reference internal" href="../_images/image189.png"><img alt="image187" src="../_images/image189.png" style="width: 3.96458in; height: 3.85486in;" /></a></p>
<p>Рис. 133 – Выбор целевой платформы для сборки прикладной программы</p>
<p>Как правило, «URI адрес» указывается в формате:</p>
<p>PYRO://&lt;IP-адрес целевого устройства&gt;:&lt;порт&gt;</p>
<p>IP адрес целевого устройства должен быть известен и необходима
возможность подключения к нему по локальной сети (требуется обратить
внимание на сетевые настройки операционной системы). По умолчанию порт
имеет номер 3000.</p>
<p>Например, целевая платформа указывается «Sparc», если архитектура
целевого устройства «SPARC».</p>
</div>
<div class="section" id="id62">
<h3>Данные о проекте<a class="headerlink" href="#id62" title="Ссылка на этот заголовок">¶</a></h3>
<p>При создании нового проекта, все обязательные поля в настройках
информации о проекте заполняются значениями по умолчанию. Рекомендуется
заменить данные настройки по умолчанию на релевантную информацию (см.
рис. 134), позволяющую удобным образом различать проекты.</p>
<p><a class="reference internal" href="../_images/image190.png"><img alt="image188" src="../_images/image190.png" style="width: 4.17222in; height: 2.51875in;" /></a></p>
<p>Рис. 134 – Указание данных о проекте</p>
<p>Большая часть данных в информации проекте являются необязательным для
заполнения, но некоторые должны быть всегда заполнены. Это указывается в
подсказках в именовании каждого пункта.</p>
<p>После задания настроек проекта, как правило, следует добавление в проект
необходимых программных модулей (функций, функциональных блоков и
программ), реализация их алгоритмов и логики работы с помощью текстовых
и графических языков стандарта IEC 61131-3.</p>
</div>
</div>
<div class="section" id="id63">
<h2>Программные модули<a class="headerlink" href="#id63" title="Ссылка на этот заголовок">¶</a></h2>
<p>Добавление программных модулей (программ, функций, функциональных
блоков) осуществляется с помощью всплывающего меню дерева проекта, в
котором необходимо выбрать пункт «Функция», «Функциональный блок» или
«Программа». Далее появится диалог «Создать новый программный модуль»
(см. рис. 135).</p>
<p><a class="reference internal" href="../_images/image191.png"><img alt="image189" src="../_images/image191.png" style="width: 2.56389in; height: 1.92847in;" /></a></p>
<p>Рис. 135 – Диалог добавления программного модуля</p>
<p>В данном диалоге три поля:</p>
<ul class="simple">
<li>«Имя программного модуля»;</li>
<li>«Тип программного модуля»;</li>
<li>«Язык».</li>
</ul>
<p>Имя, присвоенное по умолчанию, может быть заменено на имя,
соответствующее назначению данного программного модуля. В зависимости от
того, какой программный модуль был выбран во всплывающем меню, в поле
«Тип программного модуля» будет подставлено именование данного
программного модуля. В поле «Язык» необходимо выбрать из списка (см.
рис. 136) один из языков стандарта IEC 61131-3 (IL, ST, LD, FBD, SFC),
на котором будет реализованы алгоритмы и логика работы данного
добавляемого программного модуля.</p>
<p><a class="reference internal" href="../_images/image192.png"><img alt="image190" src="../_images/image192.png" style="width: 2.57361in; height: 1.93819in;" /></a></p>
<p>Рис. 136 – Выбор языка для программного модуля</p>
<p>Далее расмотрено добавление каждого программного модуля в отдельности.</p>
<div class="section" id="id64">
<h3>Программа<a class="headerlink" href="#id64" title="Ссылка на этот заголовок">¶</a></h3>
<p>Ниже будет приведён пример добавления в проект программы, написанной на
языке FBD. Логика и алгоритм работы данного программного модуля
следующие: определены две глобальные переменные «globalValue» и
«globalLevel», если значение «globalValue» больше 10.0, то присвоить
переменной «globalLevel» значение 100, в противном случае присвоить
«globalLevel» значение 50.</p>
<p>Сначала следует добавление программы в проект, осуществляемое с помощью
меню дерева проекта, выбором пункта «Программа» (см. рис. 137):</p>
<p><a class="reference internal" href="../_images/image193.png"><img alt="image191" src="../_images/image193.png" style="width: 2.32222in; height: 3.15417in;" /></a></p>
<p>Рис. 137 – Выбор в дереве проекта добавления программы</p>
<p>В появившемся диалоге (см. рис. 138) выбирается язык FBD и нажимается
кнопка «OK».</p>
<p><a class="reference internal" href="../_images/image194.png"><img alt="image192" src="../_images/image194.png" style="width: 2.42569in; height: 1.82708in;" /></a></p>
<p>Рис. 138 – Диалог добавления программы</p>
<p>Далее в открывшейся вкладке с панелью редактирования данного
программного модуля в панели переменных и констант (см. рис. 139)
добавляются переменные: «globalValue» типа REAL, класса «Внешняя» и
«globalLevel» типа INT, класса «Внешняя».</p>
<p><a class="reference internal" href="../_images/image195.png"><img alt="image193" src="../_images/image195.png" style="width: 5.89653in; height: 1.77153in;" /></a></p>
<p>Рис. 139 – Объявление в программе внешних переменных</p>
<p>Предполагается, что эти переменные уже определены глобальными
переменными проекта в панели редактирования проекта (см. рис. 140), как
описывается в п. 8.2.1.</p>
<p><a class="reference internal" href="../_images/image196.png"><img alt="image194" src="../_images/image196.png" style="width: 5.91528in; height: 1.77222in;" /></a></p>
<p>Рис. 140 – Глобальные переменные проекта</p>
<p>Далее необходимо обратиться к редактору языка FBD. Для написания
алгоритма и логики выполнения данной программы будут добавлены две
функции: «GT» и «SEL». Функция «GT» обозначает сравнение «Больше чем» и
находится во вкладке «Операции сравнения». Она может содержать от 2 до
20 входных значений (в данном примере их будет 2) и одно выходное
значение «OUT». Если значение «IN1» больше значения «IN2», то на выходе
«OUT» будет TRUE, в противном случае FALSE.</p>
<p>Функция «SEL» обозначает «Выбор одного из двух значений» и находится во
вкладке «Операции выбора». Она содержит три входных переменных «G»,
«IN0», «IN1» и одну выходную «OUT». Если «G» равно 0 (или FALSE), то
выходной переменной «OUT» присваивается значение «IN0». Если «G» равно 1
(или TRUE), то выходной переменной «OUT» присваивается значение «IN1».</p>
<p>Добавление данных функций удобнее осуществить переносом соответствующей
функции с помощью мыши (Drag&amp;Drop) из панели библиотеки функций и
функциональных блоков в область редактирования FBD диаграммы данного
программного модуля (см. рис. 141):</p>
<p><a class="reference internal" href="../_images/image197.png"><img alt="image195" src="../_images/image197.png" style="width: 6.30278in; height: 2.56667in;" /></a></p>
<p>Рис. 141 – Добавление двух функций на FBD диаграмму</p>
<p>Далее, так же используя мышь, переносятся переменные «globalValue» и
«globalLevel» на FBD диаграмму. Как уже упоминалось ранее (см. п.
6.7.1.2), необходимо левой клавишей мыши зажать столбец «#» для
переменной в панели переменных и констант, далее перенести указатель на
область редактирования FBD диаграммы и отпустить кнопку мыши
(Drag&amp;Drop). Такую манипуляцию нужно произвести для обоих переменных
(см. рис. 142).</p>
<p><a class="reference internal" href="../_images/image198.png"><img alt="image196" src="../_images/image198.png" style="width: 5.46875in; height: 3.01875in;" /></a></p>
<p>Рис. 142 – Перенесённые переменные на FBD диаграмму</p>
<p>Переменную «globalValue» можно сразу соединить с входом «IN1» функции
«GT». Чтобы переменную «globalValue» можно было соединить с выходом
«OUT» функции «SEL», необходимо сделать двойной щелчок левой кнопкой
мыши по «globalValue» на FBD диаграмме и в появившемся диалоге «Свойства
переменной» указать класс «Выходная», как показано на рис. 143:</p>
<p><a class="reference internal" href="../_images/image199.png"><img alt="image197" src="../_images/image199.png" style="width: 6.22917in; height: 3.11597in;" /></a></p>
<p>Рис. 143 – Указание класса «Выходная» для переменной</p>
<p>После этого переменную «globalValue» можно соединить с выходом «OUT»
функции «SEL» и выход «OUT» функции «GT» с входом «G» функции «SEL» (см.
рис. 144).</p>
<p><a class="reference internal" href="../_images/image200.png"><img alt="image198" src="../_images/image200.png" style="width: 6.26111in; height: 3.10486in;" /></a></p>
<p>Рис. 144 – Соединение входов и выходом функций на диаграмме FBD</p>
<p>Далее необходимо добавить 3 числовых литерала, которые будут напрямую
соединены с входом «IN2» функции «GT» и входами «IN0» и «IN1» функции
«SEL». В панели редактирования FBD диаграммы выбирается кнопка «Добавить
переменную» (см. таблица 6) и в появившемся диалоге «Свойства
переменной» (см. рис. 145) в поле выражения пишется «10.0». Нажимается
кнопка «OK».</p>
<p><a class="reference internal" href="../_images/image201.png"><img alt="image199" src="../_images/image201.png" style="width: 5.73125in; height: 2.96250in;" /></a></p>
<p>Рис. 145 – Добавление переменной на FBD диаграмму</p>
<p>Добавленный литерал соединяется с входом «IN2» функции «GT», как
показано на рис. 146:</p>
<p><a class="reference internal" href="../_images/image202.png"><img alt="image200" src="../_images/image202.png" style="width: 5.68472in; height: 2.82083in;" /></a></p>
<p>Рис. 146 – Соединение добавленной переменной с выходом функции</p>
<p>Аналогичным образом создаются литералы со значениями 50 и 100 для входов
«IN0» и «IN1» функции «SEL» и соединяются с ними (см. рис. 147).</p>
<p><a class="reference internal" href="../_images/image203.png"><img alt="image201" src="../_images/image203.png" style="width: 5.92292in; height: 3.18403in;" /></a></p>
<p>Рис. 147 – Пример программного модуля, написанного на языке FBD</p>
<p>Соответственно, в случае если значение переменной «globalValue» больше
10.0, то на выходе «OUT» функции «GT» будет значение TRUE, тем самым на
вход функции «SEL» поступит тоже True и выходное значение «OUT» будет
равно «IN1», т.е. 100.</p>
<p>Далее будет рассмотрен пример добавления программного модуля типа
«Функция»</p>
</div>
<div class="section" id="id65">
<h3>Функция<a class="headerlink" href="#id65" title="Ссылка на этот заголовок">¶</a></h3>
<p>Ниже будет приведен пример добавления в проект функции, и её
использование в программном модуле типа «Программа». Добавление функции
осуществляется с помощью меню дерева проекта, выбором пункта «Функция»
(см. рис. 148):</p>
<p><a class="reference internal" href="../_images/image204.png"><img alt="image202" src="../_images/image204.png" style="width: 1.91389in; height: 2.78889in;" /></a></p>
<p>Рис. 148 – Выбор в дереве проекта добавления функции</p>
<p>В появившемся диалоге «Создать новый программный модуль» в поле «Имя
программного модуля» укажем имя «GetStatus» и выберем «Язык» ST из
списка языков стандарта IEC 61131-3 (см. рис. 149). Язык SFC не может
быть использован для описания алгоритма и логики работы функции.</p>
<p><a class="reference internal" href="../_images/image205.png"><img alt="image203" src="../_images/image205.png" style="width: 2.53125in; height: 1.90833in;" /></a></p>
<p>Рис. 149 – Диалог добавления пользовательской функции</p>
<p>В появившейся панели редактирования функции выберем тип возвращаемого
значения функции – STRING (см. рис. 150).</p>
<p><a class="reference internal" href="../_images/image206.png"><img alt="image204" src="../_images/image206.png" style="width: 2.90278in; height: 2.31389in;" /></a></p>
<p>Рис. 150 – Выбор возвращаемого значения фунцией</p>
<p>Далее в панели переменных и констант указываются переменная «value»
(хотя переменных может быть несколько) класса «Входная» и в редакторе
языка ST пишется алгоритм и логика работы данной функции, как показано
на рис. 151:</p>
<p><a class="reference internal" href="../_images/image207.png"><img alt="image205" src="../_images/image207.png" style="width: 6.75972in; height: 2.68750in;" /></a></p>
<p>Рис. 151 – Опредение функции алгоритма и логики выполнения фунции</p>
<p>С помощью блока CASE…OF определяются возвращаемые значения функции в
зависимости от значения «value». Если ни одно из 3 условий не подходит,
то возвращается «Error».</p>
<p>Далее необходимо создать программный модуль «Программа» на языке FBD и в
появившейся панели его редактирования добавить две переменные
«in_value» и «out_status», как показано на рис. 152:</p>
<p><a class="reference internal" href="../_images/image208.png"><img alt="image206" src="../_images/image208.png" style="width: 6.52222in; height: 2.36319in;" /></a></p>
<p>Рис. 152 – Добавленный программный модуль «Программа» на языке FBD</p>
<p>На панели библиотеки функций и функциональных блоков в разделе
«Пользовательские программные модули» необходимо выбрать функцию
«GetStatus» и с помощью указателя мыши (зажав левую кнопку мыши)
перенести данную функцию (Drag&amp;Drop) в область редактирования FBD
диаграммы программного модуля «program0» (см. рис. 153).</p>
<p><a class="reference internal" href="../_images/image209.png"><img alt="image207" src="../_images/image209.png" style="width: 6.66319in; height: 2.52847in;" /></a></p>
<p>Рис. 153 – Добавление на FBD диаграмму пользовательской функции</p>
<p>Аналогичным образом «перетаскиваются» переменные из панели переменных и
констант в область редактирования FBD диаграммы (см. рис. 154).</p>
<p><a class="reference internal" href="../_images/image210.png"><img alt="image208" src="../_images/image210.png" style="width: 6.25347in; height: 2.42361in;" /></a></p>
<p>Рис. 154 – Добавление на FBD диаграмму переменных из панели переменных и
констант</p>
<p>Для того чтобы переменную «out_status» можно было соединить с «выходом»
функции «GetStatus», необходимо в диалоге свойств данной переменной
(который вызывается двойным щелчком левой кнопки мыши по переменной в
области редактирования FBD диаграммы) указать класс «Выходная» (см. рис.
155).</p>
<p><a class="reference internal" href="../_images/image2111.png"><img alt="image209" src="../_images/image2111.png" style="width: 6.28750in; height: 3.59375in;" /></a></p>
<p>Рис. 155 – Изменение «класса» переменной FBD диаграммы</p>
<p>Теперь переменные «in_value» и «out_status» можно соединить
соответственно с «входом» и «выходом» функции «GetStatus» (см. рис.
156).</p>
<p><a class="reference internal" href="../_images/image212.png"><img alt="image210" src="../_images/image212.png" style="width: 6.41458in; height: 2.47153in;" /></a></p>
<p>Рис. 156 – Пример FBD диаграммы с использованием пользовательской
функции</p>
<p>В результате созданная функция будет возвращать текстовое значение в
переменную «out_status» в зависимости от значения переменной
«in_value». Стоит отметить, что в данном примере значение переменной
«in_value» постоянно равно 5 (для упрощения примера), но она также
может зависеть от других переменных или быть связана, используя поле
«Адрес», например с переменными внешних модулей УСО.</p>
</div>
<div class="section" id="id66">
<h3>Функциональный блок<a class="headerlink" href="#id66" title="Ссылка на этот заголовок">¶</a></h3>
<p>Добавление пользовательского функционального блока происходит аналогично
добавлению функции. Ниже приведён пример создания функционального блока
и его использования. После выбора в дереве проекта добавить
«Функциональный блок», создаётся функциональный блок с именем
«RectParams» (см. рис. 157), который будет считать площадь и периметр
прямоугольника с заданными сторонами.</p>
<p><a class="reference internal" href="../_images/image213.png"><img alt="image211" src="../_images/image213.png" style="width: 2.65903in; height: 2.01042in;" /></a></p>
<p>Рис. 157 – Диалог добавления пользовательского функционального блока</p>
<p>В отличие от функции, функциональный блок может быть описан на любом
языке стандарта IEC 61131-3, включая язык SFC. На рис. 158 показана
реализация данного функционального блока на языке ST.</p>
<p><a class="reference internal" href="../_images/image214.png"><img alt="image212" src="../_images/image214.png" style="width: 5.73819in; height: 2.97153in;" /></a></p>
<p>Рис. 158 – Описание пользовательского функционального блока на языке ST</p>
<p>Возвращаемого значения у функционального блока нет. Добавленные
переменные, обозначающие ширину – «width» и высоту – «height» имеют
класс «Входная» и тип INT. Выходные значения: площадь – «area» и
периметр – «perimeter» определены соответственно классом «Выходная» и
так же типа INT. Ниже находится текст алгоритма расчёта площади и
периметра на языке ST. Реализованный функциональный блок становится
доступным в панели библиотеки функций и функциональных блоков (см. п.
6.11) и может использоваться в программных модулях типа «Программа» и
«Функциональный блок». На рис. 159 показано использование созданного
функционального блока «RectParams» в FBD диаграмме.</p>
<p><a class="reference internal" href="../_images/image215.png"><img alt="image213" src="../_images/image215.png" style="width: 5.28056in; height: 3.22431in;" /></a></p>
<p>Рис. 159 – Использование созданного функционального блока в FBD
диаграмме</p>
<p>С входом «width» соединена переменная «width», а с входом «height»
литерал «40». Результат выполнения данного функционального блока также
помещается, соответственно, в «area» и «perimeter». Следует отметить,
что при попытке удаления функции или функционального блока из проекта
(см. рис. 160), где эти добавленные программные модули уже используются,
будет выдана ошибка.</p>
<p><a class="reference internal" href="../_images/image216.png"><img alt="image214" src="../_images/image216.png" style="width: 2.74931in; height: 1.31597in;" /></a></p>
<p>Рис. 160 – Удаление функционального блока</p>
<p>Пример сообщения об ошибке удаления программного модуля приведен на рис.
161.</p>
<p><a class="reference internal" href="../_images/image217.png"><img alt="image215" src="../_images/image217.png" style="width: 3.33889in; height: 1.15417in;" /></a></p>
<p>Рис. 161 – Сообщение об ошибке при удалении функционального блока</p>
</div>
</div>
<div class="section" id="id67">
<h2>Плагины модулей УСО<a class="headerlink" href="#id67" title="Ссылка на этот заголовок">¶</a></h2>
<p>Панель редактирования плагинов для модулей УСО содержит общие настройки
для всех плагинов и специфичные в зависимости от назначения плагина.</p>
<p>В проект, содержащий программный модуль типа «Программа» («program0»),
написанный на языке ST, добавляются два плагина модулей УСО: «МДВ-У» и
«МДВыв-У». Данная операция осуществляется с помощью соответствующих
пунктов меню дерева проекта (см. рис. 162):</p>
<p><a class="reference internal" href="../_images/image218.png"><img alt="image216" src="../_images/image218.png" style="width: 2.17292in; height: 3.12986in;" /></a></p>
<p>Рис. 162 – Выбор в меню дерева проекта плагина модуля «МДВ-У» для
добавления в проект</p>
<p>После добавления плагинов модулей «МДВ-У» и «МДВыв-У», дерево проекта
выглядит, как показано на рис. 163:</p>
<p><a class="reference internal" href="../_images/image219.png"><img alt="image217" src="../_images/image219.png" style="width: 2.08750in; height: 1.99306in;" /></a></p>
<p>Рис. 163 – Дерево проекта после добавления двух плагинов модулей УСО</p>
<p>Далее в программном модуле «program0» необходимо создать переменные,
связанные с переменными модулей, которые были добавлены выше. Т.к.
переменных будет добавлено несколько, данную операцию удобнее всего
осуществить с помощью кнопки «Добавить переменные» (см. таблица 3) на
панели переменных и констант. В появившемся диалоге отображены
переменные модуля «mdo-0». Далее отмечаются необходимые для добавления
переменные данного модуля и нажимается кнопка «Добавить», как показано
на рис. 164:</p>
<p><a class="reference internal" href="../_images/image220.png"><img alt="image218" src="../_images/image220.png" style="width: 6.61319in; height: 2.58264in;" /></a></p>
<p>Рис. 164 – Добавление переменных модуля «mdo-0»</p>
<p>В «Списке модулей» выбирается модуль «mdv-0» и отмечаются интересующие
переменные. Выполняется аналогичная операция добавления с помощью кнопки
«Добавить» (см. рис. 165).</p>
<p><a class="reference internal" href="../_images/image221.png"><img alt="image219" src="../_images/image221.png" style="width: 6.61597in; height: 2.60764in;" /></a></p>
<p>Рис. 165 – Добавление переменных модуля «mdv-0»</p>
<p>После того, как все необходимые переменные добавлены, диалог может быть
закрыт. В панели переменных и констант будут отображены все переменные
соответствующего типа и класса с установленным адресом (см. рис. 166).</p>
<p><a class="reference internal" href="../_images/image222.png"><img alt="image220" src="../_images/image222.png" style="width: 6.61528in; height: 2.15903in;" /></a></p>
<p>Рис. 166 – Панель переменных и констант после добавления переменных
модулей УСО</p>
<p>Следует отметить, что имена добавленных переменных можно изменить. Далее
в редакторе языка ST написана логика работы данного программного модуля,
показанная на рис. 167:</p>
<p><a class="reference internal" href="../_images/image223.png"><img alt="image221" src="../_images/image223.png" style="width: 5.47847in; height: 3.54583in;" /></a></p>
<p>Рис. 167 – Панель редактирования программного модуля</p>
<p>Если первый или второй сигналы, соответственно переменные
«mdv0_singnal1» и «mdv0_singnal2», модуля «МДВ-У» (в проекте «mdv0»)
равны TRUE, то переменным модуля «МДВыв-У» «md0_signal2» и
«md0_signal3» присваивается значение TRUE, в противном случае – FALSE.
Если третий сигнал модуля «МДВ-У» «mdv0_signal3» равен FALSE, то
переменной модуля «МДВыв-У» «md0_signal1» присваивается TRUE, в
противном случае FALSE.</p>
</div>
<div class="section" id="id68">
<h2>Ресурс<a class="headerlink" href="#id68" title="Ссылка на этот заголовок">¶</a></h2>
<p>Согласно стандарту IEC 61131-3, каждый проект должен иметь как минимум
один ресурс, с определённым в нём как минимум одним экземпляром.
Экземпляр представляет собой элемент, связанный с программным модулем
типа «Программа» и одной определённой задачей. По умолчанию, среда
разработки «Beremiz» создаёт для нового проекта один ресурс.</p>
<div class="section" id="id69">
<h3>Глобальные переменные ресурса<a class="headerlink" href="#id69" title="Ссылка на этот заголовок">¶</a></h3>
<p>Глобальные переменные ресурса объявляются аналогично глобальным
переменным проекта (см. п. 8.2.1) на панели переменных и констант (см.
рис. 168) выбранного ресурса с использованием кнопки «Добавить
переменную», либо «Добавить переменные» (см. таблица 3).</p>
<p><a class="reference internal" href="../_images/image224.png"><img alt="image222" src="../_images/image224.png" style="width: 5.87708in; height: 1.46736in;" /></a></p>
<p>Рис. 168 – Пример объявления глобальной на уровне проекта константы</p>
<p>Использование данных глобальных переменных на уровне ресурса также
аналогично использованию глобальных переменных проекта в программных
модулях. Ниже, на рис. 169, показано, как в программном модуле
«program0» добавлено две переменных класса «Внешняя» с такими же
именами, как и глобальными переменные, объявленные выше для ресурса.</p>
<p><a class="reference internal" href="../_images/image225.png"><img alt="image223" src="../_images/image225.png" style="width: 5.33611in; height: 2.45764in;" /></a></p>
<p>Рис. 169 – Объявление и использование глобальных переменных ресурса</p>
<p>В редакторе ST кода написан алгоритм работы данного программного модуля
с использованием данных глобальных переменных.</p>
</div>
<div class="section" id="id70">
<h3>Задачи и экземпляры ресурса<a class="headerlink" href="#id70" title="Ссылка на этот заголовок">¶</a></h3>
<p>Для создания экземпляра необходимо наличие как минимум одного
программного модуля типа «Программа» в проекте и как минимум одной
задачи, определённой в панели редактирования ресурса.</p>
<p>После добавления задачи с помощью кнопки «Добавить» (данная кнопка
аналогична кнопки «Добавить» на панели переменных и констант),
необходимо задать её уникальное имя (поле «Имя») и выбрать тип
выполнения задачи (поле «Тип выполнения», см. рис. 170):</p>
<ul class="simple">
<li>«Цикличное» – выполнение программного модуля типа «Программа» через
заданный интервал времени, указанный в поле «Интервал»;</li>
<li>«По условию» – выполнение программного модуля типа «Программа» один
раз при наступлении значения TRUE глобальной переменной типа BOOL,
определённой на уровне проекта, либо на уровне ресурса, указанной в
поле «Флаг условия».</li>
</ul>
<p><a class="reference internal" href="../_images/image226.png"><img alt="image224" src="../_images/image226.png" style="width: 5.92153in; height: 1.27569in;" /></a></p>
<p>Рис. 170 – Выбор типа выполнения задачи</p>
<p>В случае выбора типа выполнения «Цикличное», в поле «Интервал»
необходимо указать интервал, с которым будет выполняться данная задача.
Двойной щелчок левой кнопкой мыши по полю «Интервал» приводит к
появлению кнопки «...» (см. рис. 171).</p>
<p><a class="reference internal" href="../_images/image227.png"><img alt="image225" src="../_images/image227.png" style="width: 5.97292in; height: 1.29375in;" /></a></p>
<p>Рис. 171 – Добавление задачи с цикличным режимом выполнения</p>
<p>Нажатие данной кнопки вызывает диалог «Редактировать продолжительность»
(см. рис. 172), в котором можно указать время, используя микросекунды,
миллисекунды, секунды, минуты, часы и дни.</p>
<p><a class="reference internal" href="../_images/image228.png"><img alt="image226" src="../_images/image228.png" style="width: 5.53194in; height: 1.64444in;" /></a></p>
<p>Рис. 172 – Диалог редактирования продолжительности задачи</p>
<p>Завершение ввода времени кнопкой «OK» приводит к закрытию диалога и
добавлению данного интервала времени в поле «Интервал» добавляемой
задачи (см. рис. 173).</p>
<p><a class="reference internal" href="../_images/image229.png"><img alt="image227" src="../_images/image229.png" style="width: 6.19375in; height: 1.37014in;" /></a></p>
<p>Рис. 173 – Добавленный интервал выполнения</p>
<p>В случае выбора типа выполнения «По условию» в поле «Флаг условия»
необходимо указать переменную типа BOOL, определённую глобально либо на
уровне проекта (см. п. 8.2.1), либо на уровне ресурса (см. п. 8.5.1). На
рис. 174 выбирается переменная «globalFlag», определённая в данном
ресурсе.</p>
<p><a class="reference internal" href="../_images/image230.png"><img alt="image228" src="../_images/image230.png" style="width: 5.87222in; height: 3.67639in;" /></a></p>
<p>Рис. 174 – Выбор переменной типа BOOL для определения условия выполнения
задачи</p>
<p>Задача будет выполнена один раз, как только значение переменной,
определённой в этом поле, будет TRUE.</p>
<p>Поле «Приоритет» позволяет указать приоритет выполнения задачи, по
умолчанию все задачи имеют приоритет 0. Следует отметить, что в ресурсе
должна быть определена как минимум одна задача с типом выполнения
«Цикличное», в противном случае будет ошибка в компиляции в отладочной
консоли (см. п. 6.12).</p>
<p>После того как задачи определены, их можно использовать в экземплярах.
Создание экземпляра происходит аналогичным образом с помощью кнопки
«Добавить». Необходимо выбрать уникальное имя экземпляра и далее указать
программный модуль типа «Программа» в поле «Тип» и одну из задач в поле
«Задача». Например, в проекте определено два программных модуля типа
«Программа»: «program0» и «program1» (см. рис. 175).</p>
<p><a class="reference internal" href="../_images/image231.png"><img alt="image229" src="../_images/image231.png" style="width: 2.50417in; height: 1.42778in;" /></a></p>
<p>Рис. 175 – Проект, содержащий два программными модулями типа «Программа»</p>
<p>Соответственно, при создании экземпляра в поле «Тип» оба этих
программных модуля будут доступны (см. рис. 176).</p>
<p><a class="reference internal" href="../_images/image232.png"><img alt="image230" src="../_images/image232.png" style="width: 5.40139in; height: 2.46806in;" /></a></p>
<p>Рис. 176 – Выбор программного модуля типа «Программа» для экземпляра</p>
<p>Аналогичным образом выбирается задача из списка, в котором будут
отображены определённые ранее задачи (см. рис. 177).</p>
<p><a class="reference internal" href="../_images/image233.png"><img alt="image231" src="../_images/image233.png" style="width: 5.46319in; height: 3.67778in;" /></a></p>
<p>Рис. 177 – Выбор задачи для экземпляра</p>
<p>В каждом проекте в ресурсе должен быть определен как минимум один
экземпляр, в противном случае будет ошибка выдана компиляции в
отладочной консоли (см. п. 6.12).</p>
</div>
</div>
<div class="section" id="id71">
<h2>Типы данных<a class="headerlink" href="#id71" title="Ссылка на этот заголовок">¶</a></h2>
<p>Добавление типа данных происходит выбором пункта «Типа данных» в меню
дерева проекта (см. рис. 178) в уже созданный проект, содержащий
программный модуль типа «Программа» – «program0».</p>
<p><a class="reference internal" href="../_images/image234.png"><img alt="image232" src="../_images/image234.png" style="width: 2.01458in; height: 2.85000in;" /></a></p>
<p>Рис. 178 – Выбор пункта меню добавления пользовательского типа данных в
дереве проекта</p>
<p>Будет создан массив типа INT размерностью 11 элементов. В появившемся
диалоге указывается имя создаваемого типа данных, например «MyArrayType»
(см. рис. 179) и нажимается кнопка «OK».</p>
<p><a class="reference internal" href="../_images/image235.png"><img alt="image233" src="../_images/image235.png" style="width: 2.99097in; height: 1.26875in;" /></a></p>
<p>Рис. 179 – Диалог ввода имени создаваемого пользовательского типа данных</p>
<p>В дереве проекта появляется панель редактирования добавленного типа
данных с именем «MyArrayType (см. п. 6.9). В поле «Механизм создания
нового типа» необходимо выбрать «Массив» и указать тип INT, как показано
на рис. 180:</p>
<p><a class="reference internal" href="../_images/image236.png"><img alt="image234" src="../_images/image236.png" style="width: 4.85833in; height: 2.90625in;" /></a></p>
<p>Рис. 180 – Выбор базового типа для массива</p>
<p>С помощью кнопки «Добавить» (см. таблица 10) создаётся поле для массива
с указанием его размерности (см. рис. 181) в соответствующем формате.</p>
<p><a class="reference internal" href="../_images/image237.png"><img alt="image235" src="../_images/image237.png" style="width: 4.95347in; height: 2.94931in;" /></a></p>
<p>Рис. 181 – Задание размерности для массива</p>
<p>После выполнения вышеперечисленных операций тип «MyArrayType» может быть
использован для определения переменных в программных модулях, так же как
и базовые типы данных (см. рис. 182).</p>
<p><a class="reference internal" href="../_images/image238.png"><img alt="image236" src="../_images/image238.png" style="width: 6.29028in; height: 1.82917in;" /></a></p>
<p>Рис. 182 – Выбор добавленного типа данных в панели переменных и констант
программного модуля</p>
<p>Добавим две переменные «temp_value» и «out_value» типа INT в панель
переменных и констант. Ниже, на рис. 183, пример кода на языке ST, в
котором используется переменная «mas», тип которой массив, добавленный
выше.</p>
<p>Сначала локальной переменной «temp_value» присваивается значение 10:</p>
<p>temp_value := 10;</p>
<p>Далее первому элементу массива «mas» (нумерация элементов в массиве
начинается с 0) присваивается значение переменной «temp_value»:</p>
<p>mas[0] := temp_value;</p>
<p>Второму элементу массива «mas» присваивается значение 20:</p>
<p>mas[1] := 20;</p>
<p>И в конце второй локальной переменной присваивается первый элемент
массива «mas»:</p>
<p>out_value := mas[0];</p>
<p>Далее будет рассмотрена процедура сборки и отладки проекта.</p>
<p><a class="reference internal" href="../_images/image239.png"><img alt="image237" src="../_images/image239.png" style="width: 6.16597in; height: 2.90417in;" /></a></p>
<p>Рис. 183 – Пример использования массива в коде на языке ST</p>
</div>
</div>
<div class="section" id="id72">
<h1>Сборка, передача на целевое устройство и отладка прикладной программы<a class="headerlink" href="#id72" title="Ссылка на этот заголовок">¶</a></h1>
<p>Следующими шагами после создания основных элементов проекта является его
сборка (компиляция и компоновка), передача полученного исполняемого
файла на целевое устройство и отладка данной прикладной программы.</p>
<p>Сборка проекта осуществляется с помощью соответствующих кнопок,
находящихся на панели инструментов (см. п. 6.2.2). Для успешного
завершения данной операции каждый проект должен иметь как минимум один
ресурс (как уже упоминалось, при создании проекта по умолчанию ресурс
будет создан). В ресурсе должна быть определена, как минимум, одна
задача циклического типа и, как минимум, один экземпляр. Соответственно,
проект обязан содержать, как минимум, один программный модуль типа
«Программа», причём тело, т.е. алгоритм и логика его выполнения, не
может быть пустым (в противном случае будет ошибка компиляции).</p>
<p>Возможность передачи на целевое устройство прикладной программы и её
отладки определяется наличием запущенной на целевом устройстве серверной
части среды разработки «Beremiz».</p>
<p>Среда разработки «Beremiz» предоставляет следующие возможности отладки:</p>
<ul class="simple">
<li>просмотр и изменение значения всех переменных проекта, используя
панель отладки, (см. п. 6.14);</li>
<li>визуально отслеживание выполнения программ на графических языках и
изменение значения различных графических элементов конкретного языка;</li>
<li>отображение значений переменных в виде графика (см. п. 6.15).</li>
</ul>
<p>Далее подробнее рассказывается про соединение с целевым устройством,
передачи на него исполняемого файла и его отладке.</p>
<div class="section" id="id73">
<h2>Запуск серверной части для отладки<a class="headerlink" href="#id73" title="Ссылка на этот заголовок">¶</a></h2>
<p>Серверная часть среды разработки «Beremiz», необходимая для передачи
исполняемого файла на целевое устройство и его отладки, находится в
сценарии на языке Python: Beremiz_service.py. Запуск данного файла
осуществляется из командной строки, следующей командой с параметрами по
умолчанию (см. таблица 13):</p>
<p>$ python Beremiz_service.py</p>
<p>Также, при запуске могут быть указаны параметры, представленные в
таблице 13.</p>
<p>Таблица 13 – Параметры командной строки запуска серверной части среды
«Beremiz»</p>
<table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="96%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Параметр</td>
<td>Операция</td>
</tr>
<tr class="row-even"><td>-i</td>
<td>Указание IP адреса для обращения клиента, по умолчанию 127.0.0.1 (localhost)</td>
</tr>
<tr class="row-odd"><td>-p</td>
<td>Номер порта, по умолчанию 3000</td>
</tr>
<tr class="row-even"><td>-h</td>
<td>Вывод в консоль справки по работе с данным сервером</td>
</tr>
<tr class="row-odd"><td>-a</td>
<td>Автоматический запуск целевого устройства (0 – выключить, 1 – включить), по умолчанию 0</td>
</tr>
<tr class="row-even"><td>-x</td>
<td>Включить/выключить иконку в панели задач (0 – выключить, 1 – включить), по умолчанию 0</td>
</tr>
<tr class="row-odd"><td>-t</td>
<td>Включить/выключить web-интерфейс с использованием библиотеки Twisted (0 – выключить, 1 – включить), по умолчанию 0. Данный web-интерфейс позволяет отслеживать состояние выполнения исполняемого файла через браузер, по адресу: <a class="reference external" href="http:/">http:/</a>/&lt;ip-адрес целевого устройства&gt;:&lt;8009&gt;. 8009 – порт по умолчанию.</td>
</tr>
</tbody>
</table>
<p>После указания всех параметров команды запуска серверной части «Beremiz»
можно ввести адрес директории, в которой будут храниться файлы на
файловой системе целевого устройства. По умолчанию этой директорией
является та, в которой находится Beremiz_service.py.</p>
<p>Как правило, данный сценарий запускается в автоматическом режиме при
включении целевого устройства, средствами операционной системы.</p>
</div>
<div class="section" id="id74">
<h2>Соединение с целевым устройством и передача исполняемого файла<a class="headerlink" href="#id74" title="Ссылка на этот заголовок">¶</a></h2>
<p>После того как скрипт серверной части среды разработки «Beremiz»
запущен, можно производить соединение с целевым устройством. В панели
настроек проекта (см. п. 6.5) необходимо указать URI-адрес целевого
устройства:</p>
<p>PYRO://&lt;IP-адрес&gt;:&lt;номер порт&gt;</p>
<p>На рис. 184 показан URI адрес целевого устройства PYRO://192.168.23.226
и выделена красным цветом кнопка «Соединиться с целевым устройством»
(см. таблица 2), которая используется для соединения с целевым
устройством.</p>
<p><a class="reference internal" href="../_images/image240.png"><img alt="image238" src="../_images/image240.png" style="width: 6.07014in; height: 3.61319in;" /></a></p>
<p>Рис. 184 – Соединение с целевым устройством</p>
<p>В случае успешного соединения, в отладочной консоли будет выведено
соответствующее сообщение и выведен статус прикладной программы (см.
рис. 185).</p>
<p><a class="reference internal" href="../_images/image241.png"><img alt="image239" src="../_images/image241.png" style="width: 3.05278in; height: 2.72778in;" /></a></p>
<p>Рис. 185 – Отладочная консоль после соединения с целевым устройством</p>
<p>Статусы прикладной программы могут быть следующие:</p>
<ul class="simple">
<li>«Empty» – прикладная программа отсутствует;</li>
<li>«Started» – прикладная программа на целевом устройстве есть и она
выполняется;</li>
<li>«Stopped» – прикладная программа на целевом устройстве есть, но
остановлена.</li>
</ul>
<p>Используя кнопки передачи, запуска и остановки прикладной программы на
целевом устройстве (см. таблица 2) можно передать исполняемый файл
прикладной программы, запустить его и остановить. В отладочной консоли
будут выведены соответствующие сообщения (после передачи, запуска и
остановки прикладной программы), как показано на рис. 186:</p>
<p><a class="reference internal" href="../_images/image242.png"><img alt="image240" src="../_images/image242.png" style="width: 2.91250in; height: 2.30764in;" /></a></p>
<p>Рис. 186 – Отладочная консоль после передачи прикладной программы,
запуска и остановки</p>
</div>
<div class="section" id="id75">
<h2>Отладка текстовых языков<a class="headerlink" href="#id75" title="Ссылка на этот заголовок">¶</a></h2>
<p>После установки соединения с целевым устройством и запуском прикладной
программы на выполнение, среда разработки «Beremiz» позволяет
отслеживать и изменять значения переменных программных модулей, из
которых состоит проект. Необходимо обратиться к панели экземпляров (см.
п. 6.10) и используя соответствующие кнопки, выделенные красным цветом
на рис. 187, добавить переменных панель отладки (см. п. 6.14):</p>
<p><a class="reference internal" href="../_images/image243.png"><img alt="image241" src="../_images/image243.png" style="width: 2.44306in; height: 1.19167in;" /></a></p>
<p>Рис. 187 – Добавление переменных для отладки из панели экземпляров</p>
<p>На панели отладки сразу же отобразятся текущие значения добавленных
переменных (см. рис. 188).</p>
<p><a class="reference internal" href="../_images/image244.png"><img alt="image242" src="../_images/image244.png" style="width: 2.46042in; height: 1.38472in;" /></a></p>
<p>Рис. 188 – Панель отладки значений переменных</p>
<p>Для того чтобы изменить значение переменной во время исполнения проекта,
необходимо нажать правой клавишей мыши в поле «Значение» интересующей
переменной и в появившемся всплывающем меню (см. рис. 189) выбрать
«Установить значение».</p>
<p><a class="reference internal" href="../_images/image245.png"><img alt="image243" src="../_images/image245.png" style="width: 2.37361in; height: 1.64931in;" /></a></p>
<p>Рис. 189 – Всплывающее меню манипуляций со значением переменной</p>
<p>Появится диалог, показанный на рис. 190.</p>
<p><a class="reference internal" href="../_images/image246.png"><img alt="image244" src="../_images/image246.png" style="width: 2.92986in; height: 1.24583in;" /></a></p>
<p>Рис. 190 – Установка значения переменной во время отладки</p>
<p>Для корректного изменения, вводимое значение должно соответствовать типу
переменной, иначе будет выведено сообщение об ошибке (см. рис. 191).</p>
<p><a class="reference internal" href="../_images/image247.png"><img alt="image245" src="../_images/image247.png" style="width: 3.02708in; height: 1.23056in;" /></a></p>
<p>Рис. 191 – Ошибка при вводе недопустимого значения изменяемой переменной
в режиме отладки</p>
<p>После изменения значения переменной, она будет отображаться синим цветом
(см. рис. 192) в таблице переменных и их значений во вкладке «Отладка»:</p>
<p><a class="reference internal" href="../_images/image248.png"><img alt="image246" src="../_images/image248.png" style="width: 2.38264in; height: 1.39722in;" /></a></p>
<p>Рис. 192 – Переменные в режиме отладки</p>
<p>Для возврата переменной в «нормальный» режим (т.е. вывести из режима
отладки), необходимо снова обратиться к всплывающему меню и выбрать
«Освободить значение» (см. рис. 193):</p>
<p><a class="reference internal" href="../_images/image249.png"><img alt="image247" src="../_images/image249.png" style="width: 2.40903in; height: 1.72500in;" /></a></p>
<p>Рис. 193 – Всплывающее меню манипуляций со значением переменной</p>
<p>Далее следует описание отладки прикладных программ, написанных на
графических языках.</p>
</div>
<div class="section" id="id76">
<h2>Отладка FBD диаграмм<a class="headerlink" href="#id76" title="Ссылка на этот заголовок">¶</a></h2>
<p>Во время отладки прикладной программы, в которой часть программных
модулей написано на графических языках, есть возможность видеть
изменения всех значений на диаграмме и вносить необходимые изменения
прямо на ней. Как уже упоминалось ранее в п. 6.10, в случае нажатия
кнопки запуска режима отладки (на рис. 194 выделены красным цветом) для
экземпляра программы, написанной на одном из графических языков,
откроется вкладка с панелью диаграммы в режиме отладки.</p>
<p><a class="reference internal" href="../_images/image250.png"><img alt="image248" src="../_images/image250.png" style="width: 2.92917in; height: 1.15486in;" /></a></p>
<p>Рис. 194 – Панель экземпляров проекта</p>
<p>В режиме отладки FBD диаграммы есть возможность устанавливать входные и
выходные значения переменных (с помощью всплывающего меню, которые
вызывается нажатием правой клавишей по соединению) для функциональных
блоков, а также в целом видеть все остальные значения на входах и
выходах элементов диаграммы (см. рис. 195).</p>
<p><a class="reference internal" href="../_images/image251.png"><img alt="image249" src="../_images/image251.png" style="width: 4.63472in; height: 2.36806in;" /></a></p>
<p>Рис. 195 – Пример отладки FBD диаграммы</p>
<p>Изменённые значения в режиме отладки выделяются синим цветом. После
выбора во всплывающем меню «Освободить значение» значение возвращается в
то, которое получается в результате выполнения логики и алгоритма
данного модуля на данном участке, а соединение на диаграмме становятся
исходного цвета.</p>
</div>
<div class="section" id="id77">
<h2>Отладка LD диаграммы<a class="headerlink" href="#id77" title="Ссылка на этот заголовок">¶</a></h2>
<p>Отладка LD диаграммы осуществляется аналогично отладке FBD диаграммы.
Для вызова всплывающего меню (см. рис. 196), в котором можно установить
желаемое значение для контакта или катушки необходимо нажать правую
клавишу мыши.</p>
<p><a class="reference internal" href="../_images/image252.png"><img alt="image250" src="../_images/image252.png" style="width: 2.67986in; height: 1.32431in;" /></a></p>
<p>Рис. 196 – Пример отладки LD диаграммы</p>
<p>Появится диалог (см. рис. 197), в котором нужно ввести значение типа
BOOL: TRUE – контакт «ON», FALSE – контакт «OFF».</p>
<p><a class="reference internal" href="../_images/image253.png"><img alt="image251" src="../_images/image253.png" style="width: 4.20556in; height: 2.78681in;" /></a></p>
<p>Рис. 197 – Отладка LD диаграммы</p>
<p>После установки в режиме отладки, для данного примера, контакта «IN2»
(см. рис. 198), в значение «TRUE» катушка OUT1 приняла значение TRUE,
т.к. данная схема представляет собой реализацию «Логического ИЛИ» для
IN1 и IN2.</p>
<p><a class="reference internal" href="../_images/image254.png"><img alt="image252" src="../_images/image254.png" style="width: 3.33819in; height: 1.62361in;" /></a></p>
<p>Рис. 198 – Отладка LD диаграммы</p>
</div>
<div class="section" id="id78">
<h2>Отладка SFC диаграммы<a class="headerlink" href="#id78" title="Ссылка на этот заголовок">¶</a></h2>
<p>Отладка SFC диаграммы происходит аналогично отладке диаграмм FBD и LD. С
помощью всплывающего меню (см. рис. 199), есть возможность устанавливать
активность для шагов и переходов.</p>
<p><a class="reference internal" href="../_images/image255.png"><img alt="image253" src="../_images/image255.png" style="width: 6.70208in; height: 3.42569in;" /></a></p>
<p>Рис. 199 – Пример отладки SFC диаграммы</p>
<p>На рис. 200 показано, как устанавливается значение (после выбора
«Установить значение», появится диалог) TRUE для шага «firstStep».</p>
<p><a class="reference internal" href="../_images/image256.png"><img alt="image254" src="../_images/image256.png" style="width: 6.35764in; height: 3.27222in;" /></a></p>
<p>Рис. 200 – Пример отладки SFC диаграммы</p>
<p>После установки значения шага в TRUE с помощью режима отладки, шаг будет
выделен голубым цветом. Как можно заметить по рис. 201, т.к. шаг
«firstStep» стал активным, блок действий, ассоциированный с ним, так же
стал активным (выделен зелёным цветом), а действия внутри него, в данном
случае одно действие по увеличению переменной «count» на 1:</p>
<p>count := count + 1;</p>
<p>стало выполняться.</p>
<p><a class="reference internal" href="../_images/image257.png"><img alt="image255" src="../_images/image257.png" style="width: 6.25139in; height: 3.21111in;" /></a></p>
<p>Рис. 201 – Пример отладки SFC диаграммы</p>
<p>Так как квалификатор этого действия – N, то оно будет выполняться до тех
пор, пока шаг активен.</p>
</div>
<div class="section" id="id79">
<h2>График изменения значения переменной<a class="headerlink" href="#id79" title="Ссылка на этот заголовок">¶</a></h2>
<p>Среда разработки «Beremiz» так же позволяет отображать в виде графика
изменение значения переменной в режиме отладки. Для вывода панели с
графиком, необходимо выбрать в панели экземпляра кнопку отображения
графика изменения значения переменной в режиме отладки (см. таблица 11)
для необходимой переменной, выделенную красным цветом на рис. 202:</p>
<p><a class="reference internal" href="../_images/image258.png"><img alt="image256" src="../_images/image258.png" style="width: 2.81736in; height: 0.87847in;" /></a></p>
<p>Рис. 202 – Выбор кнопки на панели экземпляров для отображения графика
изменения значения переменной</p>
<p>Появившееся панель графика изменения переменной (см. рис. 203) позволяет
отслеживать то, как значение определённой переменной изменяется в
течение времени.</p>
<p><a class="reference internal" href="../_images/image259.png"><img alt="image257" src="../_images/image259.png" style="width: 5.80556in; height: 3.11944in;" /></a></p>
<p>Рис. 203 – График изменения переменной</p>
<p>На данной панели можно установить интервал обновления и масштаб
отображения графика, а так же передвигать позицию графика.</p>
<p>График, изображенный на рис. 203, соответствует изменению переменной из
программного модуля на рис. 204:</p>
<p><a class="reference internal" href="../_images/image260.png"><img alt="image258" src="../_images/image260.png" style="width: 6.43403in; height: 2.07222in;" /></a></p>
<p>Рис. 204 – Пример программного модуля тип «Программа» на языке ST</p>
<p>Как видно из графика, переменная «value» изменяется по закону синуса,
что соответствует алгоритму, записанному на языке ST.</p>
<ol class="arabic">
<li><p class="first rubric" id="id80">Пример создания прикладной программы</p>
<ol class="arabic">
<li><p class="first rubric" id="id81">Описание примера</p>
</li>
</ol>
</li>
</ol>
<p>Пример, создаваемый ниже, будет работать с двумя модулями УСО
(построенных на архитектуре «SPARC»): модулем дискретного ввода и TCP
интерфейсом, а так же содержать два программных модуля на языках SFC и
ST, с определённым алгоритмом и логикой работы. Данные, полученные с
сигналов модуля дискретного ввода, соответствующие 3-му и 4-му сигналу
будут напрямую связаны с TCP интерфейсом и доступны как теги для внешних
программных средств.</p>
</div>
<div class="section" id="id82">
<h2>Создание проекта<a class="headerlink" href="#id82" title="Ссылка на этот заголовок">¶</a></h2>
<p>Создание проекта начинается с выбора в главном меню «Файл» – «Новый»,
как показано на рис. 205:</p>
<p><a class="reference internal" href="../_images/image261.png"><img alt="image259" src="../_images/image261.png" style="width: 5.60069in; height: 3.44097in;" /></a></p>
<p>Рис. 205 – Создание нового проекта</p>
<p>В появившемся диалоге необходимо выбрать пустую папку, где будет создан
проект, и нажать кнопку «ОК». В созданном новом проекте (см. рис. 206) в
дереве проекта отображен созданный по умолчанию ресурс с именем
«resource1».</p>
<p><a class="reference internal" href="../_images/image262.png"><img alt="image260" src="../_images/image262.png" style="width: 6.00764in; height: 4.07222in;" /></a></p>
<p>Рис. 206 – Созданный новый проект</p>
<p>Далее следует настройка параметров проекта.</p>
</div>
<div class="section" id="id83">
<h2>Настройка параметров проекта<a class="headerlink" href="#id83" title="Ссылка на этот заголовок">¶</a></h2>
<p>С помощью дерева проекта выбирается корневой элемент, соответствующий
вызову панели настройки проекта. Необходимо снять флаг дополнительных
библиотек «Python_Library» и «SVGUI_Library». Целевая платформа
выбирается «Sparc». В качестве «URI адреса» указывается в IP адрес и
порт целевого устройства с начальной приставкой PYRO, на котором
автоматически запускается серверная часть среды разработки «Beremiz»
(см. п. 9.1):</p>
<p>PYRO://192.168.23.226:3000</p>
<p>Соответственно, панель настройки проекта будет выглядеть, как показано
на рис. 207.</p>
<p><a class="reference internal" href="../_images/image263.png"><img alt="image261" src="../_images/image263.png" style="width: 5.56528in; height: 4.57569in;" /></a></p>
<p>Рис. 207 – Настройка параметров проекта</p>
<p>Следующим шагом будет добавление необходимых элементов проекта с помощью
меню дерева проекта.</p>
</div>
<div class="section" id="id84">
<h2>Добавление плагинов для модулей УСО<a class="headerlink" href="#id84" title="Ссылка на этот заголовок">¶</a></h2>
<p>Как ранее было сказано, существует интерфейс, позволяющий связывать
внешние источники данных, такие как модули УСО (их параметры, состояния)
с программными модулями, из которых состоит прикладная программа. Данный
интерфейс осуществлён с помощью механизма плагинов для модулей УСО.
Далее в проект будут добавлены плагины модулей: «МДВ-У» и «TCP
интерфейс».</p>
<div class="section" id="id85">
<h3>Добавление плагина модуля «МДВ-У»<a class="headerlink" href="#id85" title="Ссылка на этот заголовок">¶</a></h3>
<p>Добавим плагин для модуля дискретного ввода «МДВ-У» с помощью меню
дерева проекта (см. рис. 208).</p>
<p><a class="reference internal" href="../_images/image264.png"><img alt="image262" src="../_images/image264.png" style="width: 2.15347in; height: 3.05139in;" /></a></p>
<p>Рис. 208 – Добавление плагина для модуля МДВ-У</p>
<p>В появившейся вкладке настройки плагина «МДВ-У» (см. рис. 209)
параметры, заданные по умолчанию, изменены не будут:</p>
<ul class="simple">
<li>«COM порт»: COM1;</li>
<li>«Сетевой адрес»: 1.</li>
</ul>
<p><a class="reference internal" href="../_images/image265.png"><img alt="image263" src="../_images/image265.png" style="width: 3.63264in; height: 3.62569in;" /></a></p>
<p>Рис. 209 – Панель настройки плагина модуля МДВ-У</p>
<p>Объявим переменные соответствующие 3-му и 4-му сигналу, добавленного
выше модуля «МДВ-У», глобальными на уровне проекта, чтобы их можно было
связать с плагином «TCP интерфейс». Данная операция выполняется в
настройках параметров проекта. Необходимо обратиться к панели переменных
и констант и нажать на ней кнопку «Добавить переменные», которая на рис.
210 выделена красным цветом:</p>
<p><a class="reference internal" href="../_images/image266.png"><img alt="image264" src="../_images/image266.png" style="width: 6.13750in; height: 2.03681in;" /></a></p>
<p>Рис. 210 – Кнопка добавить переменных на панели переменных и констант
настройки проекта</p>
<p>В появившемся диалоге отмечаются сигналы «mdv0_signal3» и
«mdv0_signal4» и нажимается кнопка «Добавить» (см. рис. 211).</p>
<p><a class="reference internal" href="../_images/image267.png"><img alt="image265" src="../_images/image267.png" style="width: 5.41528in; height: 2.55486in;" /></a></p>
<p>Рис. 211 – Добавление переменных плагина «TCP интерфейс», как глобальных
переменных проекта</p>
<p>Соответственно, панель переменных и констант проекта будет выглядеть,
как показано на рис. 212.</p>
<p><a class="reference internal" href="../_images/image268.png"><img alt="image266" src="../_images/image268.png" style="width: 6.01319in; height: 1.57917in;" /></a></p>
<p>Рис. 212 – Список глобальных переменных проекта</p>
<p>Далее следует добавление плагина модуля «TCP интерфейс».</p>
</div>
<div class="section" id="id86">
<h3>Добавление плагина модуля «TCP интерфейс»<a class="headerlink" href="#id86" title="Ссылка на этот заголовок">¶</a></h3>
<p>Добавление плагина «TCP интерфейс» осуществляется аналогично добавлению
плагина модуля «МДВ-У» через всплывающее меню дерева проекта (см. рис.
213).</p>
<p><a class="reference internal" href="../_images/image269.png"><img alt="image267" src="../_images/image269.png" style="width: 2.28194in; height: 3.43403in;" /></a></p>
<p>Рис. 213 – Добавление плагина для модуля «TCP интерфейс»</p>
<p>В плагине «TCP интерфейс» указываются флаги (см. п. 7.4), необходимые
для его сборки в параметре «LDFLAGS»:</p>
<p>-L. -ltcpsrv -L. –ltagsmanager</p>
<p>Далее добавляются две переменные, с помощью кнопки «Добавить
переменную», относящиеся к самому плагину, т.е. две его собственные
переменные «tcp_out1» и «tcp_out2» (см. рис. 214):</p>
<p><a class="reference internal" href="../_images/image270.png"><img alt="image268" src="../_images/image270.png" style="width: 5.78194in; height: 3.12708in;" /></a></p>
<p>Рис. 214 – Добавленные переменные плагина «TCP интерфейс»</p>
<p>Установим у них класс «output», т.е. выходные переменные и тип «DINT».
Так же добавим две связанные переменные с плагином «МДВ-У» с помощью
кнопки «Модули». В появившемся диалоге устанавливаются галочки для двух
ранее объявленных глобально переменных модуля «МДВ-У»: «mdv_signal4» и
«mdv_signal3» и нажимается кнопка «Добавить» (см. рис. 215):</p>
<p><a class="reference internal" href="../_images/image271.png"><img alt="image269" src="../_images/image271.png" style="width: 4.74097in; height: 1.60139in;" /></a></p>
<p>Рис. 215 – Добавление двух переменных модуля</p>
<p>Добавленные переменные отобразятся в список переменных плагина «TCP
интерфейс», показанный на рис. 216.</p>
<p><a class="reference internal" href="../_images/image272.png"><img alt="image270" src="../_images/image272.png" style="width: 5.40556in; height: 2.92431in;" /></a></p>
<p>Рис. 216 – Добавленные переменные в настройках плагина</p>
<p>На этом настройка плагина «TCP интерфейс» завершена. После добавления
двух плагинов для модулей УСО, дерево проекта выглядит, как показано на
рис. 217:</p>
<p><a class="reference internal" href="../_images/image273.png"><img alt="image271" src="../_images/image273.png" style="width: 2.12083in; height: 1.73611in;" /></a></p>
<p>Рис. 217 – Дерево проекта после добавления двух плагинов для модулей УСО</p>
<p>Далее будут в проект добавлены необходимые программные модули, а также
написаны алгоритм и логика их работы.</p>
</div>
</div>
<div class="section" id="id87">
<h2>Добавление программных модулей<a class="headerlink" href="#id87" title="Ссылка на этот заголовок">¶</a></h2>
<p>Два программных модуля, первый на языке SFC, второй на языке ST будут
определять значения переменных плагина «TCP интерфейс» в зависимости от
сигналов модуля «МДВ-У».</p>
<div class="section" id="id88">
<h3>Добавление программы, написанной на языке SFC<a class="headerlink" href="#id88" title="Ссылка на этот заголовок">¶</a></h3>
<p>В меню дерева проекта, вызываемого с помощью кнопки «+» выбирается
программный модуль «Программа» (см. рис. 218).</p>
<p><a class="reference internal" href="../_images/image274.png"><img alt="image272" src="../_images/image274.png" style="width: 1.99097in; height: 3.34861in;" /></a></p>
<p>Рис. 218 – Добавление программного модуля «Программа» с помощью меню
дерева проекта</p>
<p>В появившемся диалоге происходит выбор языка «SFC» и нажимается кнопка
«OK» (см. рис. 219).</p>
<p><a class="reference internal" href="../_images/image275.png"><img alt="image273" src="../_images/image275.png" style="width: 2.64306in; height: 1.98819in;" /></a></p>
<p>Рис. 219 – Добавление программы на языке SFC</p>
<p>После того, как данный программный модуль добавлен появляется его окно
редактирования. Необходимо добавить две переменные типа BOOL на панель
переменных и констант данного программного модуля и назвать их
соответственно «flagStart» и «flagFinish», как показано на рис. 220.</p>
<p><a class="reference internal" href="../_images/image276.png"><img alt="image274" src="../_images/image276.png" style="width: 6.35764in; height: 1.58333in;" /></a></p>
<p>Рис. 220 – Две добавленные переменные для программного модуля на языке
SFC</p>
<p>Далее происходит связывание этих двух переменных с двумя сигналами
«mdv0_signal1» и «mdv0_signal2» модуля дискретного ввода с помощью
поля «Адрес» (двойное нажатие левой клавишей мыши по данному полю) и
вызов диалога просмотра адресов (см. рис. 221).</p>
<p><a class="reference internal" href="../_images/image277.png"><img alt="image275" src="../_images/image277.png" style="width: 5.35486in; height: 4.24861in;" /></a></p>
<p>Рис. 221 – Связывание переменных типа BOOL с переменными модуля УСО</p>
<p>В результате на панели переменных и констант программного модуля
«program0» будут две переменных типа BOOL, связанные с двумя сигналами
«mdv0_signal1» и «mdv0_signal2» модуля дискретного ввода (см. рис.
222).</p>
<p><a class="reference internal" href="../_images/image278.png"><img alt="image276" src="../_images/image278.png" style="width: 6.15000in; height: 1.56111in;" /></a></p>
<p>Рис. 222 – Две переменные типа BOOL связанные с переменными модуля
«МДВ-У»</p>
<p>Теперь можно перейти к созданию SFC диаграммы. Выберем на панели
редактирования кнопку создания нового шага инициализации и добавим его в
область редактирования. В появившемся диалоге (см. рис. 223) определим
только выходной соединитель.</p>
<p><a class="reference internal" href="../_images/image279.png"><img alt="image277" src="../_images/image279.png" style="width: 3.39931in; height: 2.15278in;" /></a></p>
<p>Рис. 223 – Добавление шага инициализации</p>
<p>Далее добавим еще один шаг с названием «mainStep» (см. рис. 224).</p>
<p><a class="reference internal" href="../_images/image280.png"><img alt="image278" src="../_images/image280.png" style="width: 3.46736in; height: 2.19583in;" /></a></p>
<p>Рис. 224 – Добавление шага</p>
<p>Соответственно, после добавления двух шагов, панель редактирования SFC
диаграммы выглядит следующим образом (см. рис. 225):</p>
<p><a class="reference internal" href="../_images/image281.png"><img alt="image279" src="../_images/image281.png" style="width: 5.64444in; height: 3.17778in;" /></a></p>
<p>Рис. 225 – Создание SFC диаграммы</p>
<p>Далее необходимо добавить переход между шагом «initStep» и «mainStep».
Выбираем на панели управления кнопку «Добавить новый переход» и в
появившемся диалоге «Редактировать переход» (см. рис. 226) устанавливаем
тип перехода «Встроенный код» со значением «flagStart». Нажимаем кнопку
«OK».</p>
<p><a class="reference internal" href="../_images/image282.png"><img alt="image280" src="../_images/image282.png" style="width: 3.11944in; height: 2.68611in;" /></a></p>
<p>Рис. 226 – Добавление перехода</p>
<p>Теперь необходимо соединить, посредством перехода, шаги «initStep» и
«mainStep» с помощью их контактов. В результате SFC диаграмма будет
выглядеть, как показано на рис. 227:</p>
<p><a class="reference internal" href="../_images/image283.png"><img alt="image281" src="../_images/image283.png" style="width: 5.22083in; height: 2.92639in;" /></a></p>
<p>Рис. 227 – Создание SFC диаграммы</p>
<p>Далее будет произведено добавление еще одного перехода, у которого тип
«Соединение» (см. рис. 228)</p>
<p><a class="reference internal" href="../_images/image284.png"><img alt="image282" src="../_images/image284.png" style="width: 3.00694in; height: 2.58958in;" /></a></p>
<p>Рис. 228 – Добавление перехода типа «Соединение»</p>
<p>Верхний конец добавленного перехода соединяется с выходным соединением
шага «mainStep» (см. рис. 229).</p>
<p><a class="reference internal" href="../_images/image285.png"><img alt="image283" src="../_images/image285.png" style="width: 5.94167in; height: 3.63611in;" /></a></p>
<p>Рис. 229 – Создание SFC диаграммы</p>
<p>С помощью указателя мыши переменная «flagFinish» перетаскивается из
панели переменных и констант в область редактирования, и её левый
контакт соединяется с контактом добавленного выше перехода, как показано
на рис. 230.</p>
<p><a class="reference internal" href="../_images/image286.png"><img alt="image284" src="../_images/image286.png" style="width: 6.06597in; height: 3.73264in;" /></a></p>
<p>Рис. 230 – Создание SFC диаграммы</p>
<p>Для того чтобы после выполнения второго условия диаграмма возвращалась в
начальное состояние необходимо сделать переход на шаг «initStep». Данную
операцию удобнее реализовать с помощью добавление «прыжка» (см. рис.
231).</p>
<p><a class="reference internal" href="../_images/image287.png"><img alt="image285" src="../_images/image287.png" style="width: 5.09514in; height: 3.58958in;" /></a></p>
<p>Рис. 231 – Добавление «прыжка» на SFC диаграмму</p>
<p>Выходное соединение перехода соединяется с «прыжком» и в результате
получается SFC диаграмма, показанная на рис. 232:</p>
<p><a class="reference internal" href="../_images/image288.png"><img alt="image286" src="../_images/image288.png" style="width: 5.15486in; height: 3.35417in;" /></a></p>
<p>Рис. 232 – Создание SFC диаграммы</p>
<p>Теперь необходимо добавить в шаг «mainStep» выполнение действия. В
панель переменных и констант добавляется еще одна переменная с именем
«value» (см. рис. 233).</p>
<p><a class="reference internal" href="../_images/image289.png"><img alt="image287" src="../_images/image289.png" style="width: 6.17708in; height: 1.75764in;" /></a></p>
<p>Рис. 233 – Добавление переменной «value» программный модуль «program0»</p>
<p>Данная переменная будет изменяться во время выполнения действия и будет
связана с переменной «tcp_out1». Данная операция выполняется с помощью
двойного щелчка по полю «Адрес» добавленной переменной «value» и нажатия
кнопки «…» для выбора диалога «Просмотр адресов», как показано на рис.
234:</p>
<p><a class="reference internal" href="../_images/image290.png"><img alt="image288" src="../_images/image290.png" style="width: 4.87222in; height: 4.02986in;" /></a></p>
<p>Рис. 234 – Связывание переменной программного модуля с переменной
плагина «TCP интерфейс»</p>
<p>Далее создаётся блок действий, в который добавляется одно действие с
квалификатором N (см. таблица 9), типа «Встроенный код» и в поле
«Значение» пишется код (см. рис. 235), который будет исполняться, когда
данное действие становится активным:</p>
<p>value := value + 1;</p>
<p><a class="reference internal" href="../_images/image291.png"><img alt="image289" src="../_images/image291.png" style="width: 4.88542in; height: 3.44444in;" /></a></p>
<p>Рис. 235 – Редактирование блока действий</p>
<p>После того как действие добавлено, его контакт, расположенный справа,
можно соединить с контактом шага (см. рис. 236).</p>
<p><a class="reference internal" href="../_images/image292.png"><img alt="image290" src="../_images/image292.png" style="width: 5.15347in; height: 3.33194in;" /></a></p>
<p>Рис. 236 – SFC диаграмма</p>
<p>В результате получилась SFC диаграмма, состоящая из двух шагов, двух
переходов одного блока действий и одного «прыжка». Выполнение
(состояние) данной диаграммы зависит от входных сигналов модуля «МДВ-У»,
т.к. условия переходов зависят от переменных «flagStart» и flagFinish,
которые связаны с сигналами модуля «МДВ-У».</p>
<p>Далее следует добавление второго программного модуля.</p>
</div>
<div class="section" id="st">
<h3>Добавление программы, написанной на ST<a class="headerlink" href="#st" title="Ссылка на этот заголовок">¶</a></h3>
<p>Для добавления программного модуля «Программа» необходимо снова
обратиться к меню дерева проекта, выбрав в нём соответствующий элемент
(см. рис. 237).</p>
<p><a class="reference internal" href="../_images/image293.png"><img alt="image291" src="../_images/image293.png" style="width: 1.88958in; height: 3.32222in;" /></a></p>
<p>Рис. 237 – Добавление программы в дерево проекта</p>
<p>Появится диалог создания нового программного модуля, в котором
необходимо указать «Язык» ST (см. рис. 238) и нажать кнопку «OK».</p>
<p><a class="reference internal" href="../_images/image294.png"><img alt="image292" src="../_images/image294.png" style="width: 2.34653in; height: 1.76736in;" /></a></p>
<p>Рис. 238 – Диалог добавления программы, написанной на языке ST</p>
<p>После добавления дерево проекта будет выглядеть, как показано на рис.
239.</p>
<p><a class="reference internal" href="../_images/image295.png"><img alt="image293" src="../_images/image295.png" style="width: 2.06667in; height: 2.11389in;" /></a></p>
<p>Рис. 239 – Добавленная программа в дереве проекта</p>
<p>В появившейся вкладке редактирования программного модуля, написанного на
языке ST, в панели переменных и констант добавим переменную «sig5» типа
BOOL. С помощью поля «Адрес» свяжем её с переменной модуля «МДВ-У» с
названием «mdv0_signal5», соответствующей сигналу под номером 5, как
показано на рис. 240.</p>
<p><a class="reference internal" href="../_images/image296.png"><img alt="image294" src="../_images/image296.png" style="width: 5.83611in; height: 4.31389in;" /></a></p>
<p>Рис. 240 – Связывание переменной модуля «МДВ-У» с переменной
программного модуля</p>
<p>Далее добавляется еще одна переменная типа DINT, которая связывается с
добавленной переменной «tcp_out2» модуля «TCP интерфейс» (см. п.
7.4.2). Связывание происходит аналогично связыванию «mdv0_signal5» с
помощью поля «Адрес» (см. рис. 241).</p>
<p><a class="reference internal" href="../_images/image297.png"><img alt="image295" src="../_images/image297.png" style="width: 6.00000in; height: 4.47083in;" /></a></p>
<p>Рис. 241 – Связывание переменной модуля «TCP интерфейс» с переменной
программного модуля</p>
<p>Соответственно, после добавления двух переменных и их связывания с
переменными внешних модулей панель переменных и констант будет
выглядеть, как показано на рис. 242:</p>
<p><a class="reference internal" href="../_images/image298.png"><img alt="image296" src="../_images/image298.png" style="width: 6.48819in; height: 1.62361in;" /></a></p>
<p>Рис. 242 – Панель переменных и констант добавленного программного модуля
«program1»</p>
<p>Далее следует написание алгоритма и логики работы данного программного
модуля. На языке ST будет записано следующе условие: в случае если
переменная «sig5» равна TRUE, т.е. 1, то присвоить переменной «out»
значение 10, в противном случае, если переменная «sig5» равна FALSE,
т.е. 0, то присвоить переменной «out» значение 20, как показано на рис.
243.</p>
<p><a class="reference internal" href="../_images/image299.png"><img alt="image297" src="../_images/image299.png" style="width: 5.66528in; height: 2.91458in;" /></a></p>
<p>Рис. 243 – Пример простой логики на языке ST</p>
<p>После того, как логика и алгоритмы для двух программных модулей
реализованы, необходимо определить их экземпляры и связать с задачами.</p>
</div>
</div>
<div class="section" id="id89">
<h2>Создание экземпляра программы<a class="headerlink" href="#id89" title="Ссылка на этот заголовок">¶</a></h2>
<p>Для создания экземпляров необходимо обратиться к элементу «Ресурс»,
созданному по умолчанию, в дереве проекта, как показано на рис. 244.</p>
<p><a class="reference internal" href="../_images/image300.png"><img alt="image298" src="../_images/image300.png" style="width: 2.28542in; height: 1.97569in;" /></a></p>
<p>Рис. 244 – Выбор элемента «Ресурс» в дереве проекта</p>
<p>Появится новая вкладка с панелью редактирования ресурса (см. рис. 245).</p>
<p><a class="reference internal" href="../_images/image301.png"><img alt="image299" src="../_images/image301.png" style="width: 5.54236in; height: 3.51111in;" /></a></p>
<p>Рис. 245 – Панель редактирования ресурса</p>
<p>В появившейся панели необходимо добавить две задачи с типом выполнения
«Цикличное», одна из которых продолжительностью 500 мс, а другая 1000
мс. С помощью кнопки добавить (данная кнопка аналогична кнопки
добавления переменной в панели переменных и констант) добавляется
задача, поле «Тип выполнения» устанавливается «Цикличное» и делается
двойной щелчок по полю «Интервал» (см. рис. 246).</p>
<p><a class="reference internal" href="../_images/image302.png"><img alt="image300" src="../_images/image302.png" style="width: 5.82639in; height: 2.13681in;" /></a></p>
<p>Рис. 246 – Добавление новое задачи</p>
<p>В появившемся диалоге (рис. 247) указывается продолжительность в 500 мс
и нажимается кнопка «OK».</p>
<p><a class="reference internal" href="../_images/image303.png"><img alt="image301" src="../_images/image303.png" style="width: 5.58333in; height: 1.64931in;" /></a></p>
<p>Рис. 247 – Редактирование продолжительности задачи</p>
<p>Аналогичным образом добавляется вторая задача, но с интервалом
продолжительности 1 секунда. Соответственно, список задач после их
добавления выглядит, как показано на рис. 248:</p>
<p><a class="reference internal" href="../_images/image304.png"><img alt="image302" src="../_images/image304.png" style="width: 5.88333in; height: 1.03403in;" /></a></p>
<p>Рис. 248 – Добавленные задачи</p>
<p>Далее создаётся два экземпляра: «instance1» и «instance2». Данная
операция осуществляется аналогичным образом, используя кнопку добавления
экземпляра. Каждый из добавленных экземпляров ассоциируется с
программным модулем типа «Программа» (соответственно «program0» и
«program1»), используя поле «Тип» и с задачей (соответственно «task1» и
«task2»), используя поле «Задача» (см. рис. 249).</p>
<p><a class="reference internal" href="../_images/image305.png"><img alt="image303" src="../_images/image305.png" style="width: 5.87917in; height: 1.28125in;" /></a></p>
<p>Рис. 249 – Связывание экземпляра с программой и задачей</p>
<p>После добавление задачи и экземпляров, панель ресурса выглядит, как
показано на рис. 250:</p>
<p><a class="reference internal" href="../_images/image306.png"><img alt="image304" src="../_images/image306.png" style="width: 5.20694in; height: 3.31181in;" /></a></p>
<p>Рис. 250 – Панель ресурса после добавления задачей и экземпляров</p>
<p>На этом этапе написание программы заканчивается и далее следует переход
к сборке проекта, соединению с целевым устройством, передачи на него
исполняемого файла, запуску и отладке.</p>
</div>
<div class="section" id="id90">
<h2>Сборка проекта<a class="headerlink" href="#id90" title="Ссылка на этот заголовок">¶</a></h2>
<p>Сборка проекта осуществляется с помощью кнопки «Собрать проект» (см.
таблица 2). На рис. 251 данная кнопка выделена красным цветом:</p>
<p><a class="reference internal" href="../_images/image307.png"><img alt="image305" src="../_images/image307.png" style="width: 5.05069in; height: 3.19028in;" /></a></p>
<p>Рис. 251 – Кнопка сборки проекта</p>
<p>Во время сборки проекта необходимо следить за отладочной консолью, в
которой в случае наличия ошибок, будут выведены соответствующие
сообщения. На рис. 252 показано, что сборка проекта завершилась успешно.</p>
<p><a class="reference internal" href="../_images/image308.png"><img alt="image306" src="../_images/image308.png" style="width: 3.67847in; height: 2.36458in;" /></a></p>
<p>Рис. 252 – Успешная сборка проекта</p>
<p>Сообщения-предупреждения, выделенные красным цветом, связаны с тем, что
для сборки проекта используется UNIX-подобная оболочка Cygwin.</p>
<p>После успешного завершения процесса сборки проекта, его необходимо
передать на целевое устройство. Описание данного шага следует далее.</p>
</div>
<div class="section" id="id91">
<h2>Передача и запуск прикладной программы на целевом устройстве<a class="headerlink" href="#id91" title="Ссылка на этот заголовок">¶</a></h2>
<p>Как упоминалось в п. 9, для возможности передачи прикладной программы и
её отладки необходимо на целевом устройстве иметь запущенную серверную
часть среды разработки «Beremiz» (см. п. 9.1), представляющую собой
скрипт «Beremiz_service.py». В данном примере предполагается, что она
уже автоматически запущена на целевом устройстве, с IP-адресом
192.168.23.226 и портом 3000. Соответственно в настройках проекта
указано PYRO://192.168.23.226:3000 (см. п. 10.3), как показано на рис.
253:</p>
<p><a class="reference internal" href="../_images/image309.png"><img alt="image307" src="../_images/image309.png" style="width: 4.03681in; height: 3.72500in;" /></a></p>
<p>Рис. 253 – Панель настройки проекта</p>
<p>Нажатие кнопки «Соединиться с целевым устройством» (см. таблица 2)
инициирует соединение с целевым устройством. На рис. 254 данная кнопка
выделена красным цветом:</p>
<p><a class="reference internal" href="../_images/image310.png"><img alt="image308" src="../_images/image310.png" style="width: 6.11250in; height: 3.84931in;" /></a></p>
<p>Рис. 254 – Кнопка соединения с целевым устройством</p>
<p>В отладочной консоли будет выдано соответствующее сообщение, показанное
на рис. 255:</p>
<p><a class="reference internal" href="../_images/image3111.png"><img alt="image309" src="../_images/image3111.png" style="width: 4.08403in; height: 2.20486in;" /></a></p>
<p>Рис. 255 – Отладочная консоль после соединения с целевым устройством</p>
<p>Состояние «Empty» указывает, что на целевом устройстве отсутствует какая
либо прикладная программа. Далее необходимо передать собранный
исполняемый файл с помощью кнопки «Передача прикладной программы» (см.
таблица 2), выделенной на рис. 256 красным цветом:</p>
<p><a class="reference internal" href="../_images/image312.png"><img alt="image310" src="../_images/image312.png" style="width: 5.94375in; height: 3.58264in;" /></a></p>
<p>Рис. 256 – Кнопка передачи прикладной программы</p>
<p>В отладочной консоли будет выдано соответствующее сообщение «Передача
успешно выполнена», показанное на рис. 257:</p>
<p><a class="reference internal" href="../_images/image313.png"><img alt="image311" src="../_images/image313.png" style="width: 4.13681in; height: 2.27847in;" /></a></p>
<p>Рис. 257 – Отладочная консоль после соединения с целевым устройством</p>
<p>Запуск прикладной программы осуществляется с помощью кнопки «Запуск
прикладной программы» (см. таблица 2), выделенной на рис. 258 красным
цветом:</p>
<p><a class="reference internal" href="../_images/image314.png"><img alt="image312" src="../_images/image314.png" style="width: 5.83542in; height: 3.48542in;" /></a></p>
<p>Рис. 258 – Кнопка запуска прикладной программы</p>
<p>В отладочной консоли будет выдано соответствующее сообщение «ПЛК запущен
на выполнение», показанное на рис. 259:</p>
<p><a class="reference internal" href="../_images/image315.png"><img alt="image313" src="../_images/image315.png" style="width: 4.53264in; height: 2.47500in;" /></a></p>
<p>Рис. 259 – Отладочная консоль после запуска прикладной программы</p>
<p>Остановка прикладной программы осуществляется с помощью кнопки
«Остановить работающую прикладную программу» (см. таблица 2), выделенной
на рис. 260 красным цветом:</p>
<p><a class="reference internal" href="../_images/image316.png"><img alt="image314" src="../_images/image316.png" style="width: 6.03750in; height: 3.60903in;" /></a></p>
<p>Рис. 260 – Кнопка остановки прикладной программы</p>
<p>В отладочной консоли будет выдано соответствующее сообщение «Отладчик
отключён», показанное на рис. 261:</p>
<p><a class="reference internal" href="../_images/image317.png"><img alt="image315" src="../_images/image317.png" style="width: 4.46042in; height: 2.43611in;" /></a></p>
<p>Рис. 261 – Отладочная консоль после остановки прикладной программы</p>
<p>Далее можно приступить к процессу отладки прикладной программы.</p>
</div>
<div class="section" id="id92">
<h2>Отладка прикладной программы<a class="headerlink" href="#id92" title="Ссылка на этот заголовок">¶</a></h2>
<p>После того как прикладная программа запущена, можно обратиться к дереву
проекта и выбрать элемент «resource1». В панели экземпляров будут
отображены два экземпляра, определённых в ресурсе «resource»:
«instance1» для «program0» и «instance2» для «program1». Если нажать
кнопку запуска режима отладки для экземпляра, выделенную на рис. 262
красным цветом для «instance1»:</p>
<p><a class="reference internal" href="../_images/image318.png"><img alt="image316" src="../_images/image318.png" style="width: 2.39097in; height: 2.66042in;" /></a></p>
<p>Рис. 262 – Дерево проекта и панель экземпляров проекта</p>
<p>Откроется новая вкладка, содержащая FBD диаграмму, переведённую в режим
отладки, как показано на рис. 263:</p>
<p><a class="reference internal" href="../_images/image319.png"><img alt="image317" src="../_images/image319.png" style="width: 7.07917in; height: 3.00694in;" /></a></p>
<p>Рис. 263 – Пример FBD диаграммы в режиме отладки</p>
<p>С помощью кнопки запуска режима отладки для экземпляра, выделенной на
рис. 264 красным цветом, добавим переменную «value» на панель отладки:</p>
<p><a class="reference internal" href="../_images/image320.png"><img alt="image318" src="../_images/image320.png" style="width: 7.04792in; height: 2.92639in;" /></a></p>
<p>Рис. 264 – Добавление переменной «value» на панель отладки</p>
<p>Значение переменной «value» равно 0, т.к. это значение присвоено ей при
инициализации. Для того, чтобы значение начало изменяться необходимо
сделать шаг «mainStep» активным. Это может произойти, если в модуле
«МДВ-У» 1-ый сигнал станет TRUE, т.к. переход «flagStart», зависит
именно от него. Другим способом перевести переход «flagStart» в
состояние TRUE является механизм отладки SFC диаграммы. Для этого на SFC
диагрмме необходимо нажать правой кнопкой мыши по переходу «flagStart» и
выбрать «Установить значение» в появившемся всплывающем меню, как
показано на рис. 265.</p>
<p><a class="reference internal" href="../_images/image321.png"><img alt="image319" src="../_images/image321.png" style="width: 6.31250in; height: 2.61944in;" /></a></p>
<p>Рис. 265 – Всплывающее меню отладки переда SFC диаграммы</p>
<p>В появившемся диалоге «Ввода значения переменной типа “BOOL”»
устанавливается значение «True». Далее следует нажатие кнопки «OK», как
показано на рис. 266.</p>
<p><a class="reference internal" href="../_images/image322.png"><img alt="image320" src="../_images/image322.png" style="width: 6.35833in; height: 2.64931in;" /></a></p>
<p>Рис. 266 – Установка значения True для перехода</p>
<p>Соответственно, после установки перехода «flagStart» на SFC диаграмме в
значение TRUE, шаг «mainStep» выделен зелёным цветом (см. рис. 267).</p>
<p><a class="reference internal" href="../_images/image323.png"><img alt="image321" src="../_images/image323.png" style="width: 6.96042in; height: 3.01458in;" /></a></p>
<p>Рис. 267 – SFC диаграмма во время отладки</p>
<p>Блок действий, ассоциированный с этим шагом, также становится и активным
и выделен зелёным цветом. Единственное действие начинает выполняться.
Следовательно, в панели отладки видно, как значение переменной «value»
увеличивается на единицу с периодичностью в 500 миллисекунд, т.к.
экземпляр программы «program0» связан с задачей, у которой интервал 500
мс (см. п. 10.6).</p>
</div>
</div>
<div class="section" id="id93">
<h1>Библиотека функций и функциональных блоков<a class="headerlink" href="#id93" title="Ссылка на этот заголовок">¶</a></h1>
<p>Функции и функциональные блоки представляют собой предопределённые
элементы, которые могут быть использованы при написании алгоритмов и
логики программных модулей типа «Функциональный блок» и «Программ», как
на текстовых, так и на графических языках стандарта IEC 61131-3.</p>
<p>Данные элементы имеют параметры на входе и на выходе. Как правило,
каждый параметр имеет имя и своё назначение.</p>
<p>Стандартные функциональные блоки</p>
<p>Бистабильный SR-триггер</p>
<p>Данный функциональный блок представляет собой бистабильный SR-триггер, с
доминирующим входом S (Set). Выход Q1 становится &#8220;1&#8221;, когда вход S1
становится &#8220;1&#8221;. Это состояние сохраняется, даже если S1 возвращается
обратно в &#8220;0&#8221;. Выход Q1 возвращается в &#8220;0&#8221;, когда вход R становится &#8220;1&#8221;.
Если входы S1 и R находятся в &#8220;1&#8221; одновременно, доминирующий вход S1
установит выход Q1 в &#8220;1&#8221;. Когда функциональный блок вызывается первый
раз, начальное состояние Q1 это &#8220;0&#8221;.</p>
<p>Бистабильный RS-триггер</p>
<p>Данный функциональный блок представляет собой бистабильный RS-триггер, с
доминирующим входом R (Reset). Выход Q1 становится &#8220;1&#8221;, когда вход S
становится &#8220;1&#8221;. Это состояние сохраняется, даже если S возвращается
обратно в &#8220;0&#8221;. Выход Q1 возвращается в &#8220;0&#8221;, когда вход R1 становится
&#8220;1&#8221;. Если входы S и R1 находятся в &#8220;1&#8221; одновременно, доминирующий вход
R1 установит выход Q1 в &#8220;0&#8221;. Когда функциональный блок вызывается первый
раз, начальное состояние Q1 это &#8220;0&#8221;.</p>
<p>SEMA – Семафор</p>
<p>Данный функциональный блок представляет собой семафор, определяющий
механизм, позволяющий элементам программы иметь взаимоисключающий доступ
к определенным ресурсам.</p>
<p>R_TRIG – Индикатор нарастания фронта</p>
<p>Данный функциональный блок представляет собой индикатор нарастания
фронта, который генерирует на выходе одиночный импульс при нарастании
фронта сигнала. Выход Q становится &#8220;1&#8221;, если происходит переход из &#8220;0&#8221; в
&#8220;1&#8221; на входе CLK . Выход остается в состоянии &#8220;1&#8221; от одного выполнения
блока до следующего (один цикл); затем выход возвращается в &#8220;0&#8221;.</p>
<p>F_TRIG – Индикатор спада фронта</p>
<p>Данный функциональный блок представляет собой индикатор спада фронта,
который генерирует на выходе одиночный импульс при спаде фронта сигнала.</p>
<p>Выход Q становится &#8220;1&#8221;, если происходит переход из &#8220;1&#8221; в &#8220;0&#8221; на входе
CLK . Выход будет оставаться в состоянии &#8220;1&#8221; от одного выполнения блока
до следующего; затем выход возвращается в &#8220;0&#8221;.</p>
<p>CTU – инкрементный счётчик</p>
<p>Данный функциональный блок представляет собой инкрементный счётчик.
Сигнал &#8220;1&#8221; на входе R вызывает присваивание значения &#8220;0&#8221; выходу CV . При
каждом переходе из &#8220;0&#8221; в &#8220;1&#8221; на входе CU значение CV увеличивается на 1.
Когда CV &gt;= PV, выход Q устанавливается в &#8220;1&#8221;.</p>
<p>Примечание: Счетчик работает только до достижения максимального значения
используемого типа данных. Переполнения не происходит.</p>
<p>Входы CU, RESET и выход Q типа BOOL, вход PV и выход CV типа WORD.</p>
<p>По каждому фронту на входе CU (переход из FALSE в TRUE) выход CV
увеличивается на 1. Выход Q устанавливается в TRUE, когда счетчик
достигнет значения заданного PV. Счетчик CV сбрасывается в 0 по входу
RESET = TRUE.</p>
<p>CTD – декрементный счётчик</p>
<p>Данный функциональный блок представляет собой декрементный счётчик.
Сигнал &#8220;1&#8221; на входе LD вызывает присваивание значения на входе PV выходу
CV . При каждом переходе из &#8220;0&#8221; в &#8220;1&#8221; на входе CD значение CV
уменьшается на 1.</p>
<p>Когда CV &lt;= 0, выход Q принимает значение &#8220;1&#8221;.</p>
<p>Примечание: Счетчик работает только до достижения минимального значения
используемого типа данных. Переполнения не происходит.</p>
<p>CTUD – реверсивный счётчик</p>
<p>Данный функциональный блок представляет собой реверсивный счётчик.
Сигнал &#8220;1&#8221; на входе R вызывает присваивание значения &#8220;0&#8221; выходу CV .
Сигнал &#8220;1&#8221; на входе LD вызывает присваивание значения на входе PV выходу
CV . При каждом переходе из &#8220;0&#8221; в &#8220;1&#8221; на входе CU значение CV
увеличивается на 1. При каждом переходе из &#8220;0&#8221; в &#8220;1&#8221; на входе CD
значение CV уменьшается на 1.</p>
<p>Если сигнал &#8220;1&#8221; приходит одновременно на входы R и LD, вход R
обрабатывается первым.</p>
<p>Когда CV &gt;= PV, выход QU имеет значение &#8220;1&#8221;.</p>
<p>Когда CV &lt;= 0, выход QD принимает значение &#8220;1&#8221;.</p>
<p>Примечание: Вычитающий счетчик работает только до достижения
минимального значения используемого типа данных, суммирующий счетчик
работает только до достижения максимального значения используемого типа
данных. Переполнения не происходит.</p>
<p>TP – повторитель импульсов</p>
<p>Данный функциональный блок представляет собой повторитель импульсов и
используется для генерирования импульса с заданной продолжительностью.
Если IN становится &#8220;1&#8221;, Q становится &#8220;1&#8221;, и начинается отсчет
внутреннего времени (ET). Если внутреннее время достигает значения PT, Q
становится &#8220;0&#8221; (независимо от IN). Отсчет внутреннего времени
останавливается/сбрасывается, если IN становится &#8220;0&#8221;. Если внутреннее
время не достигло значения PT, импульс IN не влияет на внутреннее время.
Если внутреннее время достигло значения PT, и IN равен &#8220;0&#8221;, отсчет
внутреннего времени останавливается/сбрасывается, и Q становится &#8220;0&#8221;.</p>
<p>TON – таймер с задержкой включения</p>
<p>Данный функциональный блок представляет собой таймер с задержкой
включения. Он запускается, когда состояние сигнала на входе меняется от
0 к 1 и устанавливает на выходе 1 по истечении заданного времени.</p>
<p>Если IN становится &#8220;1&#8221;, запускается отсчет внутреннего времени (ET).
Если внутреннее время достигает значения PT, Q становится &#8220;1&#8221;. Если IN
становится &#8220;0&#8221;, Q становится &#8220;0&#8221;, а подсчет внутреннего времени
останавливается/сбрасывается. Если IN становится &#8220;0&#8221; до того, как
внутреннее время достигло значения PT, подсчет внутреннего времени
останавливается/сбрасывается, а выход Q не устанавливается в &#8220;0&#8221;.</p>
<p>TOF – таймер с задержкой отключения</p>
<p>Данный функциональный блок представляет собой таймер с задержкой
отключения. Он запускается, когда состояние сигнала на входе меняется от
1 к 0 и устанавливает на выходе 0 по истечении заданного времени.</p>
<p>Если IN становится &#8220;1&#8221;, Q становится &#8220;1&#8221;.</p>
<p>Если IN становится &#8220;0&#8221;, запускается отсчет внутреннего времени (ET).</p>
<p>Если внутреннее время достигает значения PT, Q становится &#8220;0&#8221;.</p>
<p>Если IN становится &#8220;1&#8221;, Q становится &#8220;1&#8221;, а подсчет внутреннего времени
останавливается/сбрасывается.</p>
<p>Если IN становится &#8220;1&#8221; до того, как внутреннее время достигло значения
PT, подсчет внутреннего времени останавливается/сбрасывается, а выход Q
не устанавливается в &#8220;0&#8221;.</p>
<p>Дополнительные функциональные блоки</p>
<p>RTC – часы реального времени</p>
<p>Данный функциональный блок представляет собой часы реального времени и
имеет много вариантов использования, включая добавление временных
отметок, для установки даты и времени в формируемых отчетах, в аварийных
сообщениях и т.д.</p>
<p>Вход PDT (Preset DT) предназначен для установки времени. Часы начинают
отсчет времени от значения PDT. Выход Q (BOOL) повторят значение EN.
Выход CDT (Current DT) дает текущее значение даты и времени.</p>
<p>INTEGRAL – Интеграл</p>
<p>Функциональный блок интеграл интегрирует входное значение XIN по
времени.</p>
<p>DERIVATIVE – Производная</p>
<p>Функциональный блок производная выдаёт значение XOUT пропорционально
скорости изменения входного параметра XIN.</p>
<p>PID – Пропорционально-интегрально-дифференциальный регулятор</p>
<p>Данный функциональный блок представляет собой устройство в цепи обратной
связи, используемое в системах автоматического управления для
формирования управляющего сигнала. ПИД-регулятор формирует управляющий
сигнал, являющийся суммой трёх слагаемых, первое из которых
пропорционально входному сигналу, второе – интеграл входного сигнала,
третье – производная входного сигнала.</p>
<p>HYSTERESIS – гистерезис</p>
<p>Функциональный блок гистерезис предоставляет выходное гистерезисное
булевское значение, которое определяется разницей вводных параметров
XIN1 и XIN2 (типа REAL с плавающей точкой).</p>
<p>Преобразования типов</p>
<p>Данный набор функций предназначен для всех возможных и корректных,
согласно стандарту IEC 61131-3, преобразований между типами данных.</p>
<p>Числовые операции</p>
<p>ABS – модуль числа</p>
<p>Данная функция возвращает модуль входного числа IN.</p>
<p>SQRT – квадратный корень</p>
<p>Данная функция возвращает в OUT квадратный корень входного числа IN.</p>
<p>LN – натуральный логарифм</p>
<p>Данная функция возвращает значение натурального логарифма от IN.</p>
<p>LOG – логарифм по основанию 10</p>
<p>Данная функция возвращает значение логарифма по основанию 10 от IN.</p>
<p>EXP – возведение в степень экспоненты</p>
<p>Данная функция возвращает значение экспоненты, возведённой в степень IN.</p>
<p>SIN – синус</p>
<p>Данная функция возвращает значение синуса IN.</p>
<p>COS – косинус</p>
<p>Данная функция возвращает значение косинуса IN.</p>
<p>TAN – тангенс</p>
<p>Данная функция возвращает значение тангенса IN.</p>
<p>ASIN – арксинус</p>
<p>Данная функция возвращает значение арксинуса IN.</p>
<p>ACOS – арккосинус</p>
<p>Данная функция возвращает значение арккосинуса IN.</p>
<p>ATAN – арктангенс</p>
<p>Данная функция возвращает значение арктангенса IN.</p>
<p>Арифметические операции</p>
<p>ADD – сложение</p>
<p>Данная функция возвращает результат сложения IN1 и IN2.</p>
<p>MUL – умножение</p>
<p>Данная функция возвращает результат умножения IN1 и IN2.</p>
<p>SUB – вычитание</p>
<p>Данная функция возвращает результат вычитания из IN1 значения IN2.</p>
<p>DIV – деление</p>
<p>Данная функция возвращает результат деления IN1 на IN2.</p>
<p>MOD – остаток от деления</p>
<p>Данная функция возвращает остаток от деления IN1 на IN2.</p>
<p>EXPT – возведение в степень</p>
<p>Данная функция возвращает значение IN1 возведённое в степень IN2.</p>
<p>MOVE – присвоение</p>
<p>Данная функция возвращает значение IN.</p>
<p>Временные операции</p>
<p>ADD_TIME – сложение переменных типа TIME</p>
<p>Данная функция складывает входные значения IN(k) типа TIME и возвращает
результат типа TIME. Количество входов IN(n) изменяемое - от 2 до 20. По
умолчанию 2.</p>
<p>ADD_TOD_TIME – сложение времени дня TOD с интервалом времени TIME</p>
<p>Данная функция складывает входную переменную IN1 типа TOD
(TIME_OF_DAY) с переменной IN2 типа TIME. Возвращаемая величина имеет
тип TIME_OF_DAY.</p>
<p>ADD_DT_TIME – прибавление промежутка времени TIME к моменту времени DT</p>
<p>Данная функция ADD_DT_TIME прибавляет промежуток времени (формат TIME)
к моменту времени (формат DT) и поставляет в качестве результата новый
момент времени (формат DT). Момент времени (параметр T) должен лежать в
диапазоне от DT#1990-01-01-00:00:00.000 до DT#2089-12-31-23:59:59.999.</p>
<p>Функция не выполняет входной проверки. Если результат сложения не лежит
внутри допустимого диапазона, то результат ограничивается
соответствующим значением и бит двоичного результата (BR) слова
состояния устанавливается в &#8220;0&#8221;.</p>
<p>Для входного параметра Т и выходного параметра можно ставить в
соответствие только символически определенную переменную.</p>
<p>MULTIME – умножение времени TIME на число</p>
<p>Данная функция выполняет умножение входного значения IN1 типа TIME на
число IN2 типа ANY_NUM и возвращает результат типа TIME.</p>
<p>SUB_TIME – разность двух значений типа TIME</p>
<p>Данная функция вычитает из входного значения IN1 типа TIME значение на
входе IN2 типа TIME и возвращает результат типа TIME.</p>
<p>SUB_DATE_DATE – разность двух значений типа DATE</p>
<p>Данная функция вычитает из входного значения IN1 типа DATE входное
значение IN2 типа DATE и возвращает их разницу типа TIME.</p>
<p>SUB_TOD_TIME – вычитание из времени дня TOD интервала времени TIME</p>
<p>Данная функция вычитает из входного значения IN1 типа TOD
(TIME_OF_DAY) входное значение IN2 типа TIME и возвращает результат
типа TIME_OF_DAY.</p>
<p>SUB_DT_TIME – вычитание из момента времени DT промежутка времени TIME</p>
<p>Данная функция вычитает промежуток времени (формат TIME) из момента
времени (формат DT) и поставляет в качестве результата новый момент
времени (формат DT). Момент времени (параметр T) должен лежать в
диапазоне от DT#1990-01-01-00:00:00.000 до DT#2089-12-31-23:59:59.999.
Функция не выполняет входной проверки. Если результат вычитания не лежит
внутри допустимого диапазона, то результат ограничивается
соответствующим значением и бит двоичного результата (BR) слова
состояния устанавливается в &#8220;0&#8221;.</p>
<p>Для входного параметра Т и выходного параметра можно ставить в
соответствие только символически определенную переменную.</p>
<p>DIVTIME – деление времени TIME на число</p>
<p>Данная функция выполняет деление входного значения IN1 типа TIME на
число IN2 типа ANY_NUM и возвращает результат типа TIME.</p>
<p>Операции смещения бит</p>
<p>SHL – арифметический сдвиг влево</p>
<p>Данная функция возвращает арифметический сдвиг аргумента IN на N бит
влево с заполнением битов справа нулями.</p>
<p>SHR – арифметический сдвиг вправо</p>
<p>Данная функция возвращает арифметический сдвиг аргумента IN на N бит
вправо с заполнением битов слева нулями.</p>
<p>ROR – циклический сдвиг направо</p>
<p>Данная функция возвращает циклический сдвиг аргумента IN на N бит влево.</p>
<p>ROL – циклический сдвиг влево</p>
<p>Данная функция возвращает циклический сдвиг аргумента IN на N бит
вправо.</p>
<p>Побитовые операции</p>
<p>AND – побитовое И</p>
<p>Данная функция представляет собой организацию «логического И» для всех
входных аргументов IN<sub>1</sub>…IN<sub>n</sub>.</p>
<p>OR – побитовое ИЛИ</p>
<p>Данная функция представляет собой организацию «логического ИЛИ» для всех
входных аргументов IN<sub>1</sub>…IN<sub>n</sub>.</p>
<p>XOR – побитовое исключающее ИЛИ</p>
<p>Данная функция представляет собой организацию «логического исключающего
ИЛИ» для всех входных аргументов IN<sub>1</sub>…IN<sub>n</sub>.</p>
<p>NOT – побитовая инверсия</p>
<p>Данная функция представляет собой организацию «логической инверсии» для
входного аргумента IN.</p>
<p>Операции выбора</p>
<p>SEL – выбор из двух значений</p>
<p>Данная функция возвращает один из двух аргументов IN1 или IN2 в
зависимости от значения аргумента G. Если G = 0, то результат равен Х1,
иначе X2.</p>
<p>MAX – максимум</p>
<p>Данная функция возвращает максимум из входных аргументов IN1 и IN2.</p>
<p>MIN – минимум</p>
<p>Данная функция возвращает минимум из входных аргументов IN1 и IN2.</p>
<p>LIMIT – ограничитель значения</p>
<p>Данная функция возвращает значение входного аргумента IN, в случае
превышения им значения MX – возвращается MX, в случае если IN меньше MN
– возвращается MN.</p>
<p>MUX – Мультиплексор (выбор 1 из N)</p>
<p>Данная функция возвращает значение на входе IN(K), в зависимости от
входного K. Количество входов IN(n) изменяемое – от 2 до 20. По
умолчанию 2.</p>
<p>Операции сравнения</p>
<p>GT – больше чем</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт в результате
значение True, если выполнится следующее условие: (IN1 &gt; IN2) &amp; (IN2 &gt;
IN3) &amp; … (INn-1 &gt; INn), в противном случае в результат выдаётся False.
Количество входов IN(n) изменяемое – от 2 до 20. По умолчанию 2.</p>
<p>GE – больше чем или равно</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт в результате
значение True, если выполнится следующее условие: (IN1 &gt;= IN2) &amp; (IN2 &gt;=
IN3) &amp; … (INn-1 &gt;= INn), в противном случае в OUT выдаётся False.
Количество входов IN(n) изменяемое – от 2 до 20. По умолчанию 2.</p>
<p>EQ – равенство</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт на выходе OUT
значение True, если выполнится следующее условие: (IN1 = IN2) &amp; (IN2 =
IN3) &amp; … (INn-1 = INn), в противном случае в OUT выдаётся False.
Количество входов IN(n) изменяемое – от 2 до 20. По умолчанию 2.</p>
<p>LT – меньше чем</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт в результате
значение True, если выполнится следующее условие: (IN1 &lt; IN2) &amp; (IN2 &lt;
IN3) &amp; … (INn-1 &lt; INn), в противном случае в результат выдаётся False.
Количество входов IN(n) изменяемое – от 2 до 20. По умолчанию 2.</p>
<p>LE – меньше чем или равно</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт в результат
значение True, если выполнится следующее условие: (IN1 &lt;= IN2) &amp; (IN2 &lt;=
IN3) &amp; … (INn-1 &lt;= INn), в противном случае в результат выдаётся False.
Количество входов IN(n) изменяемое – от 2 до 20. По умолчанию 2.</p>
<p>NE – не равно</p>
<p>Данная функция сравнивает все входные аргументы и выдаёт в результат
значение True, если выполнится следующее условие: (IN1 &lt;&gt; IN2) &amp; (IN2 &lt;&gt;
IN3) &amp; … (INn-1 &lt;&gt; INn), в противном случае в результат выдаётся False.
Количество входов IN(n) изменяемое - от 2 до 20. По умолчанию 2.</p>
<p>Строковые операции с переменными типа STRING</p>
<p>LEN – длина строки</p>
<p>Данная функция возвращает в результат длину строки IN. Входному
параметру можно ставить в соответствие только символически определенную
переменную.</p>
<p>LEFT – левая часть строки</p>
<p>Данная функция возвращает в результат из строки IN первые L символов.
Если L больше, чем текущая длина переменной типа STRING, то возвращается
входное значение. При L = 0 и при пустой строке в качестве входного
значения возвращается пустая строка. Если число L отрицательно, то
выводится пустая строка. Параметру IN и возвращаемому значению можно
ставить в соответствие только символически определенную переменную.</p>
<p>RIGHT – правая часть строки</p>
<p>Данная функция возвращает в результат из строки IN последние L символов.
Если L больше, чем текущая длина переменной STRING, то возвращается
входное значение. При L = 0 и при пустой строке в качестве входного
значения возвращается пустая строка. Если число L отрицательно, то
выводится пустая строка. Параметру IN и возвращаемому значению можно
ставить в соответствие только символически определенную переменную.</p>
<p>MID – середина строки</p>
<p>Данная функция возвращает в результат из строки IN L-символов, начиная с
позиции P. Если сумма L и (P–1) превосходит текущую длину переменной
типа STRING, то возвращается строка символов, начиная с P-го символа
входной строки до ее конца. Во всех остальных случаях (P находится вне
текущей длины, P и/или L равны нулю или отрицательны) выводится пустая
строка. Параметру IN и возвращаемому значению можно ставить в
соответствие только символически определенную переменную.</p>
<p>CONCAT – объединение двух переменных STRING</p>
<p>Данная функция возвращает в результат объединение (конкатенацию) строк
IN1 и IN2.</p>
<p>CONCAT_DAT_TOD – объединение (конкатенация) времени</p>
<p>Данная функция возвращает в результат типа DT конкатенацию входных
значений типов DATE и TOD, соответственно IN1 и IN2.</p>
<p>INSERT – вставка в переменной STRING</p>
<p>Данная функция возвращает в результат строку IN1, в которую вставлена
строка IN2, начиная с позиции P. Если P равно нулю, то вторая строка
символов вставляется перед первой строкой символов. Если P больше, чем
текущая длина первой строки символов, то вторая строка символов
присоединяется к первой. Если P отрицательно, то выводится пустая
строка. Входным параметрам IN1 и IN2 и выходному параметру можно ставить
в соответствие только символически определенную переменную.</p>
<p>DELETE – удаление в переменной STRING</p>
<p>Данная функция возвращает в результат строку IN1, в которой удалено L
символов, начиная с позиции P. Если L и/или P равны нулю или P больше,
чем текущая длина входной строки, то возвращается входная строка. Если
сумма L и P больше, чем входная строка символов, то строка символов
удаляется до конца. Если L и/или P имеют отрицательное значение, то
выводится пустая. Входному параметру IN и выходному параметру можно
ставить в соответствие только символически определенную переменную.</p>
<p>REPLACE – замена в переменной STRING</p>
<p>Данная функция возвращает в результат строку IN1, в которой символы,
начиная с позиции P, заменены L первыми символами строки IN2. Если L
равно нулю, то возвращается первая строка символов. Если P равно нулю
или единице, то замена происходит, начиная с 1-го символа
(включительно). Если P лежит вне первой строки символов, то вторая
строка присоединяется к первой строке. Если L и/или P отрицательны, то
возвращается пустая строка. Входным параметрам IN1 и IN2 и выходному
параметру можно ставить в соответствие только символически определенную
переменную.</p>
<p>FIND – поиск в переменной STRING</p>
<p>Данная функция возвращает в результат номер позиции, в которой находится
строка IN2 в строке IN1. Поиск начинается слева, сообщается о первом
появлении строки символов. Если вторая строка символов не содержится в
первой, то возвращается нуль. Входным параметрам IN1 и IN2 можно ставить
в соответствие только символически определенную переменную.</p>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../iec_guide/index.html" class="btn btn-neutral float-right" title="Языки стандарта МЭК 61131-3" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Руководство программиста" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, JSC &#34;INEUM named after I.S.Bruk&#34;.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>